import{c as ae,m as oe,z as K,A as ne,a as i,o,b as t,t as r,u as e,f as C,g as S,v as Y,B as U,q as A,s as O,h as E,F as z,w as le,n as te,C as we,p as u,d as f,e as Q,x as de,D as $e,r as T,y as se,l as De,j as Ce}from"./index-CWbGlPLC.js";import{u as ie}from"./useData-B7VlmU_F.js";import{_ as $}from"./SkeletonLoader-Bd7IEoAO.js";import{L as Z}from"./loader-circle-CxhZKDjf.js";import{A as J}from"./arrow-right-6ZeRlMdP.js";import{S as Te,T as ce,P as Ie}from"./trash-2-E4Gmu2j8.js";import{C as Pe}from"./circle-check-big-5B_O2kXK.js";import{T as Se}from"./triangle-alert-50E3jile.js";import"./userService-DjmtoxOE.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ae("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=ae("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Ae={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},Oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ve={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},je={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ue={value:""},Me=["value"],Fe={key:0},Re={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Le=["value"],Be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ge=["placeholder"],qe={class:"flex space-x-3"},ze=["disabled"],He=["disabled"],We={__name:"DraftForm",props:{user:Object,editingDraft:Object,t:Function,language:String,contentTypes:Array,draftStatuses:Array,show:Boolean,formData:Object,isSubmitting:Boolean},emits:["submit","cancel"],setup(y,{emit:n}){const x=y,v=n,{user:p,editingDraft:_,t:b,language:h,contentTypes:V,draftStatuses:c,show:M,isSubmitting:I}=oe(x),a=K({...x.formData});ne(()=>x.editingDraft,l=>{l?Object.assign(a,l):Object.assign(a,{name:"",type:"",content:"",status:"pending"})});function g(){v("submit",{...a})}function s(){v("cancel")}return(l,w)=>(o(),i("div",Ee,[t("h3",Ae,r(e(_)?e(b)("editDraft",e(h)):e(b)("createNewDraft",e(h))),1),t("form",{onSubmit:le(g,["prevent"]),class:"space-y-4"},[t("div",Oe,[t("div",null,[t("label",Ve,r(e(b)("name",e(h))),1),S(t("input",{type:"text","onUpdate:modelValue":w[0]||(w[0]=m=>a.name=m),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,512),[[Y,a.name]])]),t("div",null,[t("label",je,r(e(b)("type",e(h))),1),S(t("select",{"onUpdate:modelValue":w[1]||(w[1]=m=>a.type=m),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},[t("option",Ue,r(e(b)("type",e(h))),1),(o(!0),i(A,null,O(e(V),m=>(o(),i("option",{key:m,value:m},r(m),9,Me))),128))],512),[[U,a.type]])])]),e(p).adminType==="ADMIN"?(o(),i("div",Fe,[t("label",Re,r(e(b)("status",e(h))),1),S(t("select",{"onUpdate:modelValue":w[2]||(w[2]=m=>a.status=m),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[(o(!0),i(A,null,O(e(c),m=>(o(),i("option",{key:m,value:m},r(e(b)(m,e(h))),9,Le))),128))],512),[[U,a.status]])])):C("",!0),t("div",null,[t("label",Be,r(e(b)("draftContent",e(h))),1),S(t("textarea",{"onUpdate:modelValue":w[3]||(w[3]=m=>a.content=m),rows:"6",placeholder:e(b)("enterDraftContent",e(h)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,8,Ge),[[Y,a.content]])]),t("div",qe,[t("button",{type:"submit",disabled:e(I),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e(I)?(o(),E(e(Z),{key:0,class:"w-4 h-4 animate-spin"})):(o(),E(e(z),{key:1,class:"w-4 h-4"})),t("span",null,r(e(I)?e(_)?e(b)("updatingDraft",e(h)):e(b)("creatingDraft",e(h)):e(_)?e(b)("update",e(h)):e(b)("create",e(h)))+" "+r(e(I)?"":e(b)("draft",e(h))),1)],8,ze),t("button",{type:"button",onClick:s,disabled:e(I),class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 disabled:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(e(b)("cancel",e(h))),9,He)])],32)]))}},Xe={class:"overflow-x-auto"},Ye={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},Je={class:"bg-gray-50 dark:bg-gray-700"},Ke={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Qe={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ze={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},et={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},tt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},st={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},rt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},at={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900 dark:text-white"},nt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"text-sm text-gray-600 dark:text-gray-400"},dt={class:"px-6 py-4 whitespace-nowrap"},it={class:"text-sm text-gray-600 dark:text-gray-400"},ct={class:"px-6 py-4 whitespace-nowrap"},ut={class:"flex items-center space-x-2"},gt={class:"px-6 py-4 whitespace-nowrap"},ft={class:"text-sm text-gray-600 dark:text-gray-400"},yt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},mt={class:"flex items-center justify-end space-x-2"},bt=["onClick","title"],ht=["onClick","title"],xt=["onClick","title"],pt={key:0,class:"text-center py-12"},_t={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},vt={class:"text-gray-600 dark:text-gray-400"},kt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(y){const n=y,{filteredDrafts:x,users:v,t:p,language:_,canEdit:b}=oe(n);function h(a){const g=v.value.find(s=>s.id===a);return g?g.name:"Unknown"}function V(a){return a==="APPROVED"?Pe:a==="PENDING"?re:a==="NOT_APPROVED"?Ne:re}function c(a){return a==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":a==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":a==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function M(a){return a==="APPROVED"?"text-green-500 dark:text-green-400":a==="PENDING"?"text-yellow-500 dark:text-yellow-400":a==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function I(a){if(!a)return"";try{let g;if(Array.isArray(a)&&a.length>=3){const[s,l,w,m=0,N=0,P=0]=a;g=new Date(s,l-1,w,m,N,P)}else if(typeof a=="string")g=new Date(a);else if(a instanceof Date)g=a;else return"Data inválida";return!(g instanceof Date)||isNaN(g.getTime())?"Data inválida":g.toLocaleDateString()}catch{return"Data inválida"}}return(a,g)=>(o(),i("div",Xe,[t("table",Ye,[t("thead",Je,[t("tr",null,[t("th",Ke,r(e(p)("name",e(_))),1),t("th",Qe,r(e(p)("type",e(_))),1),t("th",Ze,r(e(p)("creator",e(_))),1),t("th",et,r(e(p)("status",e(_))),1),t("th",tt,r(e(p)("created",e(_))),1),t("th",st,r(e(p)("actions",e(_))),1)])]),t("tbody",rt,[(o(!0),i(A,null,O(e(x),s=>(o(),i("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",at,[t("div",ot,r(s.name),1)]),t("td",nt,[t("div",lt,r(s.type),1)]),t("td",dt,[t("div",it,r(h(s.creatorId)),1)]),t("td",ct,[t("div",ut,[(o(),E(we(V(s.status)),{class:te(["w-4 h-4",M(s.status)])},null,8,["class"])),t("span",{class:te(c(s.status))},r(e(p)(s.status?.toLowerCase()||"draft",e(_))),3)])]),t("td",gt,[t("div",ft,r(I(s.createdAt)),1)]),t("td",yt,[t("div",mt,[s.status==="APPROVED"&&e(b)(s)?(o(),i("button",{key:0,onClick:l=>a.$emit("transform",s),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:e(p)("transformToContent",e(_))},[u(e(J),{class:"w-4 h-4"})],8,bt)):C("",!0),e(b)(s)?(o(),i("button",{key:1,onClick:l=>a.$emit("edit",s),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:e(p)("editDraft",e(_))},[u(e(Te),{class:"w-4 h-4"})],8,ht)):C("",!0),e(b)(s)?(o(),i("button",{key:2,onClick:l=>a.$emit("delete",s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:e(p)("deleteDraft",e(_))},[u(e(ce),{class:"w-4 h-4"})],8,xt)):C("",!0)])])]))),128))])]),e(x).length?C("",!0):(o(),i("div",pt,[u(e(z),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",_t,r(e(p)("noDraftsFound",e(_))),1),t("p",vt,r(e(p)("createFirstDraft",e(_))),1)]))]))}},wt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},$t={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},Dt={class:"p-6"},Ct={class:"flex items-center mb-4"},Tt={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},It={class:"text-lg font-medium text-gray-900 dark:text-white"},Pt={class:"mb-6"},St={class:"text-gray-600 dark:text-gray-400"},Nt={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},Et={class:"flex items-center"},At={class:"min-w-0 flex-1"},Ot={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Vt={class:"text-xs text-gray-500 dark:text-gray-400"},jt={class:"flex space-x-3 justify-end"},Ut=["disabled"],Mt=["disabled"],Ft={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(y){const{language:n}=Q();return(x,v)=>(o(),i("div",wt,[t("div",$t,[t("div",Dt,[t("div",Ct,[t("div",Tt,[u(e(Se),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),t("div",null,[t("h3",It,r(e(f)("confirmDeletion",e(n))),1)])]),t("div",Pt,[t("p",St,r(e(f)("confirmDeleteDraft",e(n))),1),t("div",Nt,[t("div",Et,[u(e(z),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",At,[t("span",Ot,r(y.draft?.name),1),t("span",Vt,r(y.draft?.type)+" • "+r(e(f)(y.draft?.status?.toLowerCase()||"draft",e(n))),1)])])])]),t("div",jt,[t("button",{onClick:v[0]||(v[0]=p=>x.$emit("cancel")),disabled:y.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(e(f)("cancel",e(n))),9,Ut),t("button",{onClick:v[1]||(v[1]=p=>x.$emit("confirm")),disabled:y.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[y.isDeleting?(o(),E(e(Z),{key:0,class:"w-4 h-4 animate-spin"})):(o(),E(e(ce),{key:1,class:"w-4 h-4"})),t("span",null,r(y.isDeleting?e(f)("deleting",e(n)):e(f)("delete",e(n))),1)],8,Mt)])])])]))}},Rt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Lt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},Bt={class:"p-6"},Gt={class:"flex items-center mb-4"},qt={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},zt={class:"text-lg font-medium text-gray-900 dark:text-white"},Ht={class:"mb-6"},Wt={class:"text-gray-600 dark:text-gray-400 mb-4"},Xt={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},Yt={class:"flex items-center"},Jt={class:"min-w-0 flex-1"},Kt={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Qt={class:"text-xs text-gray-500 dark:text-gray-400"},Zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},es={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ts=["disabled"],ss={value:""},rs=["value"],as={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},os=["disabled"],ns={value:""},ls=["value"],ds={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},is={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},cs=["disabled"],us={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},gs=["disabled"],fs={value:"PENDING"},ys={value:"IN_PRODUCTION"},ms={value:"POSTED"},bs={value:"FINISHED"},hs={value:"CANCELED"},xs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ps={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},_s=["id","value","disabled"],vs=["for"],ks={key:0,class:"text-xs text-red-500 mt-1"},ws={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},$s=["disabled"],Ds=["disabled"],Cs={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(y){const{language:n}=Q(),{channels:x,products:v,users:p,fetchChannels:_,fetchProducts:b,fetchUsers:h}=ie(),V=y,c=K({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:""});de(async()=>{await Promise.all([x.value&&x.value.length>0?Promise.resolve():_(),v.value&&v.value.length>0?Promise.resolve():b(),p.value&&p.value.length>0?Promise.resolve():h()])}),ne(()=>V.draft,()=>{c.status="PENDING",c.channelIds=[],c.productId="",c.producerId="",c.postDate=""},{immediate:!0});const M=g=>{if(!g)return"";const s=f(`contentTypes.${g}`,n.value);return s.startsWith("contentTypes.")?g:s},I=g=>{if(!g)return;const s=new Date(g),l=s.getFullYear(),w=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0"),N=String(s.getHours()).padStart(2,"0"),P=String(s.getMinutes()).padStart(2,"0"),F=String(s.getSeconds()).padStart(2,"0");return`${l}-${w}-${m}T${N}:${P}:${F}`},a=()=>({status:c.status,channelIds:c.channelIds,productId:c.productId||void 0,producerId:c.producerId||void 0,postDate:I(c.postDate)});return(g,s)=>(o(),i("div",Rt,[t("div",Lt,[t("div",Bt,[t("div",Gt,[t("div",qt,[u(e(J),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),t("div",null,[t("h3",zt,r(e(f)("transformDraft",e(n))),1)])]),t("div",Ht,[t("p",Wt,r(e(f)("transformDraftDescription",e(n))),1),t("div",Xt,[t("div",Yt,[u(e(z),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",Jt,[t("span",Kt,r(y.draft?.name),1),t("span",Qt,r(M(y.draft?.type)),1)])])]),t("form",{onSubmit:s[5]||(s[5]=le(l=>g.$emit("confirm",a()),["prevent"])),class:"space-y-4"},[t("div",Zt,[t("div",null,[t("label",es,r(e(f)("product",e(n))),1),S(t("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>c.productId=l),disabled:y.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",ss,r(e(f)("selectProduct",e(n))),1),(o(!0),i(A,null,O(e(v),l=>(o(),i("option",{key:l.id,value:l.id},r(l.name),9,rs))),128))],8,ts),[[U,c.productId]])]),t("div",null,[t("label",as,r(e(f)("producer",e(n))),1),S(t("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>c.producerId=l),disabled:y.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",ns,r(e(f)("selectProducer",e(n))),1),(o(!0),i(A,null,O(e(p),l=>(o(),i("option",{key:l.id,value:l.id},r(l.name),9,ls))),128))],8,os),[[U,c.producerId]])])]),t("div",ds,[t("div",null,[t("label",is,r(e(f)("postDate",e(n))),1),S(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>c.postDate=l),type:"datetime-local",disabled:y.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,cs),[[Y,c.postDate]])]),t("div",null,[t("label",us,r(e(f)("status",e(n))),1),S(t("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>c.status=l),required:"",disabled:y.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",fs,r(e(f)("pending",e(n))),1),t("option",ys,r(e(f)("in_production",e(n))),1),t("option",ms,r(e(f)("posted",e(n))),1),t("option",bs,r(e(f)("finished",e(n))),1),t("option",hs,r(e(f)("canceled",e(n))),1)],8,gs),[[U,c.status]])])]),t("div",null,[t("label",xs,r(e(f)("channels",e(n)))+" * ",1),t("div",ps,[(o(!0),i(A,null,O(e(x),l=>(o(),i("div",{key:l.id,class:"flex items-center"},[S(t("input",{id:`channel-${l.id}`,type:"checkbox",value:l.id,"onUpdate:modelValue":s[4]||(s[4]=w=>c.channelIds=w),disabled:y.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,_s),[[$e,c.channelIds]]),t("label",{for:`channel-${l.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},r(l.name),9,vs)]))),128))]),c.channelIds.length===0?(o(),i("p",ks,r(e(f)("selectAtLeastOneChannel",e(n))),1)):C("",!0)])],32)]),t("div",ws,[t("button",{onClick:s[6]||(s[6]=l=>g.$emit("cancel")),disabled:y.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(e(f)("cancel",e(n))),9,$s),t("button",{onClick:s[7]||(s[7]=l=>g.$emit("confirm",a())),disabled:y.isTransforming||c.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[y.isTransforming?(o(),E(e(Z),{key:0,class:"w-4 h-4 animate-spin"})):(o(),E(e(J),{key:1,class:"w-4 h-4"})),t("span",null,r(y.isTransforming?e(f)("transforming",e(n)):e(f)("transform",e(n))),1)],8,Ds)])])])]))}},Ts={class:"space-y-6"},Is={class:"flex justify-between items-center"},Ps={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ss={key:0,class:"space-y-6"},Ns={class:"flex space-x-4"},Es={class:"overflow-x-auto"},As={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},Os={class:"bg-gray-50 dark:bg-gray-700"},Vs={class:"px-6 py-3 text-left"},js={class:"px-6 py-3 text-left"},Us={class:"px-6 py-3 text-left"},Ms={class:"px-6 py-3 text-left"},Fs={class:"px-6 py-3 text-left"},Rs={class:"px-6 py-3 text-right"},Ls={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Bs={class:"px-6 py-4"},Gs={class:"px-6 py-4"},qs={class:"px-6 py-4"},zs={class:"px-6 py-4"},Hs={class:"flex items-center space-x-2"},Ws={class:"px-6 py-4"},Xs={class:"px-6 py-4"},Ys={class:"flex items-center justify-end space-x-2"},Js={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ks={class:"text-red-600"},Qs={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Zs={class:"text-green-600"},er={key:3,class:"flex space-x-4"},tr={value:""},sr=["value"],rr={value:""},ar=["value"],or={key:5},mr={__name:"DraftManager",setup(y){const{language:n}=Q(),{currentUser:x}=De(),{drafts:v,users:p,loadingDrafts:_,errors:b,fetchDrafts:h,fetchUsers:V,fetchChannels:c,createDraft:M,updateDraft:I,deleteDraft:a,transformDraftToContent:g}=ie(),s=d=>f(d,n.value),l=["Post","Story","Reels","Video","Artigo"],w=["PENDING","APPROVED","NOT_APPROVED"],m=T(!1),N=T(null),P=T(""),F=T(""),H=K({name:"",type:"",content:"",status:"PENDING"}),B=T(!1),j=T(""),G=T(!1),q=T(!1),R=T(null),L=T(null),W=T(!1),X=T(!1);de(async()=>{v.value=[];const d=[V(),c()];d.push(h()),await Promise.all(d)});const ue=se(()=>!v.value||!x.value?[]:x.value.adminType==="ADMIN"?v.value:v.value.filter(d=>d.creatorId===x.value.id)),ge=se(()=>ue.value.filter(d=>!(P.value&&d.status!==P.value||F.value&&d.type!==F.value)));async function fe(){await h(P.value||null)}async function ye(d){if(!B.value){B.value=!0,j.value="";try{let k;if(N.value)k=await I(N.value.id,d);else{const D={...d,creatorId:x.value.id,status:d.status||"PENDING"};k=await M(D)}k.success?(j.value=N.value?s("draftUpdatedSuccessfully"):s("draftCreatedSuccessfully"),ee(),await h(P.value||null)):console.error("Error:",k.error)}catch(k){console.error("Unexpected error:",k)}finally{B.value=!1}}}function me(d){N.value=d,Object.assign(H,{name:d.name,type:d.type,content:d.content||"",status:d.status}),m.value=!0}function ee(){m.value=!1,N.value=null,Object.assign(H,{name:"",type:"",content:"",status:"PENDING"}),j.value=""}async function be(d){R.value=d,G.value=!0}async function he(){if(R.value){W.value=!0;try{const d=await a(R.value.id);d.success?(j.value=s("draftDeletedSuccessfully"),G.value=!1,R.value=null):console.error("Error:",d.error)}catch(d){console.error("Unexpected error:",d)}finally{W.value=!1}}}function xe(){G.value=!1,R.value=null}async function pe(d){L.value=d,q.value=!0}async function _e(d){if(L.value){X.value=!0;try{const k=await g(L.value.id,d);k.success?(j.value=s("draftTransformed"),q.value=!1,L.value=null,await h(P.value||null)):console.error("Error:",k.error)}catch(k){console.error("Unexpected error:",k)}finally{X.value=!1}}}function ve(){q.value=!1,L.value=null}function ke(d){return x.value?x.value.adminType==="ADMIN"||d.creatorId===x.value.id:!1}return(d,k)=>(o(),i("div",Ts,[t("div",Is,[t("h2",Ps,r(s("drafts",e(n))),1),t("button",{onClick:k[0]||(k[0]=D=>m.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[u(e(Ie),{class:"w-4 h-4 mr-2"}),Ce(" "+r(s("newDraft",e(n))),1)])]),e(_)?(o(),i("div",Ss,[t("div",Ns,[u($,{customClass:"h-10 w-32"}),u($,{customClass:"h-10 w-32"})]),t("div",Es,[t("table",As,[t("thead",Os,[t("tr",null,[t("th",Vs,[u($,{customClass:"h-4 w-16"})]),t("th",js,[u($,{customClass:"h-4 w-12"})]),t("th",Us,[u($,{customClass:"h-4 w-20"})]),t("th",Ms,[u($,{customClass:"h-4 w-16"})]),t("th",Fs,[u($,{customClass:"h-4 w-20"})]),t("th",Rs,[u($,{customClass:"h-4 w-16"})])])]),t("tbody",Ls,[(o(),i(A,null,O(5,D=>t("tr",{key:D,class:"animate-pulse"},[t("td",Bs,[u($,{customClass:"h-4 w-32"})]),t("td",Gs,[u($,{customClass:"h-4 w-16"})]),t("td",qs,[u($,{customClass:"h-4 w-24"})]),t("td",zs,[t("div",Hs,[u($,{customClass:"h-4 w-4 rounded-full"}),u($,{customClass:"h-4 w-20"})])]),t("td",Ws,[u($,{customClass:"h-4 w-24"})]),t("td",Xs,[t("div",Ys,[u($,{customClass:"h-8 w-8 rounded"}),u($,{customClass:"h-8 w-8 rounded"}),u($,{customClass:"h-8 w-8 rounded"})])])])),64))])])])])):e(b).drafts?(o(),i("div",Js,[t("p",Ks,r(e(b).drafts),1)])):C("",!0),j.value?(o(),i("div",Qs,[t("p",Zs,r(j.value),1)])):C("",!0),e(_)?C("",!0):(o(),i("div",er,[S(t("select",{"onUpdate:modelValue":k[1]||(k[1]=D=>P.value=D),onChange:fe,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",tr,r(s("allStatuses",e(n))),1),(o(),i(A,null,O(w,D=>t("option",{key:D,value:D},r(s(D.toLowerCase(),e(n))),9,sr)),64))],544),[[U,P.value]]),S(t("select",{"onUpdate:modelValue":k[2]||(k[2]=D=>F.value=D),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",rr,r(s("allTypes",e(n))),1),(o(),i(A,null,O(l,D=>t("option",{key:D,value:D},r(D),9,ar)),64))],512),[[U,F.value]])])),m.value?(o(),E(We,{key:4,user:e(x),editingDraft:N.value,t:s,language:e(n),contentTypes:l,draftStatuses:w,show:m.value,formData:H,isSubmitting:B.value,onSubmit:ye,onCancel:ee},null,8,["user","editingDraft","language","show","formData","isSubmitting"])):C("",!0),e(_)?C("",!0):(o(),i("div",or,[u(kt,{filteredDrafts:ge.value,users:e(p),t:s,language:e(n),canEdit:ke,onEdit:me,onDelete:be,onTransform:pe},null,8,["filteredDrafts","users","language"])])),G.value?(o(),E(Ft,{key:6,draft:R.value,"is-deleting":W.value,onConfirm:he,onCancel:xe},null,8,["draft","is-deleting"])):C("",!0),q.value?(o(),E(Cs,{key:7,draft:L.value,"is-transforming":X.value,onConfirm:_e,onCancel:ve},null,8,["draft","is-transforming"])):C("",!0)]))}};export{mr as default};
