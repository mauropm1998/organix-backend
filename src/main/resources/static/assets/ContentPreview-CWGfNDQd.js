import{r as k,z as de,y as A,l as ce,d as ie,e as ue,x as ge,a as c,b as e,f as u,p as f,u as o,t as s,n as F,q as m,s as b,j as T,i as ye,F as ve,G as pe,I as xe,k as me,o as i}from"./index-DSC5aajj.js";import{u as _e,c as he}from"./useData-X35BpfxY.js";import{m as B,E as ke,C as fe,a as be,_ as we}from"./index-TZcktg30.js";import{S as De}from"./square-pen-Blli_rXZ.js";import"./userService-DmCT3zp9.js";import"./loader-circle-CYsQVaGS.js";import"./plus-J_RR_41C.js";const Se={class:"space-y-6"},Ie={class:"flex items-start justify-between flex-wrap gap-4"},Ee={class:"space-y-2"},Ne={class:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3"},Ce={key:0},Ae={key:1,class:"h-6 w-52 rounded shimmer-block"},Te={key:0,class:"flex flex-wrap gap-2"},Oe={class:"flex items-center gap-3"},je={key:0,class:"space-y-6"},Pe={class:"flex flex-col lg:flex-row gap-8"},Me={class:"flex-1 space-y-5"},$e={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"},Fe={key:1,class:"p-6 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300"},Be={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Le={class:"lg:col-span-2 space-y-6"},Ue={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},He={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},qe={class:"whitespace-pre-wrap text-sm leading-relaxed text-gray-800 dark:text-gray-200 font-sans bg-gray-50 dark:bg-gray-900/40 p-4 rounded border border-gray-100 dark:border-gray-700 overflow-auto max-h-96"},ze={key:0,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},Ge={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Re={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Ye={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 text-center"},Je={class:"text-[10px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-medium"},Ve={class:"mt-1 text-lg font-semibold text-gray-800 dark:text-gray-100 tabular-nums"},Ke={key:1,class:"border-t border-gray-200 dark:border-gray-700 my-4"},Qe={key:2,class:"space-y-4"},We={class:"flex items-center justify-between mb-3"},Xe={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Ze={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 text-xs"},et={class:"flex flex-col"},tt={class:"text-gray-500 dark:text-gray-400"},at={class:"font-semibold text-gray-800 dark:text-gray-100"},st={class:"flex flex-col"},rt={class:"text-gray-500 dark:text-gray-400"},ot={class:"font-semibold text-gray-800 dark:text-gray-100"},nt={class:"flex flex-col"},lt={class:"text-gray-500 dark:text-gray-400"},dt={class:"font-semibold text-gray-800 dark:text-gray-100"},ct={class:"flex flex-col"},it={class:"text-gray-500 dark:text-gray-400"},ut={class:"font-semibold text-gray-800 dark:text-gray-100"},gt={class:"flex flex-col"},yt={class:"text-gray-500 dark:text-gray-400"},vt={class:"font-semibold text-gray-800 dark:text-gray-100"},pt={class:"flex flex-col"},xt={class:"text-gray-500 dark:text-gray-400"},mt={class:"font-semibold text-gray-800 dark:text-gray-100"},_t={key:3,class:"text-sm text-gray-500 dark:text-gray-400"},ht={class:"space-y-6"},kt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},ft={class:"text-sm font-semibold tracking-wide text-gray-500 dark:text-gray-400 uppercase"},bt={class:"space-y-3 text-sm"},wt={class:"flex justify-between gap-4"},Dt={class:"text-gray-500 dark:text-gray-400"},St={class:"text-gray-800 dark:text-gray-200 font-medium"},It={key:0,class:"flex justify-between gap-4"},Et={class:"text-gray-500 dark:text-gray-400"},Nt={class:"text-gray-800 dark:text-gray-200 font-medium"},Ct={key:1,class:"flex justify-between gap-4"},At={class:"text-gray-500 dark:text-gray-400"},Tt={class:"text-gray-800 dark:text-gray-200 font-medium"},Ot={key:2,class:"flex justify-between gap-4"},jt={class:"text-gray-500 dark:text-gray-400"},Pt={class:"text-gray-800 dark:text-gray-200 font-medium"},Mt={key:3,class:"flex justify-between gap-4"},$t={class:"text-gray-500 dark:text-gray-400"},Ft={class:"text-gray-800 dark:text-gray-200 font-medium"},Bt={class:"flex justify-between gap-4"},Lt={class:"text-gray-500 dark:text-gray-400"},Ut={class:"text-gray-800 dark:text-gray-200 font-medium"},Ht={class:"flex justify-between gap-4"},qt={class:"text-gray-500 dark:text-gray-400"},zt={class:"text-gray-800 dark:text-gray-200 font-medium"},Gt={key:4,class:"flex justify-between gap-4"},Rt={class:"text-gray-500 dark:text-gray-400"},Yt={class:"text-gray-800 dark:text-gray-200 font-medium"},Jt={class:"flex justify-between gap-4"},Vt={class:"text-gray-800 dark:text-gray-200 font-mono text-xs tracking-wide"},Kt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"},Qt={class:"text-sm font-semibold tracking-wide text-gray-500 dark:text-gray-400 uppercase flex items-center gap-2 mb-4"},Wt={key:0,class:"space-y-4 list-none m-0 p-0"},Xt={class:"flex flex-col items-center self-stretch"},Zt={key:0,class:"flex-1 w-px bg-gray-200 dark:bg-gray-700 mt-1"},ea={class:"flex-1 min-w-0"},ta={class:"flex flex-wrap items-center gap-2 text-xs font-medium text-gray-800 dark:text-gray-200"},aa=["title"],sa={class:"flex flex-wrap items-center gap-1"},ra={key:0,class:"text-gray-500 dark:text-gray-400"},oa={key:1,class:"text-gray-400"},na={class:"text-[10px] text-gray-500 dark:text-gray-400 mt-1"},la={key:1,class:"text-xs text-gray-500 dark:text-gray-400 flex flex-col items-start gap-3 leading-normal"},da={class:"flex items-center gap-3"},ca={class:"space-y-0.5"},ia={class:"font-medium text-gray-700 dark:text-gray-300 leading-snug"},ua={class:"text-[11px] text-gray-500 dark:text-gray-400 leading-snug"},ka={__name:"ContentPreview",setup(ga){const L=xe(),U=me(),{currentUser:w}=ce(),{language:n}=ue(),d=(r,a=n.value)=>ie(r,a),{products:O,channels:j,users:P,fetchProducts:H,fetchChannels:q,fetchUsers:z,updateContent:G}=_e(),t=k(null),I=k(!0),D=k(""),S=k(!1),E=k(!1),g=de({name:"",type:"",content:"",product:"",creator:"",producer:"",status:"PENDING",postDate:"",channels:[],productionStartDate:"",productionEndDate:"",metaAdsId:""}),R=be,Y=fe,J=A(()=>!t.value||!w.value?!1:w.value.adminType==="ADMIN"||[t.value.creatorId,t.value.producerId].includes(w.value.id)),V=r=>({PENDING:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",IN_PRODUCTION:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",POSTED:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",FINISHED:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",CANCELED:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[r]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",K=r=>({PENDING:"bg-yellow-400",IN_PRODUCTION:"bg-blue-500",POSTED:"bg-green-500",FINISHED:"bg-purple-500",CANCELED:"bg-red-500"})[r]||"bg-gray-400",Q=A(()=>{if(!t.value?.metrics)return!1;const{views:r,likes:a,comments:l,shares:y,reach:v,engagement:p}=t.value.metrics;return[r,a,l,y,v,p].some(x=>typeof x=="number")}),W=A(()=>{if(!t.value?.metrics)return[];const r=t.value.metrics;return[{key:"views",label:d("views",n.value),value:r.views??0},{key:"likes",label:d("likes",n.value),value:r.likes??0},{key:"comments",label:d("comments",n.value),value:r.comments??0},{key:"shares",label:d("shares",n.value),value:r.shares??0},{key:"reach",label:d("reach",n.value),value:r.reach??0},{key:"engagement",label:d("engagement",n.value),value:r.engagement??0}]});function X(r){return O.value?.find(a=>a.id===r)?.name||"-"}function M(r){return P.value?.find(a=>a.id===r)?.name||"-"}function Z(r){return j.value?.find(a=>a.id===r)?.name||r}function _(r){if(!r)return"";let a;if(Array.isArray(r)){const[y,v,p,x=0,h=0]=r;a=new Date(y,v-1,p,x,h)}else a=new Date(r);const l=n.value==="pt"?"pt-PT":"en-US";return a.toLocaleString(l,{dateStyle:"medium",timeStyle:"short"})}function N(r){if(!r)return"";let a;if(Array.isArray(r)){const[h,re,oe,ne=0,le=0]=r;a=new Date(h,re-1,oe,ne,le)}else a=new Date(r);const l=a.getFullYear(),y=String(a.getMonth()+1).padStart(2,"0"),v=String(a.getDate()).padStart(2,"0"),p=String(a.getHours()).padStart(2,"0"),x=String(a.getMinutes()).padStart(2,"0");return`${l}-${y}-${v}T${p}:${x}`}function C(r){if(!r)return;const a=new Date(r),l=a.getFullYear(),y=String(a.getMonth()+1).padStart(2,"0"),v=String(a.getDate()).padStart(2,"0"),p=String(a.getHours()).padStart(2,"0"),x=String(a.getMinutes()).padStart(2,"0"),h=String(a.getSeconds()).padStart(2,"0");return`${l}-${y}-${v}T${p}:${x}:${h}`}async function $(){I.value=!0,D.value="";try{await Promise.all([H(),q(),z()]);const r=L.params.id,a=await he.getContentById(r);t.value=a}catch(r){D.value=r?.response?.data?.message||r.message||"Erro ao carregar conteúdo"}finally{I.value=!1}}function ee(){t.value&&(Object.assign(g,{name:t.value.name,type:t.value.type,content:t.value.content,product:t.value.productId,creator:t.value.creatorId,producer:t.value.producerId,status:t.value.status,postDate:N(t.value.postDate),channels:t.value.channels?.map(r=>r.id)||[],productionStartDate:t.value.productionStartDate?N(t.value.productionStartDate):"",productionEndDate:t.value.productionEndDate?N(t.value.productionEndDate):"",metaAdsId:t.value.metaAdsId||""}),S.value=!0)}function te(){console.log("🔙 Clicou em Voltar - navegando para ContentManager com from=preview"),B(),U.push({name:"ContentManager",query:{from:"preview"}})}function ae(){S.value=!1}async function se(){if(t.value){console.log("🔥 saveEdit chamado no ContentPreview! Iniciando processo de salvamento..."),console.log("📝 Edit Form Data atual:",JSON.stringify(g,null,2)),console.log("✏️ Content ID:",t.value.id),E.value=!0;try{const r={name:g.name,type:g.type,content:g.content,productId:g.product||null,producerId:g.producer||null,status:g.status,postDate:C(g.postDate),productionStartDate:C(g.productionStartDate)||null,productionEndDate:C(g.productionEndDate)||null,metaAdsId:g.metaAdsId||null,channelIds:g.channels};console.log("=== DADOS ENVIADOS AO BACKEND (ContentPreview) ==="),console.log("Operação: UPDATE"),console.log("Content ID:",t.value.id),console.log("Payload:",JSON.stringify(r,null,2)),console.log("=================================================="),await G(t.value.id,r),S.value=!1,await $()}catch(r){console.error(r),alert(r?.response?.data?.message||r.message||"Erro ao atualizar")}finally{E.value=!1}}}return ge(()=>{B(),$()}),(r,a)=>(i(),c("div",Se,[e("div",Ie,[e("div",Ee,[e("h1",Ne,[f(o(ke),{class:"w-6 h-6 text-blue-600 dark:text-blue-400"}),t.value?(i(),c("span",Ce,s(t.value.name),1)):(i(),c("span",Ae)),t.value?(i(),c("span",{key:2,class:F(["text-xs px-2 py-1 rounded-full font-medium",V(t.value.status)])},s(d(t.value.status,o(n).value)),3)):u("",!0)]),t.value?.channels?.length?(i(),c("div",Te,[(i(!0),c(m,null,b(t.value.channels,l=>(i(),c("span",{key:l.id,class:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"},s(l.name),1))),128))])):u("",!0)]),e("div",Oe,[t.value&&J.value?(i(),c("button",{key:0,onClick:ee,class:"inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded-lg transition-colors"},[f(o(De),{class:"w-4 h-4 mr-2"}),T(" "+s(d("edit",o(n).value)),1)])):u("",!0),e("button",{onClick:te,class:"inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 text-sm rounded-lg transition-colors"},s(d("back",o(n).value)),1)])]),I.value?(i(),c("div",je,[a[6]||(a[6]=e("div",{class:"h-7 w-1/3 rounded shimmer-block"},null,-1)),e("div",Pe,[e("div",Me,[a[0]||(a[0]=e("div",{class:"h-5 w-2/3 rounded shimmer-block"},null,-1)),a[1]||(a[1]=e("div",{class:"h-40 rounded shimmer-block"},null,-1)),a[2]||(a[2]=e("div",{class:"h-5 w-1/4 rounded shimmer-block"},null,-1)),e("div",$e,[(i(),c(m,null,b(6,l=>e("div",{key:l,class:"h-16 rounded shimmer-block"})),64))]),a[3]||(a[3]=e("div",{class:"h-5 w-40 rounded shimmer-block"},null,-1)),a[4]||(a[4]=e("div",{class:"h-24 rounded shimmer-block"},null,-1))]),a[5]||(a[5]=ye('<div class="w-full lg:w-80 space-y-4"><div class="h-5 w-1/2 rounded shimmer-block"></div><div class="h-32 rounded shimmer-block"></div><div class="h-5 w-2/3 rounded shimmer-block"></div><div class="h-48 rounded shimmer-block"></div></div>',1))])])):D.value?(i(),c("div",Fe,s(D.value),1)):t.value?(i(),c("div",Be,[e("div",Le,[e("section",Ue,[e("h2",He,[f(o(ve),{class:"w-5 h-5 text-gray-400"}),T(" "+s(d("content",o(n).value)),1)]),e("pre",qe,s(t.value.content),1)]),t.value.status==="POSTED"?(i(),c("section",ze,[e("h2",Ge,[f(o(pe),{class:"w-5 h-5 text-gray-400"}),T(" "+s(d("metrics",o(n).value)),1)]),t.value.metrics?(i(),c(m,{key:1},[Q.value?(i(),c("div",Ye,[(i(!0),c(m,null,b(W.value,l=>(i(),c("div",{key:l.key,class:"p-3 rounded bg-gray-50 dark:bg-gray-900/40 border border-gray-100 dark:border-gray-700"},[e("div",Je,s(l.label),1),e("div",Ve,s(l.value),1)]))),128))])):u("",!0),t.value.metrics.channelMetrics?.length?(i(),c("div",Ke)):u("",!0),t.value.metrics.channelMetrics?.length?(i(),c("div",Qe,[(i(!0),c(m,null,b(t.value.metrics.channelMetrics,l=>(i(),c("div",{key:l.channelId,class:"p-4 rounded border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/40"},[e("div",We,[e("h3",Xe,s(Z(l.channelId)),1)]),e("div",Ze,[e("div",et,[e("span",tt,s(d("likes",o(n).value)),1),e("span",at,s(l.likes),1)]),e("div",st,[e("span",rt,s(d("comments",o(n).value)),1),e("span",ot,s(l.comments),1)]),e("div",nt,[e("span",lt,s(d("shares",o(n).value)),1),e("span",dt,s(l.shares),1)]),e("div",ct,[e("span",it,s(d("postClicks",o(n).value)),1),e("span",ut,s(l.postClicks),1)]),e("div",gt,[e("span",yt,s(d("siteVisits",o(n).value)),1),e("span",vt,s(l.siteVisits),1)]),e("div",pt,[e("span",xt,s(d("newAccounts",o(n).value)),1),e("span",mt,s(l.newAccounts),1)])])]))),128))])):(i(),c("div",_t,s(d("noChannelMetrics",o(n).value)),1))],64)):(i(),c("div",Re,s(d("noMetrics",o(n).value)),1))])):u("",!0)]),e("aside",ht,[e("section",kt,[e("h2",ft,s(d("details",o(n).value)),1),e("dl",bt,[e("div",wt,[e("dt",Dt,s(d("type",o(n).value)),1),e("dd",St,s(d(`contentTypes.${t.value.type}`,o(n).value)),1)]),t.value.productId?(i(),c("div",It,[e("dt",Et,s(d("product",o(n).value)),1),e("dd",Nt,s(X(t.value.productId)),1)])):u("",!0),t.value.creatorName||t.value.creatorId?(i(),c("div",Ct,[e("dt",At,s(d("creator",o(n).value)),1),e("dd",Tt,s(t.value.creatorName||M(t.value.creatorId)),1)])):u("",!0),t.value.producerName||t.value.producerId?(i(),c("div",Ot,[e("dt",jt,s(d("producer",o(n).value)),1),e("dd",Pt,s(t.value.producerName||M(t.value.producerId)),1)])):u("",!0),t.value.creationDate?(i(),c("div",Mt,[e("dt",$t,s(d("createdAt",o(n).value)),1),e("dd",Ft,s(_(t.value.creationDate)),1)])):u("",!0),e("div",Bt,[e("dt",Lt,s(d("productionStartDate",o(n).value)),1),e("dd",Ut,s(t.value.productionStartDate?_(t.value.productionStartDate):"—"),1)]),e("div",Ht,[e("dt",qt,s(d("productionEndDate",o(n).value)),1),e("dd",zt,s(t.value.productionEndDate?_(t.value.productionEndDate):"—"),1)]),t.value.postDate?(i(),c("div",Gt,[e("dt",Rt,s(d("postDate",o(n).value)),1),e("dd",Yt,s(_(t.value.postDate)),1)])):u("",!0),e("div",Jt,[a[7]||(a[7]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Meta Ads ID",-1)),e("dd",Vt,s(t.value.metaAdsId||"—"),1)])])]),e("section",Kt,[e("h2",Qt,s(d("history",o(n).value)),1),t.value.history&&t.value.history.length?(i(),c("ol",Wt,[(i(!0),c(m,null,b(t.value.history,(l,y)=>(i(),c("li",{key:l.changedAt+(l.newStatus||""),class:"flex items-start gap-4"},[e("div",Xt,[e("span",{class:F(["w-3 h-3 rounded-full ring-4 ring-white dark:ring-gray-800",K(l.newStatus)])},null,2),y<t.value.history.length-1?(i(),c("span",Zt)):u("",!0)]),e("div",ea,[e("div",ta,[e("span",{class:"truncate max-w-[140px]",title:l.userName},s(l.userName),9,aa),a[8]||(a[8]=e("span",{class:"text-gray-400"},"•",-1)),e("span",sa,[l.previousStatus?(i(),c("span",ra,s(d(l.previousStatus,o(n).value)),1)):u("",!0),l.previousStatus?(i(),c("span",oa,"→")):u("",!0),e("span",null,s(d(l.newStatus,o(n).value)),1)])]),e("div",na,s(_(l.changedAt)),1)])]))),128))])):(i(),c("div",la,[e("div",da,[a[9]||(a[9]=e("div",{class:"w-8 h-8 aspect-square rounded-full bg-gray-100 dark:bg-gray-700 inline-flex items-center justify-center flex-none shrink-0"},[e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ca,[e("div",ia,s(d("noHistoryTitle",o(n).value)),1),e("div",ua,s(d("noHistoryDesc",o(n).value)),1)])])]))])])])):u("",!0),f(we,{show:S.value,"form-data":g,"editing-content":t.value,products:o(O),users:o(P),channels:o(j),"content-types":o(R),"content-statuses":o(Y),t:d,language:o(n).value,user:o(w),"is-submitting":E.value,onCancel:ae,onSubmit:se},null,8,["show","form-data","editing-content","products","users","channels","content-types","content-statuses","language","user","is-submitting"])]))}};export{ka as default};
