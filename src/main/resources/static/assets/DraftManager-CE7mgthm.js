import{c as ce,m as ue,z as se,A as re,a as i,o as n,b as t,t as s,u as e,f as T,g as S,v as ee,B as M,q as A,s as V,h as O,F as J,w as ge,n as le,C as Oe,p as u,d as f,e as ae,x as fe,D as Ae,r as C,y as Y,l as Ve,j as de}from"./index-NEpPsdbC.js";import{u as me}from"./useData-CoCRTTjc.js";import{_ as $}from"./SkeletonLoader-CT9vKxgG.js";import{L as oe}from"./loader-circle-BMnpDFdt.js";import{A as te}from"./arrow-right-qVTgIVyW.js";import{S as je}from"./square-pen-DOWlPt1F.js";import{T as ye,a as Ue}from"./triangle-alert-6kB1HHRI.js";import{C as Fe}from"./circle-check-big-WybylD0T.js";import{P as Me}from"./plus-CkdgHC_B.js";import"./userService-Dm1G1Bn4.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=ce("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=ce("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Le={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Be={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},He={value:""},We=["value"],Xe={key:0},Ye={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Je=["value"],Ke={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Qe=["placeholder"],Ze={class:"flex space-x-3"},et=["disabled"],tt=["disabled"],st={__name:"DraftForm",props:{user:Object,editingDraft:Object,t:Function,language:String,contentTypes:Array,draftStatuses:Array,show:Boolean,formData:Object,isSubmitting:Boolean},emits:["submit","cancel"],setup(m,{emit:a}){const v=m,k=a,{user:h,editingDraft:p,t:b,language:x,contentTypes:j,draftStatuses:c,show:R,isSubmitting:P}=ue(v),o=se({...v.formData});re(()=>v.editingDraft,l=>{l?Object.assign(o,l):Object.assign(o,{name:"",type:"",content:"",status:"pending"})});function g(){k("submit",{...o})}function r(){k("cancel")}return(l,w)=>(n(),i("div",Le,[t("h3",Be,s(e(p)?e(b)("editDraft",e(x)):e(b)("createNewDraft",e(x))),1),t("form",{onSubmit:ge(g,["prevent"]),class:"space-y-4"},[t("div",Ge,[t("div",null,[t("label",qe,s(e(b)("name",e(x))),1),S(t("input",{type:"text","onUpdate:modelValue":w[0]||(w[0]=y=>o.name=y),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,512),[[ee,o.name]])]),t("div",null,[t("label",ze,s(e(b)("type",e(x))),1),S(t("select",{"onUpdate:modelValue":w[1]||(w[1]=y=>o.type=y),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},[t("option",He,s(e(b)("type",e(x))),1),(n(!0),i(A,null,V(e(j),y=>(n(),i("option",{key:y,value:y},s(y),9,We))),128))],512),[[M,o.type]])])]),e(h).adminType==="ADMIN"?(n(),i("div",Xe,[t("label",Ye,s(e(b)("status",e(x))),1),S(t("select",{"onUpdate:modelValue":w[2]||(w[2]=y=>o.status=y),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[(n(!0),i(A,null,V(e(c),y=>(n(),i("option",{key:y,value:y},s(e(b)(y,e(x))),9,Je))),128))],512),[[M,o.status]])])):T("",!0),t("div",null,[t("label",Ke,s(e(b)("draftContent",e(x))),1),S(t("textarea",{"onUpdate:modelValue":w[3]||(w[3]=y=>o.content=y),rows:"6",placeholder:e(b)("enterDraftContent",e(x)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,8,Qe),[[ee,o.content]])]),t("div",Ze,[t("button",{type:"submit",disabled:e(P),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e(P)?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(J),{key:1,class:"w-4 h-4"})),t("span",null,s(e(P)?e(p)?e(b)("updatingDraft",e(x)):e(b)("creatingDraft",e(x)):e(p)?e(b)("update",e(x)):e(b)("create",e(x)))+" "+s(e(P)?"":e(b)("draft",e(x))),1)],8,et),t("button",{type:"button",onClick:r,disabled:e(P),class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 disabled:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(b)("cancel",e(x))),9,tt)])],32)]))}},rt={class:"overflow-x-auto"},at={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},ot={class:"bg-gray-50 dark:bg-gray-700"},nt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},lt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},it={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ut={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},gt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ft={class:"px-6 py-4 whitespace-nowrap"},mt={class:"text-sm font-medium text-gray-900 dark:text-white"},yt={class:"px-6 py-4 whitespace-nowrap"},bt={class:"text-sm text-gray-600 dark:text-gray-400"},ht={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm text-gray-600 dark:text-gray-400"},xt={class:"px-6 py-4 whitespace-nowrap"},vt={class:"flex items-center space-x-2"},_t={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm text-gray-600 dark:text-gray-400"},wt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},$t={class:"flex items-center justify-end space-x-2"},Dt=["onClick","title"],Ct=["onClick","title"],Tt=["onClick","title"],Pt={key:0,class:"text-center py-12"},St={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},It={class:"text-gray-600 dark:text-gray-400"},Nt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(m){const a=m,{filteredDrafts:v,users:k,t:h,language:p,canEdit:b}=ue(a);function x(o){const g=k.value.find(r=>r.id===o);return g?g.name:"Unknown"}function j(o){return o==="APPROVED"?Fe:o==="PENDING"?ie:o==="NOT_APPROVED"?Re:ie}function c(o){return o==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":o==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":o==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function R(o){return o==="APPROVED"?"text-green-500 dark:text-green-400":o==="PENDING"?"text-yellow-500 dark:text-yellow-400":o==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function P(o){if(!o)return"";try{let g;if(Array.isArray(o)&&o.length>=3){const[r,l,w,y=0,I=0,N=0]=o;g=new Date(r,l-1,w,y,I,N)}else if(typeof o=="string")g=new Date(o);else if(o instanceof Date)g=o;else return"Data inválida";return!(g instanceof Date)||isNaN(g.getTime())?"Data inválida":g.toLocaleDateString()}catch{return"Data inválida"}}return(o,g)=>(n(),i("div",rt,[t("table",at,[t("thead",ot,[t("tr",null,[t("th",nt,s(e(h)("name",e(p))),1),t("th",lt,s(e(h)("type",e(p))),1),t("th",dt,s(e(h)("creator",e(p))),1),t("th",it,s(e(h)("status",e(p))),1),t("th",ct,s(e(h)("created",e(p))),1),t("th",ut,s(e(h)("actions",e(p))),1)])]),t("tbody",gt,[(n(!0),i(A,null,V(e(v),r=>(n(),i("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",ft,[t("div",mt,s(r.name),1)]),t("td",yt,[t("div",bt,s(r.type),1)]),t("td",ht,[t("div",pt,s(x(r.creatorId)),1)]),t("td",xt,[t("div",vt,[(n(),O(Oe(j(r.status)),{class:le(["w-4 h-4",R(r.status)])},null,8,["class"])),t("span",{class:le(c(r.status))},s(e(h)(r.status?.toLowerCase()||"draft",e(p))),3)])]),t("td",_t,[t("div",kt,s(P(r.createdAt)),1)]),t("td",wt,[t("div",$t,[r.status==="APPROVED"&&e(b)(r)?(n(),i("button",{key:0,onClick:l=>o.$emit("transform",r),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:e(h)("transformToContent",e(p))},[u(e(te),{class:"w-4 h-4"})],8,Dt)):T("",!0),e(b)(r)?(n(),i("button",{key:1,onClick:l=>o.$emit("edit",r),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:e(h)("editDraft",e(p))},[u(e(je),{class:"w-4 h-4"})],8,Ct)):T("",!0),e(b)(r)?(n(),i("button",{key:2,onClick:l=>o.$emit("delete",r),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:e(h)("deleteDraft",e(p))},[u(e(ye),{class:"w-4 h-4"})],8,Tt)):T("",!0)])])]))),128))])]),e(v).length?T("",!0):(n(),i("div",Pt,[u(e(J),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",St,s(e(h)("noDraftsFound",e(p))),1),t("p",It,s(e(h)("createFirstDraft",e(p))),1)]))]))}},Et={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Ot={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},At={class:"p-6"},Vt={class:"flex items-center mb-4"},jt={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},Ut={class:"text-lg font-medium text-gray-900 dark:text-white"},Ft={class:"mb-6"},Mt={class:"text-gray-600 dark:text-gray-400"},Rt={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},Lt={class:"flex items-center"},Bt={class:"min-w-0 flex-1"},Gt={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},qt={class:"text-xs text-gray-500 dark:text-gray-400"},zt={class:"flex space-x-3 justify-end"},Ht=["disabled"],Wt=["disabled"],Xt={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:a}=ae();return(v,k)=>(n(),i("div",Et,[t("div",Ot,[t("div",At,[t("div",Vt,[t("div",jt,[u(e(Ue),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),t("div",null,[t("h3",Ut,s(e(f)("confirmDeletion",e(a))),1)])]),t("div",Ft,[t("p",Mt,s(e(f)("confirmDeleteDraft",e(a))),1),t("div",Rt,[t("div",Lt,[u(e(J),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",Bt,[t("span",Gt,s(m.draft?.name),1),t("span",qt,s(m.draft?.type)+" • "+s(e(f)(m.draft?.status?.toLowerCase()||"draft",e(a))),1)])])])]),t("div",zt,[t("button",{onClick:k[0]||(k[0]=h=>v.$emit("cancel")),disabled:m.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(f)("cancel",e(a))),9,Ht),t("button",{onClick:k[1]||(k[1]=h=>v.$emit("confirm")),disabled:m.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isDeleting?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(ye),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isDeleting?e(f)("deleting",e(a)):e(f)("delete",e(a))),1)],8,Wt)])])])]))}},Yt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Jt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},Kt={class:"p-6"},Qt={class:"flex items-center mb-4"},Zt={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},es={class:"text-lg font-medium text-gray-900 dark:text-white"},ts={class:"mb-6"},ss={class:"text-gray-600 dark:text-gray-400 mb-4"},rs={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},as={class:"flex items-center"},os={class:"min-w-0 flex-1"},ns={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ls={class:"text-xs text-gray-500 dark:text-gray-400"},ds={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},is={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},cs=["disabled"],us={value:""},gs=["value"],fs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ms=["disabled"],ys={value:""},bs=["value"],hs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ps={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},xs=["disabled"],vs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},_s=["disabled"],ks={value:"PENDING"},ws={value:"IN_PRODUCTION"},$s={value:"POSTED"},Ds={value:"FINISHED"},Cs={value:"CANCELED"},Ts={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ps={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},Ss=["id","value","disabled"],Is=["for"],Ns={key:0,class:"text-xs text-red-500 mt-1"},Es={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},Os=["disabled"],As=["disabled"],Vs={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:a}=ae(),{channels:v,products:k,users:h,fetchChannels:p,fetchProducts:b,fetchUsers:x}=me(),j=m,c=se({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:""});fe(async()=>{await Promise.all([v.value&&v.value.length>0?Promise.resolve():p(),k.value&&k.value.length>0?Promise.resolve():b(),h.value&&h.value.length>0?Promise.resolve():x()])}),re(()=>j.draft,()=>{c.status="PENDING",c.channelIds=[],c.productId="",c.producerId="",c.postDate=""},{immediate:!0});const R=g=>{if(!g)return"";const r=f(`contentTypes.${g}`,a.value);return r.startsWith("contentTypes.")?g:r},P=g=>{if(!g)return;const r=new Date(g),l=r.getFullYear(),w=String(r.getMonth()+1).padStart(2,"0"),y=String(r.getDate()).padStart(2,"0"),I=String(r.getHours()).padStart(2,"0"),N=String(r.getMinutes()).padStart(2,"0"),L=String(r.getSeconds()).padStart(2,"0");return`${l}-${w}-${y}T${I}:${N}:${L}`},o=()=>({status:c.status,channelIds:c.channelIds,productId:c.productId||void 0,producerId:c.producerId||void 0,postDate:P(c.postDate)});return(g,r)=>(n(),i("div",Yt,[t("div",Jt,[t("div",Kt,[t("div",Qt,[t("div",Zt,[u(e(te),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),t("div",null,[t("h3",es,s(e(f)("transformDraft",e(a))),1)])]),t("div",ts,[t("p",ss,s(e(f)("transformDraftDescription",e(a))),1),t("div",rs,[t("div",as,[u(e(J),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",os,[t("span",ns,s(m.draft?.name),1),t("span",ls,s(R(m.draft?.type)),1)])])]),t("form",{onSubmit:r[5]||(r[5]=ge(l=>g.$emit("confirm",o()),["prevent"])),class:"space-y-4"},[t("div",ds,[t("div",null,[t("label",is,s(e(f)("product",e(a))),1),S(t("select",{"onUpdate:modelValue":r[0]||(r[0]=l=>c.productId=l),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",us,s(e(f)("selectProduct",e(a))),1),(n(!0),i(A,null,V(e(k),l=>(n(),i("option",{key:l.id,value:l.id},s(l.name),9,gs))),128))],8,cs),[[M,c.productId]])]),t("div",null,[t("label",fs,s(e(f)("producer",e(a))),1),S(t("select",{"onUpdate:modelValue":r[1]||(r[1]=l=>c.producerId=l),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",ys,s(e(f)("selectProducer",e(a))),1),(n(!0),i(A,null,V(e(h),l=>(n(),i("option",{key:l.id,value:l.id},s(l.name),9,bs))),128))],8,ms),[[M,c.producerId]])])]),t("div",hs,[t("div",null,[t("label",ps,s(e(f)("postDate",e(a))),1),S(t("input",{"onUpdate:modelValue":r[2]||(r[2]=l=>c.postDate=l),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,xs),[[ee,c.postDate]])]),t("div",null,[t("label",vs,s(e(f)("status",e(a))),1),S(t("select",{"onUpdate:modelValue":r[3]||(r[3]=l=>c.status=l),required:"",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",ks,s(e(f)("pending",e(a))),1),t("option",ws,s(e(f)("in_production",e(a))),1),t("option",$s,s(e(f)("posted",e(a))),1),t("option",Ds,s(e(f)("finished",e(a))),1),t("option",Cs,s(e(f)("canceled",e(a))),1)],8,_s),[[M,c.status]])])]),t("div",null,[t("label",Ts,s(e(f)("channels",e(a)))+" * ",1),t("div",Ps,[(n(!0),i(A,null,V(e(v),l=>(n(),i("div",{key:l.id,class:"flex items-center"},[S(t("input",{id:`channel-${l.id}`,type:"checkbox",value:l.id,"onUpdate:modelValue":r[4]||(r[4]=w=>c.channelIds=w),disabled:m.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,Ss),[[Ae,c.channelIds]]),t("label",{for:`channel-${l.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},s(l.name),9,Is)]))),128))]),c.channelIds.length===0?(n(),i("p",Ns,s(e(f)("selectAtLeastOneChannel",e(a))),1)):T("",!0)])],32)]),t("div",Es,[t("button",{onClick:r[6]||(r[6]=l=>g.$emit("cancel")),disabled:m.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(f)("cancel",e(a))),9,Os),t("button",{onClick:r[7]||(r[7]=l=>g.$emit("confirm",o())),disabled:m.isTransforming||c.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isTransforming?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(te),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isTransforming?e(f)("transforming",e(a)):e(f)("transform",e(a))),1)],8,As)])])])]))}},js={class:"space-y-6"},Us={class:"flex justify-between items-center"},Fs={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ms={key:0},Rs={key:0,class:"space-y-6"},Ls={class:"flex space-x-4"},Bs={class:"overflow-x-auto"},Gs={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},qs={class:"bg-gray-50 dark:bg-gray-700"},zs={class:"px-6 py-3 text-left"},Hs={class:"px-6 py-3 text-left"},Ws={class:"px-6 py-3 text-left"},Xs={class:"px-6 py-3 text-left"},Ys={class:"px-6 py-3 text-left"},Js={class:"px-6 py-3 text-right"},Ks={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Qs={class:"px-6 py-4"},Zs={class:"px-6 py-4"},er={class:"px-6 py-4"},tr={class:"px-6 py-4"},sr={class:"flex items-center space-x-2"},rr={class:"px-6 py-4"},ar={class:"px-6 py-4"},or={class:"flex items-center justify-end space-x-2"},nr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},lr={class:"text-red-600"},dr={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},ir={class:"text-green-600"},cr={key:3,class:"flex space-x-4"},ur={value:""},gr=["value"],fr={value:""},mr=["value"],yr={key:5},br={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},hr={class:"text-sm text-gray-600 dark:text-gray-400"},pr={class:"flex items-center space-x-2"},xr=["disabled"],vr=["disabled"],Nr={__name:"DraftManager",setup(m){const{language:a}=ae(),{currentUser:v}=Ve(),{drafts:k,users:h,loadingDrafts:p,errors:b,fetchDrafts:x,fetchUsers:j,fetchChannels:c,createDraft:R,updateDraft:P,deleteDraft:o,transformDraftToContent:g}=me(),r=d=>f(d,a.value),l=["Post","Story","Reels","Video","Artigo"],w=["PENDING","APPROVED","NOT_APPROVED"],y=C(!1),I=C(null),N=C(""),L=C(""),K=se({name:"",type:"",content:"",status:"PENDING"}),z=C(!1),U=C(""),H=C(!1),W=C(!1),B=C(null),G=C(null),Q=C(!1),Z=C(!1),E=C(0),be=C(6),q=C(1),X=C(0);fe(async()=>{k.value=[],await Promise.all([j(),c()]),await F()}),re(N,async()=>{E.value=0,await F()});const he=Y(()=>!k.value||!v.value?[]:k.value),pe=Y(()=>he.value.filter(d=>!(N.value&&d.status!==N.value||L.value&&d.type!==L.value))),xe=Y(()=>pe.value),ve=Y(()=>E.value+1),F=async()=>{const d=await x({status:N.value||void 0,page:E.value,size:be.value});d&&typeof d=="object"&&(typeof d.totalPages=="number"&&(q.value=d.totalPages),typeof d.totalElements=="number"&&(X.value=d.totalElements))},_e=async()=>{E.value!==0&&(E.value-=1,await F())},ke=async()=>{E.value>=q.value-1||(E.value+=1,await F())};async function we(){E.value=0,await F()}async function $e(d){if(!z.value){z.value=!0,U.value="";try{let _;if(I.value)_=await P(I.value.id,d);else{const D={...d,creatorId:v.value.id,status:d.status||"PENDING"};_=await R(D)}_.success?(U.value=I.value?r("draftUpdatedSuccessfully"):r("draftCreatedSuccessfully"),ne(),await F()):console.error("Error:",_.error)}catch(_){console.error("Unexpected error:",_)}finally{z.value=!1}}}function De(d){I.value=d,Object.assign(K,{name:d.name,type:d.type,content:d.content||"",status:d.status}),y.value=!0}function ne(){y.value=!1,I.value=null,Object.assign(K,{name:"",type:"",content:"",status:"PENDING"}),U.value=""}async function Ce(d){B.value=d,H.value=!0}async function Te(){if(B.value){Q.value=!0;try{const d=await o(B.value.id);d.success?(U.value=r("draftDeletedSuccessfully"),H.value=!1,B.value=null):console.error("Error:",d.error)}catch(d){console.error("Unexpected error:",d)}finally{Q.value=!1}}}function Pe(){H.value=!1,B.value=null}async function Se(d){G.value=d,W.value=!0}async function Ie(d){if(G.value){Z.value=!0;try{const _=await g(G.value.id,d);_.success?(U.value=r("draftTransformed"),W.value=!1,G.value=null,await F()):console.error("Error:",_.error)}catch(_){console.error("Unexpected error:",_)}finally{Z.value=!1}}}function Ne(){W.value=!1,G.value=null}function Ee(d){return v.value?v.value.adminType==="ADMIN"||d.creatorId===v.value.id:!1}return(d,_)=>(n(),i("div",js,[t("div",Us,[t("h2",Fs,[de(s(r("drafts",e(a)))+" ",1),X.value?(n(),i("span",Ms,"("+s(X.value)+")",1)):T("",!0)]),t("button",{onClick:_[0]||(_[0]=D=>y.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[u(e(Me),{class:"w-4 h-4 mr-2"}),de(" "+s(r("newDraft",e(a))),1)])]),e(p)?(n(),i("div",Rs,[t("div",Ls,[u($,{customClass:"h-10 w-32"}),u($,{customClass:"h-10 w-32"})]),t("div",Bs,[t("table",Gs,[t("thead",qs,[t("tr",null,[t("th",zs,[u($,{customClass:"h-4 w-16"})]),t("th",Hs,[u($,{customClass:"h-4 w-12"})]),t("th",Ws,[u($,{customClass:"h-4 w-20"})]),t("th",Xs,[u($,{customClass:"h-4 w-16"})]),t("th",Ys,[u($,{customClass:"h-4 w-20"})]),t("th",Js,[u($,{customClass:"h-4 w-16"})])])]),t("tbody",Ks,[(n(),i(A,null,V(6,D=>t("tr",{key:D},[t("td",Qs,[u($,{customClass:"h-4 w-32 shimmer"})]),t("td",Zs,[u($,{customClass:"h-4 w-16 shimmer"})]),t("td",er,[u($,{customClass:"h-4 w-24 shimmer"})]),t("td",tr,[t("div",sr,[u($,{customClass:"h-4 w-4 rounded-full shimmer"}),u($,{customClass:"h-4 w-20 shimmer"})])]),t("td",rr,[u($,{customClass:"h-4 w-24 shimmer"})]),t("td",ar,[t("div",or,[u($,{customClass:"h-8 w-8 rounded shimmer"}),u($,{customClass:"h-8 w-8 rounded shimmer"}),u($,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):e(b).drafts?(n(),i("div",nr,[t("p",lr,s(e(b).drafts),1)])):T("",!0),U.value?(n(),i("div",dr,[t("p",ir,s(U.value),1)])):T("",!0),e(p)?T("",!0):(n(),i("div",cr,[S(t("select",{"onUpdate:modelValue":_[1]||(_[1]=D=>N.value=D),onChange:we,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",ur,s(r("allStatuses",e(a))),1),(n(),i(A,null,V(w,D=>t("option",{key:D,value:D},s(r(D.toLowerCase(),e(a))),9,gr)),64))],544),[[M,N.value]]),S(t("select",{"onUpdate:modelValue":_[2]||(_[2]=D=>L.value=D),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",fr,s(r("allTypes",e(a))),1),(n(),i(A,null,V(l,D=>t("option",{key:D,value:D},s(D),9,mr)),64))],512),[[M,L.value]])])),y.value?(n(),O(st,{key:4,user:e(v),editingDraft:I.value,t:r,language:e(a),contentTypes:l,draftStatuses:w,show:y.value,formData:K,isSubmitting:z.value,onSubmit:$e,onCancel:ne},null,8,["user","editingDraft","language","show","formData","isSubmitting"])):T("",!0),e(p)?T("",!0):(n(),i("div",yr,[u(Nt,{filteredDrafts:xe.value,users:e(h),t:r,language:e(a),canEdit:Ee,onEdit:De,onDelete:Ce,onTransform:Se},null,8,["filteredDrafts","users","language"]),q.value>1?(n(),i("div",br,[t("div",hr,s(r("page",e(a)))+" "+s(ve.value)+" / "+s(q.value)+" · "+s(X.value)+" "+s(r("items",e(a))),1),t("div",pr,[t("button",{onClick:_e,disabled:E.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(r("previous",e(a))),9,xr),t("button",{onClick:ke,disabled:E.value>=q.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(r("next",e(a))),9,vr)])])):T("",!0)])),H.value?(n(),O(Xt,{key:6,draft:B.value,"is-deleting":Q.value,onConfirm:Te,onCancel:Pe},null,8,["draft","is-deleting"])):T("",!0),W.value?(n(),O(Vs,{key:7,draft:G.value,"is-transforming":Z.value,onConfirm:Ie,onCancel:Ne},null,8,["draft","is-transforming"])):T("",!0)]))}};export{Nr as default};
