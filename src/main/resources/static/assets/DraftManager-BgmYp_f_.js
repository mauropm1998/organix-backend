import{c as fe,m as be,z as ne,A as W,a as i,o as d,b as t,t as s,u as e,f as D,g as I,v as z,B as V,q as E,s as N,h as A,F as se,w as pe,n as ge,C as je,p as b,d as y,e as le,x as xe,D as Fe,r as w,y as te,l as Me,j as ye}from"./index-BIWjYgpL.js";import{u as he}from"./useData-BYI3NWwh.js";import{_ as $}from"./SkeletonLoader-D2Q4n78C.js";import{L as ie}from"./loader-circle-Z6pSUaYO.js";import{A as de}from"./arrow-right-VGISIxQE.js";import{S as Re}from"./square-pen-CjgqxBfa.js";import{T as ve,a as Le}from"./triangle-alert-CK9bSMzs.js";import{C as Be}from"./circle-check-big-C1ZOaPW1.js";import{P as Ge}from"./plus-DkhhKbo2.js";import"./userService-D4f8HJ4u.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=fe("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=fe("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ze={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},He={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ye={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Je={value:""},Ke=["value"],Qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ze={value:""},et=["value"],tt={key:0},st={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rt=["value"],at={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ot=["placeholder"],dt={class:"flex space-x-3"},nt=["disabled"],lt=["disabled"],it={__name:"DraftForm",props:{user:Object,editingDraft:Object,t:Function,language:String,contentTypes:Array,draftStatuses:Array,products:Array,show:Boolean,formData:Object,isSubmitting:Boolean},emits:["submit","cancel"],setup(m,{emit:o}){const v=m,C=o,{user:T,editingDraft:x,t:c,language:p,contentTypes:j,draftStatuses:n,products:L,show:F,isSubmitting:P}=be(v),u=ne({...v.formData});W(()=>v.editingDraft,l=>{l?Object.assign(u,l):Object.assign(u,{name:"",type:"",content:"",productId:"",status:"pending"})});function r(){C("submit",{...u})}function a(){C("cancel")}return(l,_)=>(d(),i("div",ze,[t("h3",He,s(e(x)?e(c)("editDraft",e(p)):e(c)("createNewDraft",e(p))),1),t("form",{onSubmit:pe(r,["prevent"]),class:"space-y-4"},[t("div",We,[t("div",null,[t("label",Xe,s(e(c)("name",e(p))),1),I(t("input",{type:"text","onUpdate:modelValue":_[0]||(_[0]=f=>u.name=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,512),[[z,u.name]])]),t("div",null,[t("label",Ye,s(e(c)("type",e(p))),1),I(t("select",{"onUpdate:modelValue":_[1]||(_[1]=f=>u.type=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},[t("option",Je,s(e(c)("type",e(p))),1),(d(!0),i(E,null,N(e(j),f=>(d(),i("option",{key:f,value:f},s(f),9,Ke))),128))],512),[[V,u.type]])])]),t("div",null,[t("label",Qe,s(e(c)("product",e(p))),1),I(t("select",{"onUpdate:modelValue":_[2]||(_[2]=f=>u.productId=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[t("option",Ze,s(e(c)("selectProduct",e(p))),1),(d(!0),i(E,null,N(e(L),f=>(d(),i("option",{key:f.id,value:f.id},s(f.name),9,et))),128))],512),[[V,u.productId]])]),e(T).adminType==="ADMIN"?(d(),i("div",tt,[t("label",st,s(e(c)("status",e(p))),1),I(t("select",{"onUpdate:modelValue":_[3]||(_[3]=f=>u.status=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[(d(!0),i(E,null,N(e(n),f=>(d(),i("option",{key:f,value:f},s(e(c)(f,e(p))),9,rt))),128))],512),[[V,u.status]])])):D("",!0),t("div",null,[t("label",at,s(e(c)("draftContent",e(p))),1),I(t("textarea",{"onUpdate:modelValue":_[4]||(_[4]=f=>u.content=f),rows:"6",placeholder:e(c)("enterDraftContent",e(p)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,8,ot),[[z,u.content]])]),t("div",dt,[t("button",{type:"submit",disabled:e(P),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e(P)?(d(),A(e(ie),{key:0,class:"w-4 h-4 animate-spin"})):(d(),A(e(se),{key:1,class:"w-4 h-4"})),t("span",null,s(e(P)?e(x)?e(c)("updatingDraft",e(p)):e(c)("creatingDraft",e(p)):e(x)?e(c)("update",e(p)):e(c)("create",e(p)))+" "+s(e(P)?"":e(c)("draft",e(p))),1)],8,nt),t("button",{type:"button",onClick:a,disabled:e(P),class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 disabled:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(c)("cancel",e(p))),9,lt)])],32)]))}},ct={class:"overflow-x-auto"},ut={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},gt={class:"bg-gray-50 dark:bg-gray-700"},yt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},mt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ft={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},bt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},pt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},xt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ht={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},vt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},_t={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm font-medium text-gray-900 dark:text-white"},wt={class:"px-6 py-4 whitespace-nowrap"},$t={class:"text-sm text-gray-600 dark:text-gray-400"},Dt={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"text-sm text-gray-600 dark:text-gray-400"},It={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-sm text-gray-600 dark:text-gray-400"},Tt={class:"px-6 py-4 whitespace-nowrap"},St={class:"flex items-center space-x-2"},Et={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm text-gray-600 dark:text-gray-400"},Ot={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},At={class:"flex items-center justify-end space-x-2"},Ut=["onClick","title"],Vt=["onClick","title"],jt=["onClick","title"],Ft={key:0,class:"text-center py-12"},Mt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Rt={class:"text-gray-600 dark:text-gray-400"},Lt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,products:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(m){const o=m,{filteredDrafts:v,users:C,products:T,t:x,language:c,canEdit:p}=be(o);function j(r){const a=C.value.find(l=>l.id===r);return a?a.name:"Unknown"}function n(r){if(!r)return"-";const a=T.value?.find(l=>l.id===r);return a?a.name:"Produto não encontrado"}function L(r){return r==="APPROVED"?Be:r==="PENDING"?me:r==="NOT_APPROVED"?qe:me}function F(r){return r==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":r==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":r==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function P(r){return r==="APPROVED"?"text-green-500 dark:text-green-400":r==="PENDING"?"text-yellow-500 dark:text-yellow-400":r==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function u(r){if(!r)return"";try{let a;if(Array.isArray(r)&&r.length>=3){const[l,_,f,U=0,O=0,M=0]=r;a=new Date(l,_-1,f,U,O,M)}else if(typeof r=="string")a=new Date(r);else if(r instanceof Date)a=r;else return"Data inválida";return!(a instanceof Date)||isNaN(a.getTime())?"Data inválida":a.toLocaleDateString()}catch{return"Data inválida"}}return(r,a)=>(d(),i("div",ct,[t("table",ut,[t("thead",gt,[t("tr",null,[t("th",yt,s(e(x)("name",e(c))),1),t("th",mt,s(e(x)("type",e(c))),1),t("th",ft,s(e(x)("product",e(c))),1),t("th",bt,s(e(x)("creator",e(c))),1),t("th",pt,s(e(x)("status",e(c))),1),t("th",xt,s(e(x)("created",e(c))),1),t("th",ht,s(e(x)("actions",e(c))),1)])]),t("tbody",vt,[(d(!0),i(E,null,N(e(v),l=>(d(),i("tr",{key:l.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",_t,[t("div",kt,s(l.name),1)]),t("td",wt,[t("div",$t,s(l.type),1)]),t("td",Dt,[t("div",Ct,s(n(l.productId)),1)]),t("td",It,[t("div",Pt,s(j(l.creatorId)),1)]),t("td",Tt,[t("div",St,[(d(),A(je(L(l.status)),{class:ge(["w-4 h-4",P(l.status)])},null,8,["class"])),t("span",{class:ge(F(l.status))},s(e(x)(l.status?.toLowerCase()||"draft",e(c))),3)])]),t("td",Et,[t("div",Nt,s(u(l.createdAt)),1)]),t("td",Ot,[t("div",At,[l.status==="APPROVED"&&e(p)(l)?(d(),i("button",{key:0,onClick:_=>r.$emit("transform",l),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:e(x)("transformToContent",e(c))},[b(e(de),{class:"w-4 h-4"})],8,Ut)):D("",!0),e(p)(l)?(d(),i("button",{key:1,onClick:_=>r.$emit("edit",l),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:e(x)("editDraft",e(c))},[b(e(Re),{class:"w-4 h-4"})],8,Vt)):D("",!0),e(p)(l)?(d(),i("button",{key:2,onClick:_=>r.$emit("delete",l),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:e(x)("deleteDraft",e(c))},[b(e(ve),{class:"w-4 h-4"})],8,jt)):D("",!0)])])]))),128))])]),e(v).length?D("",!0):(d(),i("div",Ft,[b(e(se),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",Mt,s(e(x)("noDraftsFound",e(c))),1),t("p",Rt,s(e(x)("createFirstDraft",e(c))),1)]))]))}},Bt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Gt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},qt={class:"p-6"},zt={class:"flex items-center mb-4"},Ht={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},Wt={class:"text-lg font-medium text-gray-900 dark:text-white"},Xt={class:"mb-6"},Yt={class:"text-gray-600 dark:text-gray-400"},Jt={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},Kt={class:"flex items-center"},Qt={class:"min-w-0 flex-1"},Zt={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},es={class:"text-xs text-gray-500 dark:text-gray-400"},ts={class:"flex space-x-3 justify-end"},ss=["disabled"],rs=["disabled"],as={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:o}=le();return(v,C)=>(d(),i("div",Bt,[t("div",Gt,[t("div",qt,[t("div",zt,[t("div",Ht,[b(e(Le),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),t("div",null,[t("h3",Wt,s(e(y)("confirmDeletion",e(o))),1)])]),t("div",Xt,[t("p",Yt,s(e(y)("confirmDeleteDraft",e(o))),1),t("div",Jt,[t("div",Kt,[b(e(se),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",Qt,[t("span",Zt,s(m.draft?.name),1),t("span",es,s(m.draft?.type)+" • "+s(e(y)(m.draft?.status?.toLowerCase()||"draft",e(o))),1)])])])]),t("div",ts,[t("button",{onClick:C[0]||(C[0]=T=>v.$emit("cancel")),disabled:m.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(y)("cancel",e(o))),9,ss),t("button",{onClick:C[1]||(C[1]=T=>v.$emit("confirm")),disabled:m.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isDeleting?(d(),A(e(ie),{key:0,class:"w-4 h-4 animate-spin"})):(d(),A(e(ve),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isDeleting?e(y)("deleting",e(o)):e(y)("delete",e(o))),1)],8,rs)])])])]))}},os={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ds={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},ns={class:"p-6"},ls={class:"flex items-center mb-4"},is={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},cs={class:"text-lg font-medium text-gray-900 dark:text-white"},us={class:"mb-6"},gs={class:"text-gray-600 dark:text-gray-400 mb-4"},ys={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},ms={class:"flex items-center"},fs={class:"min-w-0 flex-1"},bs={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ps={class:"text-xs text-gray-500 dark:text-gray-400"},xs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},hs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},vs=["disabled"],_s={value:""},ks=["value"],ws={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},$s=["disabled"],Ds={value:""},Cs=["value"],Is={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ps={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ts=["disabled"],Ss={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Es=["disabled"],Ns={value:"PENDING"},Os={value:"IN_PRODUCTION"},As={value:"POSTED"},Us={value:"PRODUCTION_FINISHED"},Vs={value:"FINISHED"},js={value:"CANCELED"},Fs={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ms={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Rs=["disabled"],Ls={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Bs=["disabled"],Gs={key:1},qs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},zs=["disabled","placeholder"],Hs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ws={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},Xs=["id","value","disabled"],Ys=["for"],Js={key:0,class:"text-xs text-red-500 mt-1"},Ks={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},Qs=["disabled"],Zs=["disabled"],er={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:o}=le(),{channels:v,products:C,users:T,fetchChannels:x,fetchProducts:c,fetchUsers:p}=he(),j=m,n=ne({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:""});W(()=>n.status,u=>{u!=="IN_PRODUCTION"&&(n.productionStartDate="",n.productionEndDate=""),u!=="POSTED"&&(n.metaAdsId="")}),xe(async()=>{await Promise.all([v.value&&v.value.length>0?Promise.resolve():x(),C.value&&C.value.length>0?Promise.resolve():c(),T.value&&T.value.length>0?Promise.resolve():p()])}),W(()=>j.draft,()=>{n.status="PENDING",n.channelIds=[],n.productId=j.draft?.productId||"",n.producerId="",n.postDate="",n.productionStartDate="",n.productionEndDate="",n.metaAdsId=""},{immediate:!0});const L=u=>{if(!u)return"";const r=y(`contentTypes.${u}`,o.value);return r.startsWith("contentTypes.")?u:r},F=u=>{if(!u)return;const r=new Date(u),a=r.getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),_=String(r.getDate()).padStart(2,"0"),f=String(r.getHours()).padStart(2,"0"),U=String(r.getMinutes()).padStart(2,"0"),O=String(r.getSeconds()).padStart(2,"0");return`${a}-${l}-${_}T${f}:${U}:${O}`},P=()=>{const u={status:n.status,channelIds:n.channelIds,productId:n.productId||null,producerId:n.producerId||null,postDate:F(n.postDate)};return n.status==="IN_PRODUCTION"&&(u.productionStartDate=F(n.productionStartDate),u.productionEndDate=F(n.productionEndDate)),n.status==="POSTED"&&(u.metaAdsId=n.metaAdsId||null),u};return(u,r)=>(d(),i("div",os,[t("div",ds,[t("div",ns,[t("div",ls,[t("div",is,[b(e(de),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),t("div",null,[t("h3",cs,s(e(y)("transformDraft",e(o))),1)])]),t("div",us,[t("p",gs,s(e(y)("transformDraftDescription",e(o))),1),t("div",ys,[t("div",ms,[b(e(se),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",fs,[t("span",bs,s(m.draft?.name),1),t("span",ps,s(L(m.draft?.type)),1)])])]),t("form",{onSubmit:r[8]||(r[8]=pe(a=>u.$emit("confirm",P()),["prevent"])),class:"space-y-4"},[t("div",xs,[t("div",null,[t("label",hs,s(e(y)("product",e(o))),1),I(t("select",{"onUpdate:modelValue":r[0]||(r[0]=a=>n.productId=a),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",_s,s(e(y)("selectProduct",e(o))),1),(d(!0),i(E,null,N(e(C),a=>(d(),i("option",{key:a.id,value:a.id},s(a.name),9,ks))),128))],8,vs),[[V,n.productId]])]),t("div",null,[t("label",ws,s(e(y)("producer",e(o))),1),I(t("select",{"onUpdate:modelValue":r[1]||(r[1]=a=>n.producerId=a),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",Ds,s(e(y)("selectProducer",e(o))),1),(d(!0),i(E,null,N(e(T),a=>(d(),i("option",{key:a.id,value:a.id},s(a.name),9,Cs))),128))],8,$s),[[V,n.producerId]])])]),t("div",Is,[t("div",null,[t("label",Ps,s(e(y)("postDate",e(o))),1),I(t("input",{"onUpdate:modelValue":r[2]||(r[2]=a=>n.postDate=a),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ts),[[z,n.postDate]])]),t("div",null,[t("label",Ss,s(e(y)("status",e(o))),1),I(t("select",{"onUpdate:modelValue":r[3]||(r[3]=a=>n.status=a),required:"",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",Ns,s(e(y)("pending",e(o))),1),t("option",Os,s(e(y)("in_production",e(o))),1),t("option",As,s(e(y)("posted",e(o))),1),t("option",Us,s(e(y)("production-finished",e(o))),1),t("option",Vs,s(e(y)("finished",e(o))),1),t("option",js,s(e(y)("canceled",e(o))),1)],8,Es),[[V,n.status]])])]),n.status==="IN_PRODUCTION"?(d(),i("div",Fs,[t("div",null,[t("label",Ms,s(e(y)("productionStartDate",e(o))),1),I(t("input",{"onUpdate:modelValue":r[4]||(r[4]=a=>n.productionStartDate=a),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Rs),[[z,n.productionStartDate]])]),t("div",null,[t("label",Ls,s(e(y)("productionEndDate",e(o))),1),I(t("input",{"onUpdate:modelValue":r[5]||(r[5]=a=>n.productionEndDate=a),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Bs),[[z,n.productionEndDate]])])])):D("",!0),n.status==="POSTED"?(d(),i("div",Gs,[t("label",qs,s(e(y)("metaAdsId",e(o))),1),I(t("input",{"onUpdate:modelValue":r[6]||(r[6]=a=>n.metaAdsId=a),type:"text",disabled:m.isTransforming,placeholder:e(y)("enterMetaAdsId",e(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,zs),[[z,n.metaAdsId]])])):D("",!0),t("div",null,[t("label",Hs,s(e(y)("channels",e(o)))+" * ",1),t("div",Ws,[(d(!0),i(E,null,N(e(v),a=>(d(),i("div",{key:a.id,class:"flex items-center"},[I(t("input",{id:`channel-${a.id}`,type:"checkbox",value:a.id,"onUpdate:modelValue":r[7]||(r[7]=l=>n.channelIds=l),disabled:m.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,Xs),[[Fe,n.channelIds]]),t("label",{for:`channel-${a.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},s(a.name),9,Ys)]))),128))]),n.channelIds.length===0?(d(),i("p",Js,s(e(y)("selectAtLeastOneChannel",e(o))),1)):D("",!0)])],32)]),t("div",Ks,[t("button",{onClick:r[9]||(r[9]=a=>u.$emit("cancel")),disabled:m.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(y)("cancel",e(o))),9,Qs),t("button",{onClick:r[10]||(r[10]=a=>u.$emit("confirm",P())),disabled:m.isTransforming||n.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isTransforming?(d(),A(e(ie),{key:0,class:"w-4 h-4 animate-spin"})):(d(),A(e(de),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isTransforming?e(y)("transforming",e(o)):e(y)("transform",e(o))),1)],8,Zs)])])])]))}},tr={class:"space-y-6"},sr={class:"flex justify-between items-center"},rr={class:"text-2xl font-bold text-gray-900 dark:text-white"},ar={key:0},or={key:0,class:"space-y-6"},dr={class:"flex space-x-4"},nr={class:"overflow-x-auto"},lr={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},ir={class:"bg-gray-50 dark:bg-gray-700"},cr={class:"px-6 py-3 text-left"},ur={class:"px-6 py-3 text-left"},gr={class:"px-6 py-3 text-left"},yr={class:"px-6 py-3 text-left"},mr={class:"px-6 py-3 text-left"},fr={class:"px-6 py-3 text-right"},br={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},pr={class:"px-6 py-4"},xr={class:"px-6 py-4"},hr={class:"px-6 py-4"},vr={class:"px-6 py-4"},_r={class:"flex items-center space-x-2"},kr={class:"px-6 py-4"},wr={class:"px-6 py-4"},$r={class:"flex items-center justify-end space-x-2"},Dr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Cr={class:"text-red-600"},Ir={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Pr={class:"text-green-600"},Tr={key:3,class:"flex space-x-4"},Sr={value:""},Er=["value"],Nr={value:""},Or=["value"],Ar={value:""},Ur=["value"],Vr={key:5},jr={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},Fr={class:"text-sm text-gray-600 dark:text-gray-400"},Mr={class:"flex items-center space-x-2"},Rr=["disabled"],Lr=["disabled"],Qr={__name:"DraftManager",setup(m){const{language:o}=le(),{currentUser:v}=Me(),{drafts:C,users:T,products:x,loadingDrafts:c,errors:p,fetchDrafts:j,fetchUsers:n,fetchChannels:L,fetchProducts:F,createDraft:P,updateDraft:u,deleteDraft:r,transformDraftToContent:a}=he(),l=g=>y(g,o.value),_=["Post","Story","Reels","Video","Artigo"],f=["PENDING","APPROVED","NOT_APPROVED"],U=w(!1),O=w(null),M=w(""),X=w(""),Y=w(""),re=ne({name:"",type:"",content:"",productId:"",status:"PENDING"}),J=w(!1),B=w(""),K=w(!0),Q=w(!1),Z=w(!1),G=w(null),q=w(null),ae=w(!1),oe=w(!1),S=w(0),_e=w(15),H=w(1),ee=w(0);xe(async()=>{await Promise.all([n(),L(),F()]),await R(),K.value=!1}),W(M,async()=>{S.value=0,await R()}),W(Y,async()=>{S.value=0,await R()});const ke=te(()=>!C.value||!v.value?[]:C.value),we=te(()=>ke.value.filter(g=>!(M.value&&g.status!==M.value||X.value&&g.type!==X.value))),$e=te(()=>we.value),De=te(()=>S.value+1),R=async()=>{const g=await j({status:M.value||void 0,productId:Y.value||void 0,page:S.value,size:_e.value});g&&typeof g=="object"&&(typeof g.totalPages=="number"&&(H.value=g.totalPages),typeof g.totalElements=="number"&&(ee.value=g.totalElements))},Ce=async()=>{S.value!==0&&(S.value-=1,await R())},Ie=async()=>{S.value>=H.value-1||(S.value+=1,await R())};async function ce(){S.value=0,await R()}async function Pe(g){if(!J.value){J.value=!0,B.value="";try{let k;if(O.value)k=await u(O.value.id,g);else{const h={...g,creatorId:v.value.id,status:g.status||"PENDING"};k=await P(h)}k.success?(B.value=O.value?l("draftUpdatedSuccessfully"):l("draftCreatedSuccessfully"),ue(),await R()):console.error("Error:",k.error)}catch(k){console.error("Unexpected error:",k)}finally{J.value=!1}}}function Te(g){O.value=g,Object.assign(re,{name:g.name,type:g.type,content:g.content||"",productId:g.productId||"",status:g.status}),U.value=!0}function ue(){U.value=!1,O.value=null,Object.assign(re,{name:"",type:"",content:"",productId:"",status:"PENDING"}),B.value=""}async function Se(g){G.value=g,Q.value=!0}async function Ee(){if(G.value){ae.value=!0;try{const g=await r(G.value.id);g.success?(B.value=l("draftDeletedSuccessfully"),Q.value=!1,G.value=null):console.error("Error:",g.error)}catch(g){console.error("Unexpected error:",g)}finally{ae.value=!1}}}function Ne(){Q.value=!1,G.value=null}async function Oe(g){q.value=g,Z.value=!0}async function Ae(g){if(q.value){oe.value=!0;try{const k=await a(q.value.id,g);k.success?(B.value=l("draftTransformed"),Z.value=!1,q.value=null,await R()):console.error("Error:",k.error)}catch(k){console.error("Unexpected error:",k)}finally{oe.value=!1}}}function Ue(){Z.value=!1,q.value=null}function Ve(g){return v.value?v.value.adminType==="ADMIN"||g.creatorId===v.value.id:!1}return(g,k)=>(d(),i("div",tr,[t("div",sr,[t("h2",rr,[ye(s(l("drafts",e(o)))+" ",1),ee.value?(d(),i("span",ar,"("+s(ee.value)+")",1)):D("",!0)]),t("button",{onClick:k[0]||(k[0]=h=>U.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[b(e(Ge),{class:"w-4 h-4 mr-2"}),ye(" "+s(l("newDraft",e(o))),1)])]),e(c)||K.value?(d(),i("div",or,[t("div",dr,[b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"})]),t("div",nr,[t("table",lr,[t("thead",ir,[t("tr",null,[t("th",cr,[b($,{customClass:"h-4 w-16"})]),t("th",ur,[b($,{customClass:"h-4 w-12"})]),t("th",gr,[b($,{customClass:"h-4 w-20"})]),t("th",yr,[b($,{customClass:"h-4 w-16"})]),t("th",mr,[b($,{customClass:"h-4 w-20"})]),t("th",fr,[b($,{customClass:"h-4 w-16"})])])]),t("tbody",br,[(d(),i(E,null,N(6,h=>t("tr",{key:h},[t("td",pr,[b($,{customClass:"h-4 w-32 shimmer"})]),t("td",xr,[b($,{customClass:"h-4 w-16 shimmer"})]),t("td",hr,[b($,{customClass:"h-4 w-24 shimmer"})]),t("td",vr,[t("div",_r,[b($,{customClass:"h-4 w-4 rounded-full shimmer"}),b($,{customClass:"h-4 w-20 shimmer"})])]),t("td",kr,[b($,{customClass:"h-4 w-24 shimmer"})]),t("td",wr,[t("div",$r,[b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):e(p).drafts?(d(),i("div",Dr,[t("p",Cr,s(e(p).drafts),1)])):D("",!0),B.value?(d(),i("div",Ir,[t("p",Pr,s(B.value),1)])):D("",!0),!e(c)&&!K.value?(d(),i("div",Tr,[I(t("select",{"onUpdate:modelValue":k[1]||(k[1]=h=>M.value=h),onChange:ce,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",Sr,s(l("allStatuses",e(o))),1),(d(),i(E,null,N(f,h=>t("option",{key:h,value:h},s(l(h.toLowerCase(),e(o))),9,Er)),64))],544),[[V,M.value]]),I(t("select",{"onUpdate:modelValue":k[2]||(k[2]=h=>X.value=h),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",Nr,s(l("allTypes",e(o))),1),(d(),i(E,null,N(_,h=>t("option",{key:h,value:h},s(h),9,Or)),64))],512),[[V,X.value]]),I(t("select",{"onUpdate:modelValue":k[3]||(k[3]=h=>Y.value=h),onChange:ce,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",Ar,s(l("allProducts",e(o))),1),(d(!0),i(E,null,N(e(x),h=>(d(),i("option",{key:h.id,value:h.id},s(h.name),9,Ur))),128))],544),[[V,Y.value]])])):D("",!0),U.value?(d(),A(it,{key:4,user:e(v),editingDraft:O.value,t:l,language:e(o),contentTypes:_,draftStatuses:f,products:e(x),show:U.value,formData:re,isSubmitting:J.value,onSubmit:Pe,onCancel:ue},null,8,["user","editingDraft","language","products","show","formData","isSubmitting"])):D("",!0),!e(c)&&!K.value?(d(),i("div",Vr,[b(Lt,{filteredDrafts:$e.value,users:e(T),products:e(x),t:l,language:e(o),canEdit:Ve,onEdit:Te,onDelete:Se,onTransform:Oe},null,8,["filteredDrafts","users","products","language"]),H.value>1?(d(),i("div",jr,[t("div",Fr,s(l("page",e(o)))+" "+s(De.value)+" / "+s(H.value)+" · "+s(ee.value)+" "+s(l("items",e(o))),1),t("div",Mr,[t("button",{onClick:Ce,disabled:S.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(l("previous",e(o))),9,Rr),t("button",{onClick:Ie,disabled:S.value>=H.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(l("next",e(o))),9,Lr)])])):D("",!0)])):D("",!0),Q.value?(d(),A(as,{key:6,draft:G.value,"is-deleting":ae.value,onConfirm:Ee,onCancel:Ne},null,8,["draft","is-deleting"])):D("",!0),Z.value?(d(),A(er,{key:7,draft:q.value,"is-transforming":oe.value,onConfirm:Ae,onCancel:Ue},null,8,["draft","is-transforming"])):D("",!0)]))}};export{Qr as default};
