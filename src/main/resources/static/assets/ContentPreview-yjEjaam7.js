import{r as f,B as ce,y as T,l as ie,d as ue,e as ge,x as ye,a as c,b as e,f as u,p as k,u as o,t as s,n as A,q as m,s as b,j as O,i as pe,F as xe,G as ve,I as me,k as _e,o as i}from"./index-DbB0lweT.js";import{u as he,c as fe}from"./useData-V0qgd-s4.js";import{m as L,E as ke,C as be,a as we,_ as De}from"./index-Dpgg0gF1.js";import{S as Se}from"./square-pen-BLm1d_9d.js";import"./userService-BbL24v_D.js";import"./loader-circle-xaVZ0R8c.js";import"./plus-DCAQ6IeS.js";const Ie={class:"space-y-6"},Ce={class:"flex items-start justify-between flex-wrap gap-4"},Ne={class:"space-y-2"},Ee={class:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3"},Te={key:0},Ae={key:1,class:"h-6 w-52 rounded shimmer-block"},Oe={key:0,class:"flex flex-wrap gap-2"},je={class:"flex items-center gap-3"},Pe={key:0,class:"space-y-6"},Me={class:"flex flex-col lg:flex-row gap-8"},$e={class:"flex-1 space-y-5"},Fe={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"},Le={key:1,class:"p-6 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300"},Be={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ue={class:"lg:col-span-2 space-y-6"},Ge={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},Re={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},He={class:"whitespace-pre-wrap text-sm leading-relaxed text-gray-800 dark:text-gray-200 font-sans bg-gray-50 dark:bg-gray-900/40 p-4 rounded border border-gray-100 dark:border-gray-700 overflow-auto max-h-96"},qe={key:0,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},ze={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Ye={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Je={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 text-center"},Ve={class:"text-[10px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-medium"},Ke={class:"mt-1 text-lg font-semibold text-gray-800 dark:text-gray-100 tabular-nums"},Qe={key:1,class:"border-t border-gray-200 dark:border-gray-700 my-4"},We={key:2,class:"space-y-4"},Xe={class:"flex items-center justify-between mb-3"},Ze={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},et={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 text-xs"},tt={class:"flex flex-col"},at={class:"text-gray-500 dark:text-gray-400"},st={class:"font-semibold text-gray-800 dark:text-gray-100"},rt={class:"flex flex-col"},ot={class:"text-gray-500 dark:text-gray-400"},nt={class:"font-semibold text-gray-800 dark:text-gray-100"},lt={class:"flex flex-col"},dt={class:"text-gray-500 dark:text-gray-400"},ct={class:"font-semibold text-gray-800 dark:text-gray-100"},it={class:"flex flex-col"},ut={class:"text-gray-500 dark:text-gray-400"},gt={class:"font-semibold text-gray-800 dark:text-gray-100"},yt={class:"flex flex-col"},pt={class:"text-gray-500 dark:text-gray-400"},xt={class:"font-semibold text-gray-800 dark:text-gray-100"},vt={class:"flex flex-col"},mt={class:"text-gray-500 dark:text-gray-400"},_t={class:"font-semibold text-gray-800 dark:text-gray-100"},ht={key:3,class:"text-sm text-gray-500 dark:text-gray-400"},ft={class:"space-y-6"},kt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4"},bt={class:"text-sm font-semibold tracking-wide text-gray-500 dark:text-gray-400 uppercase"},wt={class:"space-y-3 text-sm"},Dt={class:"flex justify-between gap-4"},St={class:"text-gray-500 dark:text-gray-400"},It={class:"text-gray-800 dark:text-gray-200 font-medium"},Ct={key:0,class:"flex justify-between gap-4"},Nt={class:"text-gray-500 dark:text-gray-400"},Et={class:"text-gray-800 dark:text-gray-200 font-medium"},Tt={key:1,class:"flex justify-between gap-4"},At={class:"text-gray-500 dark:text-gray-400"},Ot={class:"text-gray-800 dark:text-gray-200 font-medium"},jt={key:2,class:"flex justify-between gap-4"},Pt={class:"text-gray-500 dark:text-gray-400"},Mt={class:"text-gray-800 dark:text-gray-200 font-medium"},$t={key:3,class:"flex justify-between gap-4"},Ft={class:"text-gray-500 dark:text-gray-400"},Lt={class:"text-gray-800 dark:text-gray-200 font-medium"},Bt={key:4,class:"flex justify-between gap-4"},Ut={class:"text-gray-500 dark:text-gray-400"},Gt={class:"text-gray-800 dark:text-gray-200 font-medium"},Rt={class:"flex justify-between gap-4"},Ht={class:"text-gray-500 dark:text-gray-400"},qt={class:"text-gray-800 dark:text-gray-200 font-medium"},zt={class:"flex justify-between gap-4"},Yt={class:"text-gray-500 dark:text-gray-400"},Jt={class:"text-gray-800 dark:text-gray-200 font-medium"},Vt={key:5,class:"flex justify-between gap-4"},Kt={class:"text-gray-500 dark:text-gray-400"},Qt={class:"text-gray-800 dark:text-gray-200 font-medium"},Wt={class:"flex justify-between gap-4"},Xt={class:"text-gray-800 dark:text-gray-200 font-mono text-xs tracking-wide"},Zt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"},ea={class:"text-sm font-semibold tracking-wide text-gray-500 dark:text-gray-400 uppercase flex items-center gap-2 mb-4"},ta={key:0,class:"space-y-4 list-none m-0 p-0"},aa={class:"flex flex-col items-center self-stretch"},sa={key:0,class:"flex-1 w-px bg-gray-200 dark:bg-gray-700 mt-1"},ra={class:"flex-1 min-w-0"},oa={class:"flex flex-wrap items-center gap-2 text-xs font-medium text-gray-800 dark:text-gray-200"},na=["title"],la={class:"flex flex-wrap items-center gap-1"},da={key:0,class:"text-gray-500 dark:text-gray-400"},ca={key:1,class:"text-gray-400"},ia={class:"text-[10px] text-gray-500 dark:text-gray-400 mt-1"},ua={key:1,class:"text-xs text-gray-500 dark:text-gray-400 flex flex-col items-start gap-3 leading-normal"},ga={class:"flex items-center gap-3"},ya={class:"space-y-0.5"},pa={class:"font-medium text-gray-700 dark:text-gray-300 leading-snug"},xa={class:"text-[11px] text-gray-500 dark:text-gray-400 leading-snug"},Da={__name:"ContentPreview",setup(va){const B=me(),U=_e(),{currentUser:w}=ie(),{language:n}=ge(),l=(r,a=n.value)=>ue(r,a),{products:j,channels:P,users:M,fetchProducts:G,fetchChannels:R,fetchUsers:H,updateContent:q}=he(),t=f(null),I=f(!0),D=f(""),S=f(!1),C=f(!1),g=ce({name:"",type:"",content:"",product:"",creator:"",producer:"",status:"PENDING",postDate:"",channels:[],productionStartDate:"",productionEndDate:"",metaAdsId:"",trafficType:"ORGANIC"}),z=we,Y=be,J=T(()=>!t.value||!w.value?!1:w.value.adminType==="ADMIN"||[t.value.creatorId,t.value.producerId].includes(w.value.id)),V=r=>({PENDING:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",IN_PRODUCTION:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",POSTED:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",FINISHED:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",CANCELED:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[r]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",K=r=>({PENDING:"bg-yellow-400",IN_PRODUCTION:"bg-blue-500",POSTED:"bg-green-500",FINISHED:"bg-purple-500",CANCELED:"bg-red-500"})[r]||"bg-gray-400",Q=T(()=>{if(!t.value?.metrics)return!1;const{views:r,likes:a,comments:d,shares:y,reach:p,engagement:x}=t.value.metrics;return[r,a,d,y,p,x].some(v=>typeof v=="number")}),W=T(()=>{if(!t.value?.metrics)return[];const r=t.value.metrics;return[{key:"views",label:l("views",n.value),value:r.views??0},{key:"likes",label:l("likes",n.value),value:r.likes??0},{key:"comments",label:l("comments",n.value),value:r.comments??0},{key:"shares",label:l("shares",n.value),value:r.shares??0},{key:"reach",label:l("reach",n.value),value:r.reach??0},{key:"engagement",label:l("engagement",n.value),value:r.engagement??0}]});function X(r){return j.value?.find(a=>a.id===r)?.name||"-"}function $(r){return M.value?.find(a=>a.id===r)?.name||"-"}function Z(r){return P.value?.find(a=>a.id===r)?.name||r}function _(r){if(!r)return"";let a;if(Array.isArray(r)){const[y,p,x,v=0,h=0]=r;a=new Date(y,p-1,x,v,h)}else a=new Date(r);const d=n.value==="pt"?"pt-PT":"en-US";return a.toLocaleString(d,{dateStyle:"medium",timeStyle:"short"})}function N(r){if(!r)return"";let a;if(Array.isArray(r)){const[h,oe,ne,le=0,de=0]=r;a=new Date(h,oe-1,ne,le,de)}else a=new Date(r);const d=a.getFullYear(),y=String(a.getMonth()+1).padStart(2,"0"),p=String(a.getDate()).padStart(2,"0"),x=String(a.getHours()).padStart(2,"0"),v=String(a.getMinutes()).padStart(2,"0");return`${d}-${y}-${p}T${x}:${v}`}function E(r){if(!r)return;const a=new Date(r),d=a.getFullYear(),y=String(a.getMonth()+1).padStart(2,"0"),p=String(a.getDate()).padStart(2,"0"),x=String(a.getHours()).padStart(2,"0"),v=String(a.getMinutes()).padStart(2,"0"),h=String(a.getSeconds()).padStart(2,"0");return`${d}-${y}-${p}T${x}:${v}:${h}`}async function F(){I.value=!0,D.value="";try{await Promise.all([G(),R(),H()]);const r=B.params.id,a=await fe.getContentById(r);t.value=a}catch(r){D.value=r?.response?.data?.message||r.message||"Erro ao carregar conteÃºdo"}finally{I.value=!1}}function ee(){t.value&&(Object.assign(g,{name:t.value.name,type:t.value.type?.toLowerCase()||"",content:t.value.content,product:t.value.productId,creator:t.value.creatorId,producer:t.value.producerId,status:t.value.status,postDate:N(t.value.postDate),channels:t.value.channels?.map(r=>r.id)||[],productionStartDate:t.value.productionStartDate?N(t.value.productionStartDate):"",productionEndDate:t.value.productionEndDate?N(t.value.productionEndDate):"",metaAdsId:t.value.metaAdsId||"",trafficType:t.value.trafficType||"ORGANIC"}),S.value=!0)}function te(){console.log("ðŸ”™ Clicou em Voltar - navegando para ContentManager com from=preview"),L(),U.push({name:"ContentManager",query:{from:"preview"}})}function ae(){S.value=!1}async function se(){if(t.value){console.log("ðŸ”¥ saveEdit chamado no ContentPreview! Iniciando processo de salvamento..."),console.log("ðŸ“ Edit Form Data atual:",JSON.stringify(g,null,2)),console.log("âœï¸ Content ID:",t.value.id),C.value=!0;try{const r={name:g.name,type:g.type?.toUpperCase()||"",content:g.content,productId:g.product||null,producerId:g.producer||null,status:g.status,postDate:E(g.postDate),productionStartDate:E(g.productionStartDate)||null,productionEndDate:E(g.productionEndDate)||null,metaAdsId:g.metaAdsId||null,trafficType:g.trafficType,channelIds:g.channels};console.log("=== DADOS ENVIADOS AO BACKEND (ContentPreview) ==="),console.log("OperaÃ§Ã£o: UPDATE"),console.log("Content ID:",t.value.id),console.log("Payload:",JSON.stringify(r,null,2)),console.log("=================================================="),await q(t.value.id,r),S.value=!1,await F()}catch(r){console.error(r),alert(r?.response?.data?.message||r.message||"Erro ao atualizar")}finally{C.value=!1}}}const re=r=>({PAID:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200",ORGANIC:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200"})[r]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";return ye(()=>{L(),F()}),(r,a)=>(i(),c("div",Ie,[e("div",Ce,[e("div",Ne,[e("h1",Ee,[k(o(ke),{class:"w-6 h-6 text-blue-600 dark:text-blue-400"}),t.value?(i(),c("span",Te,s(t.value.name),1)):(i(),c("span",Ae)),t.value?(i(),c("span",{key:2,class:A(["text-xs px-2 py-1 rounded-full font-medium",V(t.value.status)])},s(l(t.value.status,o(n).value)),3)):u("",!0)]),t.value?.channels?.length?(i(),c("div",Oe,[(i(!0),c(m,null,b(t.value.channels,d=>(i(),c("span",{key:d.id,class:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"},s(d.name),1))),128))])):u("",!0)]),e("div",je,[t.value&&J.value?(i(),c("button",{key:0,onClick:ee,class:"inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded-lg transition-colors"},[k(o(Se),{class:"w-4 h-4 mr-2"}),O(" "+s(l("edit",o(n).value)),1)])):u("",!0),e("button",{onClick:te,class:"inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 text-sm rounded-lg transition-colors"},s(l("back",o(n).value)),1)])]),I.value?(i(),c("div",Pe,[a[6]||(a[6]=e("div",{class:"h-7 w-1/3 rounded shimmer-block"},null,-1)),e("div",Me,[e("div",$e,[a[0]||(a[0]=e("div",{class:"h-5 w-2/3 rounded shimmer-block"},null,-1)),a[1]||(a[1]=e("div",{class:"h-40 rounded shimmer-block"},null,-1)),a[2]||(a[2]=e("div",{class:"h-5 w-1/4 rounded shimmer-block"},null,-1)),e("div",Fe,[(i(),c(m,null,b(6,d=>e("div",{key:d,class:"h-16 rounded shimmer-block"})),64))]),a[3]||(a[3]=e("div",{class:"h-5 w-40 rounded shimmer-block"},null,-1)),a[4]||(a[4]=e("div",{class:"h-24 rounded shimmer-block"},null,-1))]),a[5]||(a[5]=pe('<div class="w-full lg:w-80 space-y-4"><div class="h-5 w-1/2 rounded shimmer-block"></div><div class="h-32 rounded shimmer-block"></div><div class="h-5 w-2/3 rounded shimmer-block"></div><div class="h-48 rounded shimmer-block"></div></div>',1))])])):D.value?(i(),c("div",Le,s(D.value),1)):t.value?(i(),c("div",Be,[e("div",Ue,[e("section",Ge,[e("h2",Re,[k(o(xe),{class:"w-5 h-5 text-gray-400"}),O(" "+s(l("content",o(n).value)),1)]),e("pre",He,s(t.value.content),1)]),t.value.status==="POSTED"?(i(),c("section",qe,[e("h2",ze,[k(o(ve),{class:"w-5 h-5 text-gray-400"}),O(" "+s(l("metrics",o(n).value)),1)]),t.value.metrics?(i(),c(m,{key:1},[Q.value?(i(),c("div",Je,[(i(!0),c(m,null,b(W.value,d=>(i(),c("div",{key:d.key,class:"p-3 rounded bg-gray-50 dark:bg-gray-900/40 border border-gray-100 dark:border-gray-700"},[e("div",Ve,s(d.label),1),e("div",Ke,s(d.value),1)]))),128))])):u("",!0),t.value.metrics.channelMetrics?.length?(i(),c("div",Qe)):u("",!0),t.value.metrics.channelMetrics?.length?(i(),c("div",We,[(i(!0),c(m,null,b(t.value.metrics.channelMetrics,d=>(i(),c("div",{key:d.channelId,class:"p-4 rounded border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/40"},[e("div",Xe,[e("h3",Ze,s(Z(d.channelId)),1)]),e("div",et,[e("div",tt,[e("span",at,s(l("likes",o(n).value)),1),e("span",st,s(d.likes),1)]),e("div",rt,[e("span",ot,s(l("comments",o(n).value)),1),e("span",nt,s(d.comments),1)]),e("div",lt,[e("span",dt,s(l("shares",o(n).value)),1),e("span",ct,s(d.shares),1)]),e("div",it,[e("span",ut,s(l("postClicks",o(n).value)),1),e("span",gt,s(d.postClicks),1)]),e("div",yt,[e("span",pt,s(l("siteVisits",o(n).value)),1),e("span",xt,s(d.siteVisits),1)]),e("div",vt,[e("span",mt,s(l("newAccounts",o(n).value)),1),e("span",_t,s(d.newAccounts),1)])])]))),128))])):(i(),c("div",ht,s(l("noChannelMetrics",o(n).value)),1))],64)):(i(),c("div",Ye,s(l("noMetrics",o(n).value)),1))])):u("",!0)]),e("aside",ft,[e("section",kt,[e("h2",bt,s(l("details",o(n).value)),1),e("dl",wt,[e("div",Dt,[e("dt",St,s(l("type",o(n).value)),1),e("dd",It,s(l(`contentTypes.${t.value.type?.toLowerCase()}`,o(n).value)),1)]),t.value.trafficType?(i(),c("div",Ct,[e("dt",Nt,s(l("trafficType",o(n).value)),1),e("dd",Et,[e("span",{class:A([re(t.value.trafficType),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},s(l(t.value.trafficType?.toLowerCase()||"unknown",o(n).value)),3)])])):u("",!0),t.value.productId?(i(),c("div",Tt,[e("dt",At,s(l("product",o(n).value)),1),e("dd",Ot,s(X(t.value.productId)),1)])):u("",!0),t.value.creatorName||t.value.creatorId?(i(),c("div",jt,[e("dt",Pt,s(l("creator",o(n).value)),1),e("dd",Mt,s(t.value.creatorName||$(t.value.creatorId)),1)])):u("",!0),t.value.producerName||t.value.producerId?(i(),c("div",$t,[e("dt",Ft,s(l("producer",o(n).value)),1),e("dd",Lt,s(t.value.producerName||$(t.value.producerId)),1)])):u("",!0),t.value.creationDate?(i(),c("div",Bt,[e("dt",Ut,s(l("createdAt",o(n).value)),1),e("dd",Gt,s(_(t.value.creationDate)),1)])):u("",!0),e("div",Rt,[e("dt",Ht,s(l("productionStartDate",o(n).value)),1),e("dd",qt,s(t.value.productionStartDate?_(t.value.productionStartDate):"â€”"),1)]),e("div",zt,[e("dt",Yt,s(l("productionEndDate",o(n).value)),1),e("dd",Jt,s(t.value.productionEndDate?_(t.value.productionEndDate):"â€”"),1)]),t.value.postDate?(i(),c("div",Vt,[e("dt",Kt,s(l("postDate",o(n).value)),1),e("dd",Qt,s(_(t.value.postDate)),1)])):u("",!0),e("div",Wt,[a[7]||(a[7]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Meta Ads ID",-1)),e("dd",Xt,s(t.value.metaAdsId||"â€”"),1)])])]),e("section",Zt,[e("h2",ea,s(l("history",o(n).value)),1),t.value.history&&t.value.history.length?(i(),c("ol",ta,[(i(!0),c(m,null,b(t.value.history,(d,y)=>(i(),c("li",{key:d.changedAt+(d.newStatus||""),class:"flex items-start gap-4"},[e("div",aa,[e("span",{class:A(["w-3 h-3 rounded-full ring-4 ring-white dark:ring-gray-800",K(d.newStatus)])},null,2),y<t.value.history.length-1?(i(),c("span",sa)):u("",!0)]),e("div",ra,[e("div",oa,[e("span",{class:"truncate max-w-[140px]",title:d.userName},s(d.userName),9,na),a[8]||(a[8]=e("span",{class:"text-gray-400"},"â€¢",-1)),e("span",la,[d.previousStatus?(i(),c("span",da,s(l(d.previousStatus,o(n).value)),1)):u("",!0),d.previousStatus?(i(),c("span",ca,"â†’")):u("",!0),e("span",null,s(l(d.newStatus,o(n).value)),1)])]),e("div",ia,s(_(d.changedAt)),1)])]))),128))])):(i(),c("div",ua,[e("div",ga,[a[9]||(a[9]=e("div",{class:"w-8 h-8 aspect-square rounded-full bg-gray-100 dark:bg-gray-700 inline-flex items-center justify-center flex-none shrink-0"},[e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ya,[e("div",pa,s(l("noHistoryTitle",o(n).value)),1),e("div",xa,s(l("noHistoryDesc",o(n).value)),1)])])]))])])])):u("",!0),k(De,{show:S.value,"form-data":g,"editing-content":t.value,products:o(j),users:o(M),channels:o(P),"content-types":o(z),"content-statuses":o(Y),t:l,language:o(n).value,user:o(w),"is-submitting":C.value,onCancel:ae,onSubmit:se},null,8,["show","form-data","editing-content","products","users","channels","content-types","content-statuses","language","user","is-submitting"])]))}};export{Da as default};
