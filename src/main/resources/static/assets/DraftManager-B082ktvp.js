import{c as fe,h as E,o as n,a as u,f as $,b as e,t as r,p as m,u as t,w as me,g as D,v as B,z as P,q as C,s as I,T as Ve,m as je,n as ue,A as Re,F as de,d as f,e as le,B as be,C as te,x as xe,D as Me,r as k,y as ee,l as Fe,j as ge}from"./index-DbB0lweT.js";import{u as he}from"./useData-V0qgd-s4.js";import{_ as w}from"./SkeletonLoader-DF0asLhP.js";import{X as qe}from"./x-Bv0JcnuT.js";import{L as ne}from"./loader-circle-xaVZ0R8c.js";import{A as oe}from"./arrow-right-BnEG0L7G.js";import{S as Le}from"./square-pen-BLm1d_9d.js";import{T as pe,a as Ge}from"./triangle-alert-CuWdgXWZ.js";import{C as Be}from"./circle-check-big-CvCo5Q1D.js";import{P as ze}from"./plus-DCAQ6IeS.js";import"./userService-BbL24v_D.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=fe("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=fe("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Xe={key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center p-4"},We={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[calc(100vh-2rem)] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true"},Ye={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 shrink-0 sticky top-0 bg-white/90 dark:bg-gray-800/90 backdrop-blur rounded-t-lg"},Je={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ke=["disabled"],Qe={class:"flex-1 overflow-y-auto p-6"},Ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},et=["disabled","placeholder"],tt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},at=["disabled"],rt={value:""},st=["value"],ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dt=["disabled"],lt={value:""},nt=["value"],it={key:0},ct={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ut=["disabled"],gt=["value"],yt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ft=["disabled","placeholder"],mt={class:"flex flex-col sm:flex-row gap-3 sm:justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-600 shrink-0 bg-gray-50 dark:bg-gray-800/50"},bt=["disabled"],xt=["disabled"],ht={__name:"DraftFormModal",props:{show:{type:Boolean,default:!1},editingDraft:{type:Object,default:null},user:{type:Object,default:null},formData:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1},contentTypes:{type:Array,required:!0},draftStatuses:{type:Array,required:!0},products:{type:Array,required:!0},t:{type:Function,required:!0},language:{type:String,required:!0}},emits:["submit","cancel"],setup(a){return(o,g)=>(n(),E(Ve,{to:"body"},[a.show?(n(),u("div",Xe,[e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g[0]||(g[0]=c=>o.$emit("cancel"))}),e("div",We,[e("div",Ye,[e("h3",Je,r(a.editingDraft?a.t("editDraft",a.language):a.t("createNewDraft",a.language)),1),e("button",{onClick:g[1]||(g[1]=c=>o.$emit("cancel")),disabled:a.isSubmitting,class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 disabled:opacity-50"},[m(t(qe),{class:"w-5 h-5"})],8,Ke)]),e("div",Qe,[e("form",{onSubmit:g[7]||(g[7]=me(c=>o.$emit("submit",a.formData),["prevent"])),class:"space-y-4"},[e("div",null,[e("label",Ze,r(a.t("name",a.language))+" * ",1),D(e("input",{"onUpdate:modelValue":g[2]||(g[2]=c=>a.formData.name=c),type:"text",required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",placeholder:a.t("enterDraftName",a.language)},null,8,et),[[B,a.formData.name]])]),e("div",null,[e("label",tt,r(a.t("type",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[3]||(g[3]=c=>a.formData.type=c),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",rt,r(a.t("selectType",a.language)),1),(n(!0),u(C,null,I(a.contentTypes,c=>(n(),u("option",{key:c,value:c},r(c),9,st))),128))],8,at),[[P,a.formData.type]])]),e("div",null,[e("label",ot,r(a.t("product",a.language)),1),D(e("select",{"onUpdate:modelValue":g[4]||(g[4]=c=>a.formData.productId=c),disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",lt,r(a.t("selectProduct",a.language)),1),(n(!0),u(C,null,I(a.products,c=>(n(),u("option",{key:c.id,value:c.id},r(c.name),9,nt))),128))],8,dt),[[P,a.formData.productId]])]),a.user?.adminType==="ADMIN"?(n(),u("div",it,[e("label",ct,r(a.t("status",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[5]||(g[5]=c=>a.formData.status=c),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[(n(!0),u(C,null,I(a.draftStatuses,c=>(n(),u("option",{key:c,value:c},r(a.t(c.toLowerCase(),a.language)),9,gt))),128))],8,ut),[[P,a.formData.status]])])):$("",!0),e("div",null,[e("label",yt,r(a.t("draftContent",a.language))+" * ",1),D(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=c=>a.formData.content=c),required:"",disabled:a.isSubmitting,rows:"6",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50 resize-none",placeholder:a.t("enterDraftContent",a.language)},null,8,ft),[[B,a.formData.content]])])],32)]),e("div",mt,[e("button",{onClick:g[8]||(g[8]=c=>o.$emit("cancel")),disabled:a.isSubmitting,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(a.t("cancel",a.language)),9,bt),e("button",{onClick:g[9]||(g[9]=c=>o.$emit("submit",a.formData)),disabled:a.isSubmitting||!a.formData.name||!a.formData.type||!a.formData.content,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isSubmitting?(n(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):$("",!0),e("span",null,r(a.editingDraft?a.t("update",a.language):a.t("create",a.language)),1)],8,xt)])])])):$("",!0)]))}},pt={class:"overflow-x-auto"},vt={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},kt={class:"bg-gray-50 dark:bg-gray-700"},wt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},$t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},_t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},It={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Tt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Pt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},St={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm font-medium text-gray-900 dark:text-white"},Et={class:"px-6 py-4 whitespace-nowrap"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Ot={class:"px-6 py-4 whitespace-nowrap"},Ut={class:"text-sm text-gray-600 dark:text-gray-400"},Vt={class:"px-6 py-4 whitespace-nowrap"},jt={class:"text-sm text-gray-600 dark:text-gray-400"},Rt={class:"px-6 py-4 whitespace-nowrap"},Mt={class:"flex items-center space-x-2"},Ft={class:"px-6 py-4 whitespace-nowrap"},qt={class:"text-sm text-gray-600 dark:text-gray-400"},Lt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Gt={class:"flex items-center justify-end space-x-2"},Bt=["onClick","title"],zt=["onClick","title"],Ht=["onClick","title"],Xt={key:0,class:"text-center py-12"},Wt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Yt={class:"text-gray-600 dark:text-gray-400"},Jt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,products:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(a){const o=a,{filteredDrafts:g,users:c,products:S,t:p,language:v,canEdit:A}=je(o);function M(s){const d=c.value.find(i=>i.id===s);return d?d.name:"Unknown"}function l(s){if(!s)return"-";const d=S.value?.find(i=>i.id===s);return d?d.name:"Produto não encontrado"}function z(s){return s==="APPROVED"?Be:s==="PENDING"?ye:s==="NOT_APPROVED"?He:ye}function j(s){return s==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":s==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":s==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function F(s){return s==="APPROVED"?"text-green-500 dark:text-green-400":s==="PENDING"?"text-yellow-500 dark:text-yellow-400":s==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function b(s){if(!s)return"";try{let d;if(Array.isArray(s)&&s.length>=3){const[i,N,q,O=0,T=0,U=0]=s;d=new Date(i,N-1,q,O,T,U)}else if(typeof s=="string")d=new Date(s);else if(s instanceof Date)d=s;else return"Data inválida";return!(d instanceof Date)||isNaN(d.getTime())?"Data inválida":d.toLocaleDateString()}catch{return"Data inválida"}}return(s,d)=>(n(),u("div",pt,[e("table",vt,[e("thead",kt,[e("tr",null,[e("th",wt,r(t(p)("name",t(v))),1),e("th",$t,r(t(p)("type",t(v))),1),e("th",Dt,r(t(p)("product",t(v))),1),e("th",_t,r(t(p)("creator",t(v))),1),e("th",Ct,r(t(p)("status",t(v))),1),e("th",It,r(t(p)("created",t(v))),1),e("th",Tt,r(t(p)("actions",t(v))),1)])]),e("tbody",Pt,[(n(!0),u(C,null,I(t(g),i=>(n(),u("tr",{key:i.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",St,[e("div",Nt,r(i.name),1)]),e("td",Et,[e("div",At,r(i.type),1)]),e("td",Ot,[e("div",Ut,r(l(i.productId)),1)]),e("td",Vt,[e("div",jt,r(M(i.creatorId)),1)]),e("td",Rt,[e("div",Mt,[(n(),E(Re(z(i.status)),{class:ue(["w-4 h-4",F(i.status)])},null,8,["class"])),e("span",{class:ue(j(i.status))},r(t(p)(i.status?.toLowerCase()||"draft",t(v))),3)])]),e("td",Ft,[e("div",qt,r(b(i.createdAt)),1)]),e("td",Lt,[e("div",Gt,[i.status==="APPROVED"&&t(A)(i)?(n(),u("button",{key:0,onClick:N=>s.$emit("transform",i),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:t(p)("transformToContent",t(v))},[m(t(oe),{class:"w-4 h-4"})],8,Bt)):$("",!0),t(A)(i)?(n(),u("button",{key:1,onClick:N=>s.$emit("edit",i),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:t(p)("editDraft",t(v))},[m(t(Le),{class:"w-4 h-4"})],8,zt)):$("",!0),t(A)(i)?(n(),u("button",{key:2,onClick:N=>s.$emit("delete",i),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:t(p)("deleteDraft",t(v))},[m(t(pe),{class:"w-4 h-4"})],8,Ht)):$("",!0)])])]))),128))])]),t(g).length?$("",!0):(n(),u("div",Xt,[m(t(de),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e("h3",Wt,r(t(p)("noDraftsFound",t(v))),1),e("p",Yt,r(t(p)("createFirstDraft",t(v))),1)]))]))}},Kt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Qt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},Zt={class:"p-6"},ea={class:"flex items-center mb-4"},ta={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},aa={class:"text-lg font-medium text-gray-900 dark:text-white"},ra={class:"mb-6"},sa={class:"text-gray-600 dark:text-gray-400"},oa={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},da={class:"flex items-center"},la={class:"min-w-0 flex-1"},na={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ia={class:"text-xs text-gray-500 dark:text-gray-400"},ca={class:"flex space-x-3 justify-end"},ua=["disabled"],ga=["disabled"],ya={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le();return(g,c)=>(n(),u("div",Kt,[e("div",Qt,[e("div",Zt,[e("div",ea,[e("div",ta,[m(t(Ge),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),e("div",null,[e("h3",aa,r(t(f)("confirmDeletion",t(o))),1)])]),e("div",ra,[e("p",sa,r(t(f)("confirmDeleteDraft",t(o))),1),e("div",oa,[e("div",da,[m(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",la,[e("span",na,r(a.draft?.name),1),e("span",ia,r(a.draft?.type)+" • "+r(t(f)(a.draft?.status?.toLowerCase()||"draft",t(o))),1)])])])]),e("div",ca,[e("button",{onClick:c[0]||(c[0]=S=>g.$emit("cancel")),disabled:a.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,ua),e("button",{onClick:c[1]||(c[1]=S=>g.$emit("confirm")),disabled:a.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isDeleting?(n(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(n(),E(t(pe),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isDeleting?t(f)("deleting",t(o)):t(f)("delete",t(o))),1)],8,ga)])])])]))}},fa={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ma={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},ba={class:"p-6"},xa={class:"flex items-center mb-4"},ha={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},pa={class:"text-lg font-medium text-gray-900 dark:text-white"},va={class:"mb-6"},ka={class:"text-gray-600 dark:text-gray-400 mb-4"},wa={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},$a={class:"flex items-center"},Da={class:"min-w-0 flex-1"},_a={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Ca={class:"text-xs text-gray-500 dark:text-gray-400"},Ia={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ta={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pa=["disabled"],Sa={value:""},Na=["value"],Ea={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Aa=["disabled"],Oa={value:""},Ua=["value"],Va={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ja={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ra=["disabled"],Ma={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Fa=["disabled"],qa={value:"PENDING"},La={value:"IN_PRODUCTION"},Ga={value:"POSTED"},Ba={value:"PRODUCTION_FINISHED"},za={value:"FINISHED"},Ha={value:"CANCELED"},Xa={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ya=["disabled"],Ja={value:"ORGANIC"},Ka={value:"PAID"},Qa={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Za={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},er=["disabled"],tr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ar=["disabled"],rr={key:1},sr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},or=["disabled","placeholder"],dr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},lr={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},nr=["id","value","disabled"],ir=["for"],cr={key:0,class:"text-xs text-red-500 mt-1"},ur={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},gr=["disabled"],yr=["disabled"],fr={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le(),{channels:g,products:c,users:S,fetchChannels:p,fetchProducts:v,fetchUsers:A}=he(),M=a,l=be({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:"",trafficType:"ORGANIC"});te(()=>l.status,b=>{b!=="IN_PRODUCTION"&&(l.productionStartDate="",l.productionEndDate=""),b!=="POSTED"&&(l.metaAdsId="")}),xe(async()=>{await Promise.all([g.value&&g.value.length>0?Promise.resolve():p(),c.value&&c.value.length>0?Promise.resolve():v(),S.value&&S.value.length>0?Promise.resolve():A()])}),te(()=>M.draft,()=>{l.status="PENDING",l.channelIds=[],l.productId=M.draft?.productId||"",l.producerId="",l.postDate="",l.productionStartDate="",l.productionEndDate="",l.metaAdsId="",l.trafficType="ORGANIC"},{immediate:!0});const z=b=>{if(!b)return"";const s=f(`contentTypes.${b}`,o.value);return s.startsWith("contentTypes.")?b:s},j=b=>{if(!b)return;const s=new Date(b),d=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),N=String(s.getDate()).padStart(2,"0"),q=String(s.getHours()).padStart(2,"0"),O=String(s.getMinutes()).padStart(2,"0"),T=String(s.getSeconds()).padStart(2,"0");return`${d}-${i}-${N}T${q}:${O}:${T}`},F=()=>{const b={status:l.status,channelIds:l.channelIds,productId:l.productId||null,producerId:l.producerId||null,postDate:j(l.postDate),trafficType:l.trafficType};return l.status==="IN_PRODUCTION"&&(b.productionStartDate=j(l.productionStartDate),b.productionEndDate=j(l.productionEndDate)),l.status==="POSTED"&&(b.metaAdsId=l.metaAdsId||null),b};return(b,s)=>(n(),u("div",fa,[e("div",ma,[e("div",ba,[e("div",xa,[e("div",ha,[m(t(oe),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("div",null,[e("h3",pa,r(t(f)("transformDraft",t(o))),1)])]),e("div",va,[e("p",ka,r(t(f)("transformDraftDescription",t(o))),1),e("div",wa,[e("div",$a,[m(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",Da,[e("span",_a,r(a.draft?.name),1),e("span",Ca,r(z(a.draft?.type)),1)])])]),e("form",{onSubmit:s[9]||(s[9]=me(d=>b.$emit("confirm",F()),["prevent"])),class:"space-y-4"},[e("div",Ia,[e("div",null,[e("label",Ta,r(t(f)("product",t(o))),1),D(e("select",{"onUpdate:modelValue":s[0]||(s[0]=d=>l.productId=d),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Sa,r(t(f)("selectProduct",t(o))),1),(n(!0),u(C,null,I(t(c),d=>(n(),u("option",{key:d.id,value:d.id},r(d.name),9,Na))),128))],8,Pa),[[P,l.productId]])]),e("div",null,[e("label",Ea,r(t(f)("producer",t(o))),1),D(e("select",{"onUpdate:modelValue":s[1]||(s[1]=d=>l.producerId=d),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Oa,r(t(f)("selectProducer",t(o))),1),(n(!0),u(C,null,I(t(S),d=>(n(),u("option",{key:d.id,value:d.id},r(d.name),9,Ua))),128))],8,Aa),[[P,l.producerId]])])]),e("div",Va,[e("div",null,[e("label",ja,r(t(f)("postDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>l.postDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ra),[[B,l.postDate]])]),e("div",null,[e("label",Ma,r(t(f)("status",t(o))),1),D(e("select",{"onUpdate:modelValue":s[3]||(s[3]=d=>l.status=d),required:"",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",qa,r(t(f)("pending",t(o))),1),e("option",La,r(t(f)("in_production",t(o))),1),e("option",Ga,r(t(f)("posted",t(o))),1),e("option",Ba,r(t(f)("production-finished",t(o))),1),e("option",za,r(t(f)("finished",t(o))),1),e("option",Ha,r(t(f)("canceled",t(o))),1)],8,Fa),[[P,l.status]])])]),e("div",Xa,[e("div",null,[e("label",Wa,r(t(f)("trafficType",t(o))),1),D(e("select",{"onUpdate:modelValue":s[4]||(s[4]=d=>l.trafficType=d),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Ja,r(t(f)("organic",t(o))),1),e("option",Ka,r(t(f)("paid",t(o))),1)],8,Ya),[[P,l.trafficType]])])]),l.status==="IN_PRODUCTION"?(n(),u("div",Qa,[e("div",null,[e("label",Za,r(t(f)("productionStartDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[5]||(s[5]=d=>l.productionStartDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,er),[[B,l.productionStartDate]])]),e("div",null,[e("label",tr,r(t(f)("productionEndDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[6]||(s[6]=d=>l.productionEndDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,ar),[[B,l.productionEndDate]])])])):$("",!0),l.status==="POSTED"?(n(),u("div",rr,[e("label",sr,r(t(f)("metaAdsId",t(o))),1),D(e("input",{"onUpdate:modelValue":s[7]||(s[7]=d=>l.metaAdsId=d),type:"text",disabled:a.isTransforming,placeholder:t(f)("enterMetaAdsId",t(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,or),[[B,l.metaAdsId]])])):$("",!0),e("div",null,[e("label",dr,r(t(f)("channels",t(o)))+" * ",1),e("div",lr,[(n(!0),u(C,null,I(t(g),d=>(n(),u("div",{key:d.id,class:"flex items-center"},[D(e("input",{id:`channel-${d.id}`,type:"checkbox",value:d.id,"onUpdate:modelValue":s[8]||(s[8]=i=>l.channelIds=i),disabled:a.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,nr),[[Me,l.channelIds]]),e("label",{for:`channel-${d.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},r(d.name),9,ir)]))),128))]),l.channelIds.length===0?(n(),u("p",cr,r(t(f)("selectAtLeastOneChannel",t(o))),1)):$("",!0)])],32)]),e("div",ur,[e("button",{onClick:s[10]||(s[10]=d=>b.$emit("cancel")),disabled:a.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,gr),e("button",{onClick:s[11]||(s[11]=d=>b.$emit("confirm",F())),disabled:a.isTransforming||l.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isTransforming?(n(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(n(),E(t(oe),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isTransforming?t(f)("transforming",t(o)):t(f)("transform",t(o))),1)],8,yr)])])])]))}},mr={class:"space-y-6"},br={class:"flex justify-between items-center"},xr={class:"text-2xl font-bold text-gray-900 dark:text-white"},hr={key:0},pr={key:0,class:"space-y-6"},vr={class:"flex space-x-4"},kr={class:"overflow-x-auto"},wr={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},$r={class:"bg-gray-50 dark:bg-gray-700"},Dr={class:"px-6 py-3 text-left"},_r={class:"px-6 py-3 text-left"},Cr={class:"px-6 py-3 text-left"},Ir={class:"px-6 py-3 text-left"},Tr={class:"px-6 py-3 text-left"},Pr={class:"px-6 py-3 text-right"},Sr={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Nr={class:"px-6 py-4"},Er={class:"px-6 py-4"},Ar={class:"px-6 py-4"},Or={class:"px-6 py-4"},Ur={class:"flex items-center space-x-2"},Vr={class:"px-6 py-4"},jr={class:"px-6 py-4"},Rr={class:"flex items-center justify-end space-x-2"},Mr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Fr={class:"text-red-600"},qr={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Lr={class:"text-green-600"},Gr={key:3,class:"flex space-x-4"},Br={value:""},zr=["value"],Hr={value:""},Xr=["value"],Wr={value:""},Yr=["value"],Jr={key:4},Kr={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},Qr={class:"text-sm text-gray-600 dark:text-gray-400"},Zr={class:"flex items-center space-x-2"},es=["disabled"],ts=["disabled"],ys={__name:"DraftManager",setup(a){const{language:o}=le(),{currentUser:g}=Fe(),{drafts:c,users:S,products:p,loadingDrafts:v,errors:A,fetchDrafts:M,fetchUsers:l,fetchChannels:z,fetchProducts:j,createDraft:F,updateDraft:b,deleteDraft:s,transformDraftToContent:d}=he(),i=y=>f(y,o.value),N=["Post","Story","Reels","Video","Artigo"],q=["PENDING","APPROVED","NOT_APPROVED"],O=k(!1),T=k(null),U=k(""),X=k(""),W=k(""),ae=be({name:"",type:"",content:"",productId:"",status:"PENDING"}),Y=k(!1),R=k(""),J=k(!0),K=k(!1),Q=k(!1),L=k(null),G=k(null),re=k(!1),se=k(!1),_=k(0),ve=k(15),H=k(1),Z=k(0);xe(async()=>{await Promise.all([l(),z(),j()]),await V(),J.value=!1}),te(U,async()=>{_.value=0,await V()}),te(W,async()=>{_.value=0,await V()});const ke=ee(()=>!c.value||!g.value?[]:c.value),we=ee(()=>ke.value.filter(y=>!(U.value&&y.status!==U.value||X.value&&y.type!==X.value))),$e=ee(()=>we.value),De=ee(()=>_.value+1),V=async()=>{const y=await M({status:U.value||void 0,productId:W.value||void 0,page:_.value,size:ve.value});y&&typeof y=="object"&&(typeof y.totalPages=="number"&&(H.value=y.totalPages),typeof y.totalElements=="number"&&(Z.value=y.totalElements))},_e=async()=>{_.value!==0&&(_.value-=1,await V())},Ce=async()=>{_.value>=H.value-1||(_.value+=1,await V())};async function ie(){_.value=0,await V()}async function Ie(y){if(!Y.value){Y.value=!0,R.value="";try{let h;if(T.value)h=await b(T.value.id,y);else{const x={...y,creatorId:g.value.id,status:y.status||"PENDING"};h=await F(x)}h.success?(R.value=T.value?i("draftUpdatedSuccessfully"):i("draftCreatedSuccessfully"),ce(),await V()):console.error("Error:",h.error)}catch(h){console.error("Unexpected error:",h)}finally{Y.value=!1}}}function Te(y){T.value=y,Object.assign(ae,{name:y.name,type:y.type,content:y.content||"",productId:y.productId||"",status:y.status}),O.value=!0}function ce(){O.value=!1,T.value=null,Object.assign(ae,{name:"",type:"",content:"",productId:"",status:"PENDING"}),R.value=""}async function Pe(y){L.value=y,K.value=!0}async function Se(){if(L.value){re.value=!0;try{const y=await s(L.value.id);y.success?(R.value=i("draftDeletedSuccessfully"),K.value=!1,L.value=null):console.error("Error:",y.error)}catch(y){console.error("Unexpected error:",y)}finally{re.value=!1}}}function Ne(){K.value=!1,L.value=null}async function Ee(y){G.value=y,Q.value=!0}async function Ae(y){if(G.value){se.value=!0;try{const h=await d(G.value.id,y);h.success?(R.value=i("draftTransformed"),Q.value=!1,G.value=null,await V()):console.error("Error:",h.error)}catch(h){console.error("Unexpected error:",h)}finally{se.value=!1}}}function Oe(){Q.value=!1,G.value=null}function Ue(y){return g.value?g.value.adminType==="ADMIN"||y.creatorId===g.value.id:!1}return(y,h)=>(n(),u("div",mr,[e("div",br,[e("h2",xr,[ge(r(i("drafts",t(o)))+" ",1),Z.value?(n(),u("span",hr,"("+r(Z.value)+")",1)):$("",!0)]),e("button",{onClick:h[0]||(h[0]=x=>O.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[m(t(ze),{class:"w-4 h-4 mr-2"}),ge(" "+r(i("newDraft",t(o))),1)])]),t(v)||J.value?(n(),u("div",pr,[e("div",vr,[m(w,{customClass:"h-10 w-32"}),m(w,{customClass:"h-10 w-32"}),m(w,{customClass:"h-10 w-32"})]),e("div",kr,[e("table",wr,[e("thead",$r,[e("tr",null,[e("th",Dr,[m(w,{customClass:"h-4 w-16"})]),e("th",_r,[m(w,{customClass:"h-4 w-12"})]),e("th",Cr,[m(w,{customClass:"h-4 w-20"})]),e("th",Ir,[m(w,{customClass:"h-4 w-16"})]),e("th",Tr,[m(w,{customClass:"h-4 w-20"})]),e("th",Pr,[m(w,{customClass:"h-4 w-16"})])])]),e("tbody",Sr,[(n(),u(C,null,I(6,x=>e("tr",{key:x},[e("td",Nr,[m(w,{customClass:"h-4 w-32 shimmer"})]),e("td",Er,[m(w,{customClass:"h-4 w-16 shimmer"})]),e("td",Ar,[m(w,{customClass:"h-4 w-24 shimmer"})]),e("td",Or,[e("div",Ur,[m(w,{customClass:"h-4 w-4 rounded-full shimmer"}),m(w,{customClass:"h-4 w-20 shimmer"})])]),e("td",Vr,[m(w,{customClass:"h-4 w-24 shimmer"})]),e("td",jr,[e("div",Rr,[m(w,{customClass:"h-8 w-8 rounded shimmer"}),m(w,{customClass:"h-8 w-8 rounded shimmer"}),m(w,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):t(A).drafts?(n(),u("div",Mr,[e("p",Fr,r(t(A).drafts),1)])):$("",!0),R.value?(n(),u("div",qr,[e("p",Lr,r(R.value),1)])):$("",!0),!t(v)&&!J.value?(n(),u("div",Gr,[D(e("select",{"onUpdate:modelValue":h[1]||(h[1]=x=>U.value=x),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Br,r(i("allStatuses",t(o))),1),(n(),u(C,null,I(q,x=>e("option",{key:x,value:x},r(i(x.toLowerCase(),t(o))),9,zr)),64))],544),[[P,U.value]]),D(e("select",{"onUpdate:modelValue":h[2]||(h[2]=x=>X.value=x),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Hr,r(i("allTypes",t(o))),1),(n(),u(C,null,I(N,x=>e("option",{key:x,value:x},r(x),9,Xr)),64))],512),[[P,X.value]]),D(e("select",{"onUpdate:modelValue":h[3]||(h[3]=x=>W.value=x),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Wr,r(i("allProducts",t(o))),1),(n(!0),u(C,null,I(t(p),x=>(n(),u("option",{key:x.id,value:x.id},r(x.name),9,Yr))),128))],544),[[P,W.value]])])):$("",!0),m(ht,{show:O.value,editingDraft:T.value,user:t(g),formData:ae,isSubmitting:Y.value,contentTypes:N,draftStatuses:q,products:t(p),t:i,language:t(o),onSubmit:Ie,onCancel:ce},null,8,["show","editingDraft","user","formData","isSubmitting","products","language"]),!t(v)&&!J.value?(n(),u("div",Jr,[m(Jt,{filteredDrafts:$e.value,users:t(S),products:t(p),t:i,language:t(o),canEdit:Ue,onEdit:Te,onDelete:Pe,onTransform:Ee},null,8,["filteredDrafts","users","products","language"]),H.value>1?(n(),u("div",Kr,[e("div",Qr,r(i("page",t(o)))+" "+r(De.value)+" / "+r(H.value)+" · "+r(Z.value)+" "+r(i("items",t(o))),1),e("div",Zr,[e("button",{onClick:_e,disabled:_.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(i("previous",t(o))),9,es),e("button",{onClick:Ce,disabled:_.value>=H.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(i("next",t(o))),9,ts)])])):$("",!0)])):$("",!0),K.value?(n(),E(ya,{key:5,draft:L.value,"is-deleting":re.value,onConfirm:Se,onCancel:Ne},null,8,["draft","is-deleting"])):$("",!0),Q.value?(n(),E(fr,{key:6,draft:G.value,"is-transforming":se.value,onConfirm:Ae,onCancel:Oe},null,8,["draft","is-transforming"])):$("",!0)]))}};export{ys as default};
