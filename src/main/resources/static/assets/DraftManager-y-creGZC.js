import{c as fe,h as A,o as l,a as i,f as D,b as e,t as r,p as b,u as t,w as be,g as _,v as z,z as S,q as I,s as T,T as Ve,m as je,n as ue,A as Re,F as de,d as f,e as le,B as me,C as te,x as xe,D as Me,r as w,y as ee,l as Fe,j as ge}from"./index-4us4u8gX.js";import{u as he}from"./useData-DR7hQcBS.js";import{_ as $}from"./SkeletonLoader-2gaGNWFn.js";import{X as qe}from"./x-BdNQjDlu.js";import{L as ne}from"./loader-circle-Bb3LPLMK.js";import{A as oe}from"./arrow-right-Bh9t5kNf.js";import{S as Ge}from"./square-pen-CGgiZTT5.js";import{T as pe,a as Le}from"./triangle-alert-THgH8cLR.js";import{C as Be}from"./circle-check-big-BgCwFrgY.js";import{P as ze}from"./plus-Dr4IpE4g.js";import"./userService-DVxHc81-.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=fe("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=fe("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Xe={key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center p-4"},We={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[calc(100vh-2rem)] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true"},Ye={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 shrink-0 sticky top-0 bg-white/90 dark:bg-gray-800/90 backdrop-blur rounded-t-lg"},Je={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ke=["disabled"],Qe={class:"flex-1 overflow-y-auto p-6"},Ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},et=["disabled","placeholder"],tt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},at=["disabled"],rt={value:""},st=["value"],ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dt=["disabled"],lt={value:""},nt=["value"],it={key:0},ct={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ut=["disabled"],gt=["value"],yt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ft=["disabled","placeholder"],bt={class:"flex flex-col sm:flex-row gap-3 sm:justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-600 shrink-0 bg-gray-50 dark:bg-gray-800/50"},mt=["disabled"],xt=["disabled"],ht={__name:"DraftFormModal",props:{show:{type:Boolean,default:!1},editingDraft:{type:Object,default:null},user:{type:Object,default:null},formData:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1},contentTypes:{type:Array,required:!0},draftStatuses:{type:Array,required:!0},products:{type:Array,required:!0},t:{type:Function,required:!0},language:{type:String,required:!0}},emits:["submit","cancel"],setup(a){return(o,g)=>(l(),A(Ve,{to:"body"},[a.show?(l(),i("div",Xe,[e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g[0]||(g[0]=n=>o.$emit("cancel"))}),e("div",We,[e("div",Ye,[e("h3",Je,r(a.editingDraft?a.t("editDraft",a.language):a.t("createNewDraft",a.language)),1),e("button",{onClick:g[1]||(g[1]=n=>o.$emit("cancel")),disabled:a.isSubmitting,class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 disabled:opacity-50"},[b(t(qe),{class:"w-5 h-5"})],8,Ke)]),e("div",Qe,[e("form",{onSubmit:g[7]||(g[7]=be(n=>o.$emit("submit",a.formData),["prevent"])),class:"space-y-4"},[e("div",null,[e("label",Ze,r(a.t("name",a.language))+" * ",1),_(e("input",{"onUpdate:modelValue":g[2]||(g[2]=n=>a.formData.name=n),type:"text",required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",placeholder:a.t("enterDraftName",a.language)},null,8,et),[[z,a.formData.name]])]),e("div",null,[e("label",tt,r(a.t("type",a.language))+" * ",1),_(e("select",{"onUpdate:modelValue":g[3]||(g[3]=n=>a.formData.type=n),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",rt,r(a.t("selectType",a.language)),1),(l(!0),i(I,null,T(a.contentTypes,n=>(l(),i("option",{key:n,value:n},r(n),9,st))),128))],8,at),[[S,a.formData.type]])]),e("div",null,[e("label",ot,r(a.t("product",a.language)),1),_(e("select",{"onUpdate:modelValue":g[4]||(g[4]=n=>a.formData.productId=n),disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",lt,r(a.t("selectProduct",a.language)),1),(l(!0),i(I,null,T(a.products,n=>(l(),i("option",{key:n.id,value:n.id},r(n.name),9,nt))),128))],8,dt),[[S,a.formData.productId]])]),a.user?.adminType==="ADMIN"?(l(),i("div",it,[e("label",ct,r(a.t("status",a.language))+" * ",1),_(e("select",{"onUpdate:modelValue":g[5]||(g[5]=n=>a.formData.status=n),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[(l(!0),i(I,null,T(a.draftStatuses,n=>(l(),i("option",{key:n,value:n},r(a.t(n.toLowerCase(),a.language)),9,gt))),128))],8,ut),[[S,a.formData.status]])])):D("",!0),e("div",null,[e("label",yt,r(a.t("draftContent",a.language))+" * ",1),_(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=n=>a.formData.content=n),required:"",disabled:a.isSubmitting,rows:"6",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50 resize-none",placeholder:a.t("enterDraftContent",a.language)},null,8,ft),[[z,a.formData.content]])])],32)]),e("div",bt,[e("button",{onClick:g[8]||(g[8]=n=>o.$emit("cancel")),disabled:a.isSubmitting,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(a.t("cancel",a.language)),9,mt),e("button",{onClick:g[9]||(g[9]=n=>o.$emit("submit",a.formData)),disabled:a.isSubmitting||!a.formData.name||!a.formData.type||!a.formData.content,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isSubmitting?(l(),A(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):D("",!0),e("span",null,r(a.editingDraft?a.t("update",a.language):a.t("create",a.language)),1)],8,xt)])])])):D("",!0)]))}},pt={class:"overflow-x-auto"},vt={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},kt={class:"bg-gray-50 dark:bg-gray-700"},wt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},$t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},_t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},It={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Tt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Pt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},St={class:"px-6 py-4 whitespace-nowrap"},Nt=["title"],Et={class:"px-6 py-4 whitespace-nowrap"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Ot={class:"px-6 py-4 whitespace-nowrap"},Ut={class:"text-sm text-gray-600 dark:text-gray-400"},Vt={class:"px-6 py-4 whitespace-nowrap"},jt={class:"text-sm text-gray-600 dark:text-gray-400"},Rt={class:"px-6 py-4 whitespace-nowrap"},Mt={class:"flex items-center space-x-2"},Ft={class:"px-6 py-4 whitespace-nowrap"},qt={class:"text-sm text-gray-600 dark:text-gray-400"},Gt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Lt={class:"flex items-center justify-end space-x-2"},Bt=["onClick","title"],zt=["onClick","title"],Ht=["onClick","title"],Xt={key:0,class:"text-center py-12"},Wt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Yt={class:"text-gray-600 dark:text-gray-400"},Jt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,products:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(a){const o=a,{filteredDrafts:g,users:n,products:N,t:v,language:k,canEdit:O}=je(o);function F(s){const u=n.value.find(m=>m.id===s);return u?u.name:"Unknown"}function d(s){if(!s)return"-";const u=N.value?.find(m=>m.id===s);return u?u.name:"Produto não encontrado"}function H(s){return s==="APPROVED"?Be:s==="PENDING"?ye:s==="NOT_APPROVED"?He:ye}function R(s){return s==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":s==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":s==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function q(s){return s==="APPROVED"?"text-green-500 dark:text-green-400":s==="PENDING"?"text-yellow-500 dark:text-yellow-400":s==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function x(s){if(!s)return"";try{let u;if(Array.isArray(s)&&s.length>=3){const[m,E,U,P=0,V=0,G=0]=s;u=new Date(m,E-1,U,P,V,G)}else if(typeof s=="string")u=new Date(s);else if(s instanceof Date)u=s;else return"Data inválida";return!(u instanceof Date)||isNaN(u.getTime())?"Data inválida":u.toLocaleDateString()}catch{return"Data inválida"}}function c(s,u){return s?s.length>u?s.substring(0,u)+"...":s:""}return(s,u)=>(l(),i("div",pt,[e("table",vt,[e("thead",kt,[e("tr",null,[e("th",wt,r(t(v)("name",t(k))),1),e("th",$t,r(t(v)("type",t(k))),1),e("th",Dt,r(t(v)("product",t(k))),1),e("th",_t,r(t(v)("creator",t(k))),1),e("th",Ct,r(t(v)("status",t(k))),1),e("th",It,r(t(v)("created",t(k))),1),e("th",Tt,r(t(v)("actions",t(k))),1)])]),e("tbody",Pt,[(l(!0),i(I,null,T(t(g),m=>(l(),i("tr",{key:m.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",St,[e("div",{class:"text-sm font-medium text-gray-900 dark:text-white truncate",title:m.name},r(c(m.name,40)),9,Nt)]),e("td",Et,[e("div",At,r(m.type),1)]),e("td",Ot,[e("div",Ut,r(d(m.productId)),1)]),e("td",Vt,[e("div",jt,r(F(m.creatorId)),1)]),e("td",Rt,[e("div",Mt,[(l(),A(Re(H(m.status)),{class:ue(["w-4 h-4",q(m.status)])},null,8,["class"])),e("span",{class:ue(R(m.status))},r(t(v)(m.status?.toLowerCase()||"draft",t(k))),3)])]),e("td",Ft,[e("div",qt,r(x(m.createdAt)),1)]),e("td",Gt,[e("div",Lt,[m.status==="APPROVED"&&t(O)(m)?(l(),i("button",{key:0,onClick:E=>s.$emit("transform",m),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:t(v)("transformToContent",t(k))},[b(t(oe),{class:"w-4 h-4"})],8,Bt)):D("",!0),t(O)(m)?(l(),i("button",{key:1,onClick:E=>s.$emit("edit",m),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:t(v)("editDraft",t(k))},[b(t(Ge),{class:"w-4 h-4"})],8,zt)):D("",!0),t(O)(m)?(l(),i("button",{key:2,onClick:E=>s.$emit("delete",m),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:t(v)("deleteDraft",t(k))},[b(t(pe),{class:"w-4 h-4"})],8,Ht)):D("",!0)])])]))),128))])]),t(g).length?D("",!0):(l(),i("div",Xt,[b(t(de),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e("h3",Wt,r(t(v)("noDraftsFound",t(k))),1),e("p",Yt,r(t(v)("createFirstDraft",t(k))),1)]))]))}},Kt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Qt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},Zt={class:"p-6"},ea={class:"flex items-center mb-4"},ta={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},aa={class:"text-lg font-medium text-gray-900 dark:text-white"},ra={class:"mb-6"},sa={class:"text-gray-600 dark:text-gray-400"},oa={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},da={class:"flex items-center"},la={class:"min-w-0 flex-1"},na={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ia={class:"text-xs text-gray-500 dark:text-gray-400"},ca={class:"flex space-x-3 justify-end"},ua=["disabled"],ga=["disabled"],ya={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le();return(g,n)=>(l(),i("div",Kt,[e("div",Qt,[e("div",Zt,[e("div",ea,[e("div",ta,[b(t(Le),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),e("div",null,[e("h3",aa,r(t(f)("confirmDeletion",t(o))),1)])]),e("div",ra,[e("p",sa,r(t(f)("confirmDeleteDraft",t(o))),1),e("div",oa,[e("div",da,[b(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",la,[e("span",na,r(a.draft?.name),1),e("span",ia,r(a.draft?.type)+" • "+r(t(f)(a.draft?.status?.toLowerCase()||"draft",t(o))),1)])])])]),e("div",ca,[e("button",{onClick:n[0]||(n[0]=N=>g.$emit("cancel")),disabled:a.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,ua),e("button",{onClick:n[1]||(n[1]=N=>g.$emit("confirm")),disabled:a.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isDeleting?(l(),A(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(l(),A(t(pe),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isDeleting?t(f)("deleting",t(o)):t(f)("delete",t(o))),1)],8,ga)])])])]))}},fa={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ba={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},ma={class:"p-6"},xa={class:"flex items-center mb-4"},ha={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},pa={class:"text-lg font-medium text-gray-900 dark:text-white"},va={class:"mb-6"},ka={class:"text-gray-600 dark:text-gray-400 mb-4"},wa={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},$a={class:"flex items-center"},Da={class:"min-w-0 flex-1"},_a={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Ca={class:"text-xs text-gray-500 dark:text-gray-400"},Ia={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ta={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pa=["disabled"],Sa={value:""},Na=["value"],Ea={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Aa=["disabled"],Oa={value:""},Ua=["value"],Va={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ja={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ra=["disabled"],Ma={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Fa=["disabled"],qa={value:"PENDING"},Ga={value:"IN_PRODUCTION"},La={value:"POSTED"},Ba={value:"PRODUCTION_FINISHED"},za={value:"FINISHED"},Ha={value:"CANCELED"},Xa={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ya=["disabled"],Ja={value:"ORGANIC"},Ka={value:"PAID"},Qa={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Za={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},er=["disabled"],tr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ar=["disabled"],rr={key:1},sr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},or=["disabled","placeholder"],dr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},lr={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},nr=["id","value","disabled"],ir=["for"],cr={key:0,class:"text-xs text-red-500 mt-1"},ur={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},gr=["disabled"],yr=["disabled"],fr={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le(),{channels:g,products:n,users:N,fetchChannels:v,fetchProducts:k,fetchUsers:O}=he(),F=a,d=me({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:"",trafficType:"ORGANIC"});te(()=>d.status,x=>{x!=="IN_PRODUCTION"&&(d.productionStartDate="",d.productionEndDate=""),x!=="POSTED"&&(d.metaAdsId="")}),xe(async()=>{await Promise.all([g.value&&g.value.length>0?Promise.resolve():v(),n.value&&n.value.length>0?Promise.resolve():k(),N.value&&N.value.length>0?Promise.resolve():O()])}),te(()=>F.draft,()=>{d.status="PENDING",d.channelIds=[],d.productId=F.draft?.productId||"",d.producerId="",d.postDate="",d.productionStartDate="",d.productionEndDate="",d.metaAdsId="",d.trafficType="ORGANIC"},{immediate:!0});const H=x=>{if(!x)return"";const c=f(`contentTypes.${x}`,o.value);return c.startsWith("contentTypes.")?x:c},R=x=>{if(!x)return;const c=new Date(x),s=c.getFullYear(),u=String(c.getMonth()+1).padStart(2,"0"),m=String(c.getDate()).padStart(2,"0"),E=String(c.getHours()).padStart(2,"0"),U=String(c.getMinutes()).padStart(2,"0"),P=String(c.getSeconds()).padStart(2,"0");return`${s}-${u}-${m}T${E}:${U}:${P}`},q=()=>{const x={status:d.status,channelIds:d.channelIds,productId:d.productId||null,producerId:d.producerId||null,postDate:R(d.postDate),trafficType:d.trafficType};return d.status==="IN_PRODUCTION"&&(x.productionStartDate=R(d.productionStartDate),x.productionEndDate=R(d.productionEndDate)),d.status==="POSTED"&&(x.metaAdsId=d.metaAdsId||null),x};return(x,c)=>(l(),i("div",fa,[e("div",ba,[e("div",ma,[e("div",xa,[e("div",ha,[b(t(oe),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("div",null,[e("h3",pa,r(t(f)("transformDraft",t(o))),1)])]),e("div",va,[e("p",ka,r(t(f)("transformDraftDescription",t(o))),1),e("div",wa,[e("div",$a,[b(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",Da,[e("span",_a,r(a.draft?.name),1),e("span",Ca,r(H(a.draft?.type)),1)])])]),e("form",{onSubmit:c[9]||(c[9]=be(s=>x.$emit("confirm",q()),["prevent"])),class:"space-y-4"},[e("div",Ia,[e("div",null,[e("label",Ta,r(t(f)("product",t(o))),1),_(e("select",{"onUpdate:modelValue":c[0]||(c[0]=s=>d.productId=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Sa,r(t(f)("selectProduct",t(o))),1),(l(!0),i(I,null,T(t(n),s=>(l(),i("option",{key:s.id,value:s.id},r(s.name),9,Na))),128))],8,Pa),[[S,d.productId]])]),e("div",null,[e("label",Ea,r(t(f)("producer",t(o))),1),_(e("select",{"onUpdate:modelValue":c[1]||(c[1]=s=>d.producerId=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Oa,r(t(f)("selectProducer",t(o))),1),(l(!0),i(I,null,T(t(N),s=>(l(),i("option",{key:s.id,value:s.id},r(s.name),9,Ua))),128))],8,Aa),[[S,d.producerId]])])]),e("div",Va,[e("div",null,[e("label",ja,r(t(f)("postDate",t(o))),1),_(e("input",{"onUpdate:modelValue":c[2]||(c[2]=s=>d.postDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ra),[[z,d.postDate]])]),e("div",null,[e("label",Ma,r(t(f)("status",t(o))),1),_(e("select",{"onUpdate:modelValue":c[3]||(c[3]=s=>d.status=s),required:"",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",qa,r(t(f)("pending",t(o))),1),e("option",Ga,r(t(f)("in_production",t(o))),1),e("option",La,r(t(f)("posted",t(o))),1),e("option",Ba,r(t(f)("production-finished",t(o))),1),e("option",za,r(t(f)("finished",t(o))),1),e("option",Ha,r(t(f)("canceled",t(o))),1)],8,Fa),[[S,d.status]])])]),e("div",Xa,[e("div",null,[e("label",Wa,r(t(f)("trafficType",t(o))),1),_(e("select",{"onUpdate:modelValue":c[4]||(c[4]=s=>d.trafficType=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Ja,r(t(f)("organic",t(o))),1),e("option",Ka,r(t(f)("paid",t(o))),1)],8,Ya),[[S,d.trafficType]])])]),d.status==="IN_PRODUCTION"?(l(),i("div",Qa,[e("div",null,[e("label",Za,r(t(f)("productionStartDate",t(o))),1),_(e("input",{"onUpdate:modelValue":c[5]||(c[5]=s=>d.productionStartDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,er),[[z,d.productionStartDate]])]),e("div",null,[e("label",tr,r(t(f)("productionEndDate",t(o))),1),_(e("input",{"onUpdate:modelValue":c[6]||(c[6]=s=>d.productionEndDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,ar),[[z,d.productionEndDate]])])])):D("",!0),d.status==="POSTED"?(l(),i("div",rr,[e("label",sr,r(t(f)("metaAdsId",t(o))),1),_(e("input",{"onUpdate:modelValue":c[7]||(c[7]=s=>d.metaAdsId=s),type:"text",disabled:a.isTransforming,placeholder:t(f)("enterMetaAdsId",t(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,or),[[z,d.metaAdsId]])])):D("",!0),e("div",null,[e("label",dr,r(t(f)("channels",t(o)))+" * ",1),e("div",lr,[(l(!0),i(I,null,T(t(g),s=>(l(),i("div",{key:s.id,class:"flex items-center"},[_(e("input",{id:`channel-${s.id}`,type:"checkbox",value:s.id,"onUpdate:modelValue":c[8]||(c[8]=u=>d.channelIds=u),disabled:a.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,nr),[[Me,d.channelIds]]),e("label",{for:`channel-${s.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},r(s.name),9,ir)]))),128))]),d.channelIds.length===0?(l(),i("p",cr,r(t(f)("selectAtLeastOneChannel",t(o))),1)):D("",!0)])],32)]),e("div",ur,[e("button",{onClick:c[10]||(c[10]=s=>x.$emit("cancel")),disabled:a.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,gr),e("button",{onClick:c[11]||(c[11]=s=>x.$emit("confirm",q())),disabled:a.isTransforming||d.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isTransforming?(l(),A(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(l(),A(t(oe),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isTransforming?t(f)("transforming",t(o)):t(f)("transform",t(o))),1)],8,yr)])])])]))}},br={class:"space-y-6"},mr={class:"flex justify-between items-center"},xr={class:"text-2xl font-bold text-gray-900 dark:text-white"},hr={key:0},pr={key:0,class:"space-y-6"},vr={class:"flex space-x-4"},kr={class:"overflow-x-auto"},wr={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},$r={class:"bg-gray-50 dark:bg-gray-700"},Dr={class:"px-6 py-3 text-left"},_r={class:"px-6 py-3 text-left"},Cr={class:"px-6 py-3 text-left"},Ir={class:"px-6 py-3 text-left"},Tr={class:"px-6 py-3 text-left"},Pr={class:"px-6 py-3 text-right"},Sr={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Nr={class:"px-6 py-4"},Er={class:"px-6 py-4"},Ar={class:"px-6 py-4"},Or={class:"px-6 py-4"},Ur={class:"flex items-center space-x-2"},Vr={class:"px-6 py-4"},jr={class:"px-6 py-4"},Rr={class:"flex items-center justify-end space-x-2"},Mr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Fr={class:"text-red-600"},qr={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Gr={class:"text-green-600"},Lr={key:3,class:"flex space-x-4"},Br={value:""},zr=["value"],Hr={value:""},Xr=["value"],Wr={value:""},Yr=["value"],Jr={key:4},Kr={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},Qr={class:"text-sm text-gray-600 dark:text-gray-400"},Zr={class:"flex items-center space-x-2"},es=["disabled"],ts=["disabled"],ys={__name:"DraftManager",setup(a){const{language:o}=le(),{currentUser:g}=Fe(),{drafts:n,users:N,products:v,loadingDrafts:k,errors:O,fetchDrafts:F,fetchUsers:d,fetchChannels:H,fetchProducts:R,createDraft:q,updateDraft:x,deleteDraft:c,transformDraftToContent:s}=he(),u=y=>f(y,o.value),m=["Post","Story","Reels","Video","Artigo"],E=["PENDING","APPROVED","NOT_APPROVED"],U=w(!1),P=w(null),V=w(""),G=w(""),W=w(""),ae=me({name:"",type:"",content:"",productId:"",status:"PENDING"}),Y=w(!1),M=w(""),J=w(!0),K=w(!1),Q=w(!1),L=w(null),B=w(null),re=w(!1),se=w(!1),C=w(0),ve=w(15),X=w(1),Z=w(0);xe(async()=>{await Promise.all([d(),H(),R()]),await j(),J.value=!1}),te(V,async()=>{C.value=0,await j()}),te(W,async()=>{C.value=0,await j()});const ke=ee(()=>!n.value||!g.value?[]:n.value),we=ee(()=>ke.value.filter(y=>!(V.value&&y.status!==V.value||G.value&&y.type!==G.value))),$e=ee(()=>we.value),De=ee(()=>C.value+1),j=async()=>{const y=await F({status:V.value||void 0,productId:W.value||void 0,page:C.value,size:ve.value});y&&typeof y=="object"&&(typeof y.totalPages=="number"&&(X.value=y.totalPages),typeof y.totalElements=="number"&&(Z.value=y.totalElements))},_e=async()=>{C.value!==0&&(C.value-=1,await j())},Ce=async()=>{C.value>=X.value-1||(C.value+=1,await j())};async function ie(){C.value=0,await j()}async function Ie(y){if(!Y.value){Y.value=!0,M.value="";try{let p;if(P.value)p=await x(P.value.id,y);else{const h={...y,creatorId:g.value.id,status:y.status||"PENDING"};p=await q(h)}p.success?(M.value=P.value?u("draftUpdatedSuccessfully"):u("draftCreatedSuccessfully"),ce(),await j()):console.error("Error:",p.error)}catch(p){console.error("Unexpected error:",p)}finally{Y.value=!1}}}function Te(y){P.value=y,Object.assign(ae,{name:y.name,type:y.type,content:y.content||"",productId:y.productId||"",status:y.status}),U.value=!0}function ce(){U.value=!1,P.value=null,Object.assign(ae,{name:"",type:"",content:"",productId:"",status:"PENDING"}),M.value=""}async function Pe(y){L.value=y,K.value=!0}async function Se(){if(L.value){re.value=!0;try{const y=await c(L.value.id);y.success?(M.value=u("draftDeletedSuccessfully"),K.value=!1,L.value=null):console.error("Error:",y.error)}catch(y){console.error("Unexpected error:",y)}finally{re.value=!1}}}function Ne(){K.value=!1,L.value=null}async function Ee(y){B.value=y,Q.value=!0}async function Ae(y){if(B.value){se.value=!0;try{const p=await s(B.value.id,y);p.success?(M.value=u("draftTransformed"),Q.value=!1,B.value=null,await j()):console.error("Error:",p.error)}catch(p){console.error("Unexpected error:",p)}finally{se.value=!1}}}function Oe(){Q.value=!1,B.value=null}function Ue(y){return g.value?g.value.adminType==="ADMIN"||y.creatorId===g.value.id:!1}return(y,p)=>(l(),i("div",br,[e("div",mr,[e("h2",xr,[ge(r(u("drafts",t(o)))+" ",1),Z.value?(l(),i("span",hr,"("+r(Z.value)+")",1)):D("",!0)]),e("button",{onClick:p[0]||(p[0]=h=>U.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[b(t(ze),{class:"w-4 h-4 mr-2"}),ge(" "+r(u("newDraft",t(o))),1)])]),t(k)||J.value?(l(),i("div",pr,[e("div",vr,[b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"})]),e("div",kr,[e("table",wr,[e("thead",$r,[e("tr",null,[e("th",Dr,[b($,{customClass:"h-4 w-16"})]),e("th",_r,[b($,{customClass:"h-4 w-12"})]),e("th",Cr,[b($,{customClass:"h-4 w-20"})]),e("th",Ir,[b($,{customClass:"h-4 w-16"})]),e("th",Tr,[b($,{customClass:"h-4 w-20"})]),e("th",Pr,[b($,{customClass:"h-4 w-16"})])])]),e("tbody",Sr,[(l(),i(I,null,T(6,h=>e("tr",{key:h},[e("td",Nr,[b($,{customClass:"h-4 w-32 shimmer"})]),e("td",Er,[b($,{customClass:"h-4 w-16 shimmer"})]),e("td",Ar,[b($,{customClass:"h-4 w-24 shimmer"})]),e("td",Or,[e("div",Ur,[b($,{customClass:"h-4 w-4 rounded-full shimmer"}),b($,{customClass:"h-4 w-20 shimmer"})])]),e("td",Vr,[b($,{customClass:"h-4 w-24 shimmer"})]),e("td",jr,[e("div",Rr,[b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):t(O).drafts?(l(),i("div",Mr,[e("p",Fr,r(t(O).drafts),1)])):D("",!0),M.value?(l(),i("div",qr,[e("p",Gr,r(M.value),1)])):D("",!0),!t(k)&&!J.value?(l(),i("div",Lr,[_(e("select",{"onUpdate:modelValue":p[1]||(p[1]=h=>V.value=h),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Br,r(u("allStatuses",t(o))),1),(l(),i(I,null,T(E,h=>e("option",{key:h,value:h},r(u(h.toLowerCase(),t(o))),9,zr)),64))],544),[[S,V.value]]),_(e("select",{"onUpdate:modelValue":p[2]||(p[2]=h=>G.value=h),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Hr,r(u("allTypes",t(o))),1),(l(),i(I,null,T(m,h=>e("option",{key:h,value:h},r(h),9,Xr)),64))],512),[[S,G.value]]),_(e("select",{"onUpdate:modelValue":p[3]||(p[3]=h=>W.value=h),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Wr,r(u("allProducts",t(o))),1),(l(!0),i(I,null,T(t(v),h=>(l(),i("option",{key:h.id,value:h.id},r(h.name),9,Yr))),128))],544),[[S,W.value]])])):D("",!0),b(ht,{show:U.value,editingDraft:P.value,user:t(g),formData:ae,isSubmitting:Y.value,contentTypes:m,draftStatuses:E,products:t(v),t:u,language:t(o),onSubmit:Ie,onCancel:ce},null,8,["show","editingDraft","user","formData","isSubmitting","products","language"]),!t(k)&&!J.value?(l(),i("div",Jr,[b(Jt,{filteredDrafts:$e.value,users:t(N),products:t(v),t:u,language:t(o),canEdit:Ue,onEdit:Te,onDelete:Pe,onTransform:Ee},null,8,["filteredDrafts","users","products","language"]),X.value>1?(l(),i("div",Kr,[e("div",Qr,r(u("page",t(o)))+" "+r(De.value)+" / "+r(X.value)+" · "+r(Z.value)+" "+r(u("items",t(o))),1),e("div",Zr,[e("button",{onClick:_e,disabled:C.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(u("previous",t(o))),9,es),e("button",{onClick:Ce,disabled:C.value>=X.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(u("next",t(o))),9,ts)])])):D("",!0)])):D("",!0),K.value?(l(),A(ya,{key:5,draft:L.value,"is-deleting":re.value,onConfirm:Se,onCancel:Ne},null,8,["draft","is-deleting"])):D("",!0),Q.value?(l(),A(fr,{key:6,draft:B.value,"is-transforming":se.value,onConfirm:Ae,onCancel:Oe},null,8,["draft","is-transforming"])):D("",!0)]))}};export{ys as default};
