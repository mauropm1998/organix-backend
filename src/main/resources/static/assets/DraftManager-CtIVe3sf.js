import{c as ce,m as ue,z as ae,A as K,a as c,o as n,b as t,t as s,u as e,f as $,g as I,v as q,B as F,q as A,s as V,h as O,F as Q,w as ge,n as de,C as Oe,p as y,d as g,e as re,x as me,D as Ae,r as T,y as J,l as Ve,j as le}from"./index-DSC5aajj.js";import{u as ye}from"./useData-X35BpfxY.js";import{_ as D}from"./SkeletonLoader-CIXQH23B.js";import{L as oe}from"./loader-circle-CYsQVaGS.js";import{A as se}from"./arrow-right-DoO7dDgM.js";import{S as Ue}from"./square-pen-Blli_rXZ.js";import{T as fe,a as je}from"./triangle-alert-5dX33MnO.js";import{C as Me}from"./circle-check-big-_orI_cBH.js";import{P as Fe}from"./plus-J_RR_41C.js";import"./userService-DmCT3zp9.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=ce("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=ce("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Le={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Be={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},He={value:""},We=["value"],Xe={key:0},Ye={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Je=["value"],Ke={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Qe=["placeholder"],Ze={class:"flex space-x-3"},et=["disabled"],tt=["disabled"],st={__name:"DraftForm",props:{user:Object,editingDraft:Object,t:Function,language:String,contentTypes:Array,draftStatuses:Array,show:Boolean,formData:Object,isSubmitting:Boolean},emits:["submit","cancel"],setup(m,{emit:o}){const v=m,k=o,{user:p,editingDraft:h,t:b,language:x,contentTypes:U,draftStatuses:r,show:R,isSubmitting:P}=ue(v),l=ae({...v.formData});K(()=>v.editingDraft,d=>{d?Object.assign(l,d):Object.assign(l,{name:"",type:"",content:"",status:"pending"})});function u(){k("submit",{...l})}function a(){k("cancel")}return(d,w)=>(n(),c("div",Le,[t("h3",Be,s(e(h)?e(b)("editDraft",e(x)):e(b)("createNewDraft",e(x))),1),t("form",{onSubmit:ge(u,["prevent"]),class:"space-y-4"},[t("div",Ge,[t("div",null,[t("label",qe,s(e(b)("name",e(x))),1),I(t("input",{type:"text","onUpdate:modelValue":w[0]||(w[0]=f=>l.name=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,512),[[q,l.name]])]),t("div",null,[t("label",ze,s(e(b)("type",e(x))),1),I(t("select",{"onUpdate:modelValue":w[1]||(w[1]=f=>l.type=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},[t("option",He,s(e(b)("type",e(x))),1),(n(!0),c(A,null,V(e(U),f=>(n(),c("option",{key:f,value:f},s(f),9,We))),128))],512),[[F,l.type]])])]),e(p).adminType==="ADMIN"?(n(),c("div",Xe,[t("label",Ye,s(e(b)("status",e(x))),1),I(t("select",{"onUpdate:modelValue":w[2]||(w[2]=f=>l.status=f),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"},[(n(!0),c(A,null,V(e(r),f=>(n(),c("option",{key:f,value:f},s(e(b)(f,e(x))),9,Je))),128))],512),[[F,l.status]])])):$("",!0),t("div",null,[t("label",Ke,s(e(b)("draftContent",e(x))),1),I(t("textarea",{"onUpdate:modelValue":w[3]||(w[3]=f=>l.content=f),rows:"6",placeholder:e(b)("enterDraftContent",e(x)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",required:""},null,8,Qe),[[q,l.content]])]),t("div",Ze,[t("button",{type:"submit",disabled:e(P),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e(P)?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(Q),{key:1,class:"w-4 h-4"})),t("span",null,s(e(P)?e(h)?e(b)("updatingDraft",e(x)):e(b)("creatingDraft",e(x)):e(h)?e(b)("update",e(x)):e(b)("create",e(x)))+" "+s(e(P)?"":e(b)("draft",e(x))),1)],8,et),t("button",{type:"button",onClick:a,disabled:e(P),class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 disabled:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(b)("cancel",e(x))),9,tt)])],32)]))}},at={class:"overflow-x-auto"},rt={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},ot={class:"bg-gray-50 dark:bg-gray-700"},nt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},lt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},it={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},ut={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},gt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},mt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"text-sm font-medium text-gray-900 dark:text-white"},ft={class:"px-6 py-4 whitespace-nowrap"},bt={class:"text-sm text-gray-600 dark:text-gray-400"},pt={class:"px-6 py-4 whitespace-nowrap"},ht={class:"text-sm text-gray-600 dark:text-gray-400"},xt={class:"px-6 py-4 whitespace-nowrap"},vt={class:"flex items-center space-x-2"},_t={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm text-gray-600 dark:text-gray-400"},wt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Dt={class:"flex items-center justify-end space-x-2"},$t=["onClick","title"],Ct=["onClick","title"],Tt=["onClick","title"],It={key:0,class:"text-center py-12"},Pt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},St={class:"text-gray-600 dark:text-gray-400"},Et={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(m){const o=m,{filteredDrafts:v,users:k,t:p,language:h,canEdit:b}=ue(o);function x(l){const u=k.value.find(a=>a.id===l);return u?u.name:"Unknown"}function U(l){return l==="APPROVED"?Me:l==="PENDING"?ie:l==="NOT_APPROVED"?Re:ie}function r(l){return l==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":l==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":l==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function R(l){return l==="APPROVED"?"text-green-500 dark:text-green-400":l==="PENDING"?"text-yellow-500 dark:text-yellow-400":l==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function P(l){if(!l)return"";try{let u;if(Array.isArray(l)&&l.length>=3){const[a,d,w,f=0,S=0,E=0]=l;u=new Date(a,d-1,w,f,S,E)}else if(typeof l=="string")u=new Date(l);else if(l instanceof Date)u=l;else return"Data inválida";return!(u instanceof Date)||isNaN(u.getTime())?"Data inválida":u.toLocaleDateString()}catch{return"Data inválida"}}return(l,u)=>(n(),c("div",at,[t("table",rt,[t("thead",ot,[t("tr",null,[t("th",nt,s(e(p)("name",e(h))),1),t("th",dt,s(e(p)("type",e(h))),1),t("th",lt,s(e(p)("creator",e(h))),1),t("th",it,s(e(p)("status",e(h))),1),t("th",ct,s(e(p)("created",e(h))),1),t("th",ut,s(e(p)("actions",e(h))),1)])]),t("tbody",gt,[(n(!0),c(A,null,V(e(v),a=>(n(),c("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",mt,[t("div",yt,s(a.name),1)]),t("td",ft,[t("div",bt,s(a.type),1)]),t("td",pt,[t("div",ht,s(x(a.creatorId)),1)]),t("td",xt,[t("div",vt,[(n(),O(Oe(U(a.status)),{class:de(["w-4 h-4",R(a.status)])},null,8,["class"])),t("span",{class:de(r(a.status))},s(e(p)(a.status?.toLowerCase()||"draft",e(h))),3)])]),t("td",_t,[t("div",kt,s(P(a.createdAt)),1)]),t("td",wt,[t("div",Dt,[a.status==="APPROVED"&&e(b)(a)?(n(),c("button",{key:0,onClick:d=>l.$emit("transform",a),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:e(p)("transformToContent",e(h))},[y(e(se),{class:"w-4 h-4"})],8,$t)):$("",!0),e(b)(a)?(n(),c("button",{key:1,onClick:d=>l.$emit("edit",a),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:e(p)("editDraft",e(h))},[y(e(Ue),{class:"w-4 h-4"})],8,Ct)):$("",!0),e(b)(a)?(n(),c("button",{key:2,onClick:d=>l.$emit("delete",a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:e(p)("deleteDraft",e(h))},[y(e(fe),{class:"w-4 h-4"})],8,Tt)):$("",!0)])])]))),128))])]),e(v).length?$("",!0):(n(),c("div",It,[y(e(Q),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",Pt,s(e(p)("noDraftsFound",e(h))),1),t("p",St,s(e(p)("createFirstDraft",e(h))),1)]))]))}},Nt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Ot={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},At={class:"p-6"},Vt={class:"flex items-center mb-4"},Ut={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},jt={class:"text-lg font-medium text-gray-900 dark:text-white"},Mt={class:"mb-6"},Ft={class:"text-gray-600 dark:text-gray-400"},Rt={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},Lt={class:"flex items-center"},Bt={class:"min-w-0 flex-1"},Gt={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},qt={class:"text-xs text-gray-500 dark:text-gray-400"},zt={class:"flex space-x-3 justify-end"},Ht=["disabled"],Wt=["disabled"],Xt={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:o}=re();return(v,k)=>(n(),c("div",Nt,[t("div",Ot,[t("div",At,[t("div",Vt,[t("div",Ut,[y(e(je),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),t("div",null,[t("h3",jt,s(e(g)("confirmDeletion",e(o))),1)])]),t("div",Mt,[t("p",Ft,s(e(g)("confirmDeleteDraft",e(o))),1),t("div",Rt,[t("div",Lt,[y(e(Q),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",Bt,[t("span",Gt,s(m.draft?.name),1),t("span",qt,s(m.draft?.type)+" • "+s(e(g)(m.draft?.status?.toLowerCase()||"draft",e(o))),1)])])])]),t("div",zt,[t("button",{onClick:k[0]||(k[0]=p=>v.$emit("cancel")),disabled:m.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(g)("cancel",e(o))),9,Ht),t("button",{onClick:k[1]||(k[1]=p=>v.$emit("confirm")),disabled:m.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isDeleting?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(fe),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isDeleting?e(g)("deleting",e(o)):e(g)("delete",e(o))),1)],8,Wt)])])])]))}},Yt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Jt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},Kt={class:"p-6"},Qt={class:"flex items-center mb-4"},Zt={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},es={class:"text-lg font-medium text-gray-900 dark:text-white"},ts={class:"mb-6"},ss={class:"text-gray-600 dark:text-gray-400 mb-4"},as={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},rs={class:"flex items-center"},os={class:"min-w-0 flex-1"},ns={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ds={class:"text-xs text-gray-500 dark:text-gray-400"},ls={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},is={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},cs=["disabled"],us={value:""},gs=["value"],ms={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ys=["disabled"],fs={value:""},bs=["value"],ps={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},hs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},xs=["disabled"],vs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},_s=["disabled"],ks={value:"PENDING"},ws={value:"IN_PRODUCTION"},Ds={value:"POSTED"},$s={value:"FINISHED"},Cs={value:"CANCELED"},Ts={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Is={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ps=["disabled"],Ss={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Es=["disabled"],Ns={key:1},Os={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},As=["disabled","placeholder"],Vs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Us={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},js=["id","value","disabled"],Ms=["for"],Fs={key:0,class:"text-xs text-red-500 mt-1"},Rs={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},Ls=["disabled"],Bs=["disabled"],Gs={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(m){const{language:o}=re(),{channels:v,products:k,users:p,fetchChannels:h,fetchProducts:b,fetchUsers:x}=ye(),U=m,r=ae({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:""});K(()=>r.status,u=>{u!=="IN_PRODUCTION"&&(r.productionStartDate="",r.productionEndDate=""),u!=="POSTED"&&(r.metaAdsId="")}),me(async()=>{await Promise.all([v.value&&v.value.length>0?Promise.resolve():h(),k.value&&k.value.length>0?Promise.resolve():b(),p.value&&p.value.length>0?Promise.resolve():x()])}),K(()=>U.draft,()=>{r.status="PENDING",r.channelIds=[],r.productId="",r.producerId="",r.postDate="",r.productionStartDate="",r.productionEndDate="",r.metaAdsId=""},{immediate:!0});const R=u=>{if(!u)return"";const a=g(`contentTypes.${u}`,o.value);return a.startsWith("contentTypes.")?u:a},P=u=>{if(!u)return;const a=new Date(u),d=a.getFullYear(),w=String(a.getMonth()+1).padStart(2,"0"),f=String(a.getDate()).padStart(2,"0"),S=String(a.getHours()).padStart(2,"0"),E=String(a.getMinutes()).padStart(2,"0"),L=String(a.getSeconds()).padStart(2,"0");return`${d}-${w}-${f}T${S}:${E}:${L}`},l=()=>{const u={status:r.status,channelIds:r.channelIds,productId:r.productId||null,producerId:r.producerId||null,postDate:P(r.postDate)};return r.status==="IN_PRODUCTION"&&(u.productionStartDate=P(r.productionStartDate),u.productionEndDate=P(r.productionEndDate)),r.status==="POSTED"&&(u.metaAdsId=r.metaAdsId||null),u};return(u,a)=>(n(),c("div",Yt,[t("div",Jt,[t("div",Kt,[t("div",Qt,[t("div",Zt,[y(e(se),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),t("div",null,[t("h3",es,s(e(g)("transformDraft",e(o))),1)])]),t("div",ts,[t("p",ss,s(e(g)("transformDraftDescription",e(o))),1),t("div",as,[t("div",rs,[y(e(Q),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),t("div",os,[t("span",ns,s(m.draft?.name),1),t("span",ds,s(R(m.draft?.type)),1)])])]),t("form",{onSubmit:a[8]||(a[8]=ge(d=>u.$emit("confirm",l()),["prevent"])),class:"space-y-4"},[t("div",ls,[t("div",null,[t("label",is,s(e(g)("product",e(o))),1),I(t("select",{"onUpdate:modelValue":a[0]||(a[0]=d=>r.productId=d),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",us,s(e(g)("selectProduct",e(o))),1),(n(!0),c(A,null,V(e(k),d=>(n(),c("option",{key:d.id,value:d.id},s(d.name),9,gs))),128))],8,cs),[[F,r.productId]])]),t("div",null,[t("label",ms,s(e(g)("producer",e(o))),1),I(t("select",{"onUpdate:modelValue":a[1]||(a[1]=d=>r.producerId=d),disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",fs,s(e(g)("selectProducer",e(o))),1),(n(!0),c(A,null,V(e(p),d=>(n(),c("option",{key:d.id,value:d.id},s(d.name),9,bs))),128))],8,ys),[[F,r.producerId]])])]),t("div",ps,[t("div",null,[t("label",hs,s(e(g)("postDate",e(o))),1),I(t("input",{"onUpdate:modelValue":a[2]||(a[2]=d=>r.postDate=d),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,xs),[[q,r.postDate]])]),t("div",null,[t("label",vs,s(e(g)("status",e(o))),1),I(t("select",{"onUpdate:modelValue":a[3]||(a[3]=d=>r.status=d),required:"",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[t("option",ks,s(e(g)("pending",e(o))),1),t("option",ws,s(e(g)("in_production",e(o))),1),t("option",Ds,s(e(g)("posted",e(o))),1),t("option",$s,s(e(g)("finished",e(o))),1),t("option",Cs,s(e(g)("canceled",e(o))),1)],8,_s),[[F,r.status]])])]),r.status==="IN_PRODUCTION"?(n(),c("div",Ts,[t("div",null,[t("label",Is,s(e(g)("productionStartDate",e(o))),1),I(t("input",{"onUpdate:modelValue":a[4]||(a[4]=d=>r.productionStartDate=d),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ps),[[q,r.productionStartDate]])]),t("div",null,[t("label",Ss,s(e(g)("productionEndDate",e(o))),1),I(t("input",{"onUpdate:modelValue":a[5]||(a[5]=d=>r.productionEndDate=d),type:"datetime-local",disabled:m.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Es),[[q,r.productionEndDate]])])])):$("",!0),r.status==="POSTED"?(n(),c("div",Ns,[t("label",Os,s(e(g)("metaAdsId",e(o))),1),I(t("input",{"onUpdate:modelValue":a[6]||(a[6]=d=>r.metaAdsId=d),type:"text",disabled:m.isTransforming,placeholder:e(g)("enterMetaAdsId",e(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,As),[[q,r.metaAdsId]])])):$("",!0),t("div",null,[t("label",Vs,s(e(g)("channels",e(o)))+" * ",1),t("div",Us,[(n(!0),c(A,null,V(e(v),d=>(n(),c("div",{key:d.id,class:"flex items-center"},[I(t("input",{id:`channel-${d.id}`,type:"checkbox",value:d.id,"onUpdate:modelValue":a[7]||(a[7]=w=>r.channelIds=w),disabled:m.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,js),[[Ae,r.channelIds]]),t("label",{for:`channel-${d.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},s(d.name),9,Ms)]))),128))]),r.channelIds.length===0?(n(),c("p",Fs,s(e(g)("selectAtLeastOneChannel",e(o))),1)):$("",!0)])],32)]),t("div",Rs,[t("button",{onClick:a[9]||(a[9]=d=>u.$emit("cancel")),disabled:m.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},s(e(g)("cancel",e(o))),9,Ls),t("button",{onClick:a[10]||(a[10]=d=>u.$emit("confirm",l())),disabled:m.isTransforming||r.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.isTransforming?(n(),O(e(oe),{key:0,class:"w-4 h-4 animate-spin"})):(n(),O(e(se),{key:1,class:"w-4 h-4"})),t("span",null,s(m.isTransforming?e(g)("transforming",e(o)):e(g)("transform",e(o))),1)],8,Bs)])])])]))}},qs={class:"space-y-6"},zs={class:"flex justify-between items-center"},Hs={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ws={key:0},Xs={key:0,class:"space-y-6"},Ys={class:"flex space-x-4"},Js={class:"overflow-x-auto"},Ks={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},Qs={class:"bg-gray-50 dark:bg-gray-700"},Zs={class:"px-6 py-3 text-left"},ea={class:"px-6 py-3 text-left"},ta={class:"px-6 py-3 text-left"},sa={class:"px-6 py-3 text-left"},aa={class:"px-6 py-3 text-left"},ra={class:"px-6 py-3 text-right"},oa={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},na={class:"px-6 py-4"},da={class:"px-6 py-4"},la={class:"px-6 py-4"},ia={class:"px-6 py-4"},ca={class:"flex items-center space-x-2"},ua={class:"px-6 py-4"},ga={class:"px-6 py-4"},ma={class:"flex items-center justify-end space-x-2"},ya={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},fa={class:"text-red-600"},ba={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},pa={class:"text-green-600"},ha={key:3,class:"flex space-x-4"},xa={value:""},va=["value"],_a={value:""},ka=["value"],wa={key:5},Da={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},$a={class:"text-sm text-gray-600 dark:text-gray-400"},Ca={class:"flex items-center space-x-2"},Ta=["disabled"],Ia=["disabled"],Fa={__name:"DraftManager",setup(m){const{language:o}=re(),{currentUser:v}=Ve(),{drafts:k,users:p,loadingDrafts:h,errors:b,fetchDrafts:x,fetchUsers:U,fetchChannels:r,createDraft:R,updateDraft:P,deleteDraft:l,transformDraftToContent:u}=ye(),a=i=>g(i,o.value),d=["Post","Story","Reels","Video","Artigo"],w=["PENDING","APPROVED","NOT_APPROVED"],f=T(!1),S=T(null),E=T(""),L=T(""),Z=ae({name:"",type:"",content:"",status:"PENDING"}),H=T(!1),j=T(""),W=T(!1),X=T(!1),B=T(null),G=T(null),ee=T(!1),te=T(!1),N=T(0),be=T(6),z=T(1),Y=T(0);me(async()=>{k.value=[],await Promise.all([U(),r()]),await M()}),K(E,async()=>{N.value=0,await M()});const pe=J(()=>!k.value||!v.value?[]:k.value),he=J(()=>pe.value.filter(i=>!(E.value&&i.status!==E.value||L.value&&i.type!==L.value))),xe=J(()=>he.value),ve=J(()=>N.value+1),M=async()=>{const i=await x({status:E.value||void 0,page:N.value,size:be.value});i&&typeof i=="object"&&(typeof i.totalPages=="number"&&(z.value=i.totalPages),typeof i.totalElements=="number"&&(Y.value=i.totalElements))},_e=async()=>{N.value!==0&&(N.value-=1,await M())},ke=async()=>{N.value>=z.value-1||(N.value+=1,await M())};async function we(){N.value=0,await M()}async function De(i){if(!H.value){H.value=!0,j.value="";try{let _;if(S.value)_=await P(S.value.id,i);else{const C={...i,creatorId:v.value.id,status:i.status||"PENDING"};_=await R(C)}_.success?(j.value=S.value?a("draftUpdatedSuccessfully"):a("draftCreatedSuccessfully"),ne(),await M()):console.error("Error:",_.error)}catch(_){console.error("Unexpected error:",_)}finally{H.value=!1}}}function $e(i){S.value=i,Object.assign(Z,{name:i.name,type:i.type,content:i.content||"",status:i.status}),f.value=!0}function ne(){f.value=!1,S.value=null,Object.assign(Z,{name:"",type:"",content:"",status:"PENDING"}),j.value=""}async function Ce(i){B.value=i,W.value=!0}async function Te(){if(B.value){ee.value=!0;try{const i=await l(B.value.id);i.success?(j.value=a("draftDeletedSuccessfully"),W.value=!1,B.value=null):console.error("Error:",i.error)}catch(i){console.error("Unexpected error:",i)}finally{ee.value=!1}}}function Ie(){W.value=!1,B.value=null}async function Pe(i){G.value=i,X.value=!0}async function Se(i){if(G.value){te.value=!0;try{const _=await u(G.value.id,i);_.success?(j.value=a("draftTransformed"),X.value=!1,G.value=null,await M()):console.error("Error:",_.error)}catch(_){console.error("Unexpected error:",_)}finally{te.value=!1}}}function Ee(){X.value=!1,G.value=null}function Ne(i){return v.value?v.value.adminType==="ADMIN"||i.creatorId===v.value.id:!1}return(i,_)=>(n(),c("div",qs,[t("div",zs,[t("h2",Hs,[le(s(a("drafts",e(o)))+" ",1),Y.value?(n(),c("span",Ws,"("+s(Y.value)+")",1)):$("",!0)]),t("button",{onClick:_[0]||(_[0]=C=>f.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[y(e(Fe),{class:"w-4 h-4 mr-2"}),le(" "+s(a("newDraft",e(o))),1)])]),e(h)?(n(),c("div",Xs,[t("div",Ys,[y(D,{customClass:"h-10 w-32"}),y(D,{customClass:"h-10 w-32"})]),t("div",Js,[t("table",Ks,[t("thead",Qs,[t("tr",null,[t("th",Zs,[y(D,{customClass:"h-4 w-16"})]),t("th",ea,[y(D,{customClass:"h-4 w-12"})]),t("th",ta,[y(D,{customClass:"h-4 w-20"})]),t("th",sa,[y(D,{customClass:"h-4 w-16"})]),t("th",aa,[y(D,{customClass:"h-4 w-20"})]),t("th",ra,[y(D,{customClass:"h-4 w-16"})])])]),t("tbody",oa,[(n(),c(A,null,V(6,C=>t("tr",{key:C},[t("td",na,[y(D,{customClass:"h-4 w-32 shimmer"})]),t("td",da,[y(D,{customClass:"h-4 w-16 shimmer"})]),t("td",la,[y(D,{customClass:"h-4 w-24 shimmer"})]),t("td",ia,[t("div",ca,[y(D,{customClass:"h-4 w-4 rounded-full shimmer"}),y(D,{customClass:"h-4 w-20 shimmer"})])]),t("td",ua,[y(D,{customClass:"h-4 w-24 shimmer"})]),t("td",ga,[t("div",ma,[y(D,{customClass:"h-8 w-8 rounded shimmer"}),y(D,{customClass:"h-8 w-8 rounded shimmer"}),y(D,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):e(b).drafts?(n(),c("div",ya,[t("p",fa,s(e(b).drafts),1)])):$("",!0),j.value?(n(),c("div",ba,[t("p",pa,s(j.value),1)])):$("",!0),e(h)?$("",!0):(n(),c("div",ha,[I(t("select",{"onUpdate:modelValue":_[1]||(_[1]=C=>E.value=C),onChange:we,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",xa,s(a("allStatuses",e(o))),1),(n(),c(A,null,V(w,C=>t("option",{key:C,value:C},s(a(C.toLowerCase(),e(o))),9,va)),64))],544),[[F,E.value]]),I(t("select",{"onUpdate:modelValue":_[2]||(_[2]=C=>L.value=C),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t("option",_a,s(a("allTypes",e(o))),1),(n(),c(A,null,V(d,C=>t("option",{key:C,value:C},s(C),9,ka)),64))],512),[[F,L.value]])])),f.value?(n(),O(st,{key:4,user:e(v),editingDraft:S.value,t:a,language:e(o),contentTypes:d,draftStatuses:w,show:f.value,formData:Z,isSubmitting:H.value,onSubmit:De,onCancel:ne},null,8,["user","editingDraft","language","show","formData","isSubmitting"])):$("",!0),e(h)?$("",!0):(n(),c("div",wa,[y(Et,{filteredDrafts:xe.value,users:e(p),t:a,language:e(o),canEdit:Ne,onEdit:$e,onDelete:Ce,onTransform:Pe},null,8,["filteredDrafts","users","language"]),z.value>1?(n(),c("div",Da,[t("div",$a,s(a("page",e(o)))+" "+s(ve.value)+" / "+s(z.value)+" · "+s(Y.value)+" "+s(a("items",e(o))),1),t("div",Ca,[t("button",{onClick:_e,disabled:N.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(a("previous",e(o))),9,Ta),t("button",{onClick:ke,disabled:N.value>=z.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},s(a("next",e(o))),9,Ia)])])):$("",!0)])),W.value?(n(),O(Xt,{key:6,draft:B.value,"is-deleting":ee.value,onConfirm:Te,onCancel:Ie},null,8,["draft","is-deleting"])):$("",!0),X.value?(n(),O(Gs,{key:7,draft:G.value,"is-transforming":te.value,onConfirm:Se,onCancel:Ee},null,8,["draft","is-transforming"])):$("",!0)]))}};export{Fa as default};
