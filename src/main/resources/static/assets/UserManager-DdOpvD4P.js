import{c as j,r as f,C as F,d as _,e as L,a as y,b as t,t as s,g as C,v as E,z as R,h as p,w as I,K as x,o as i,f as w,u as g,p as b,U as N,q as A,s as O,n as z,j as H,y as K,l as W}from"./index-CNz27Lkk.js";import{u as T}from"./userService-C702iV5E.js";import{U as X}from"./user-plus-DEMTyJiC.js";import{L as P}from"./loader-circle-ByVzuIht.js";import{X as G}from"./x-tc_f50AM.js";import{a as J,T as V}from"./triangle-alert-0cpL1EcI.js";import{S as Q}from"./square-pen-DU5hSGYw.js";import{P as Y}from"./plus-DEtPLCxO.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=j("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=j("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),S=(n,r)=>{const a=n.__vccOpts||n;for(const[e,l]of r)a[e]=l;return a},$={name:"UserForm",components:{Loader2:P,UserPlus:X},props:{editingUser:{type:Object,default:null},isLoading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(n,{emit:r}){const{language:a}=L(),e=f({name:"",email:"",password:"",adminType:"OPERATOR"}),l=()=>{e.value={name:"",email:"",password:"",adminType:"OPERATOR"}},c=()=>{const o={...e.value};n.editingUser&&!o.password&&delete o.password,r("submit",o)};return F(()=>n.editingUser,o=>{o?e.value={name:o.name,email:o.email,password:"",adminType:o.adminType}:l()},{immediate:!0}),{formData:e,language:a,t:_,handleSubmit:c}}},ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},te={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},re=["disabled"],oe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},de=["disabled"],le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ie=["disabled","placeholder","required"],ce={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ge=["disabled"],ue={value:"OPERATOR"},me={value:"ADMIN"},ye={class:"flex space-x-3"},xe=["disabled"],he=["disabled"];function be(n,r,a,e,l,c){const o=x("Loader2"),h=x("UserPlus");return i(),y("div",ee,[t("h3",te,s(a.editingUser?e.t("editUser",e.language):e.t("createNewUser",e.language)),1),t("form",{onSubmit:r[5]||(r[5]=I((...d)=>e.handleSubmit&&e.handleSubmit(...d),["prevent"])),class:"space-y-4"},[t("div",ae,[t("div",null,[t("label",se,s(e.t("name",e.language)),1),C(t("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>e.formData.name=d),type:"text",disabled:a.isLoading,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",required:""},null,8,re),[[E,e.formData.name]])]),t("div",null,[t("label",oe,s(e.t("email",e.language)),1),C(t("input",{"onUpdate:modelValue":r[1]||(r[1]=d=>e.formData.email=d),type:"email",disabled:a.isLoading,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",required:""},null,8,de),[[E,e.formData.email]])])]),t("div",le,[t("div",null,[t("label",ne,s(e.t("password",e.language)),1),C(t("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>e.formData.password=d),type:"password",disabled:a.isLoading,placeholder:a.editingUser?"Deixe em branco para manter a senha atual":"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",required:!a.editingUser},null,8,ie),[[E,e.formData.password]])]),t("div",null,[t("label",ce,s(e.t("role",e.language)),1),C(t("select",{"onUpdate:modelValue":r[3]||(r[3]=d=>e.formData.adminType=d),disabled:a.isLoading,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",required:""},[t("option",ue,s(e.t("operator",e.language)),1),t("option",me,s(e.t("admin",e.language)),1)],8,ge),[[R,e.formData.adminType]])])]),t("div",ye,[t("button",{type:"submit",disabled:a.isLoading,class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors space-x-2"},[a.isLoading?(i(),p(o,{key:0,class:"w-4 h-4 animate-spin"})):(i(),p(h,{key:1,class:"w-4 h-4"})),t("span",null,s(a.editingUser?e.t("update",e.language):e.t("create",e.language))+" "+s(e.t("user",e.language)),1)],8,xe),t("button",{type:"button",onClick:r[4]||(r[4]=d=>n.$emit("cancel")),disabled:a.isLoading,class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 disabled:bg-gray-200 text-gray-700 rounded-lg transition-colors"},s(e.t("cancel",e.language)),9,he)])],32)])}const _e=S($,[["render",be]]),fe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full transform transition-all duration-300 scale-100"},ke={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},pe={class:"flex items-center justify-between"},ve={class:"text-lg font-semibold text-gray-900 dark:text-white"},we=["disabled"],Ue={class:"px-6 py-4"},De={class:"flex items-center space-x-3 mb-4"},Ce={class:"flex-shrink-0"},Te={class:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center"},Le={class:"flex-1"},Me={class:"text-sm text-gray-900 dark:text-white"},Ee={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},Se={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-4"},Ae={class:"flex items-center space-x-3"},Oe={class:"w-8 h-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center"},je={class:"text-sm font-medium text-gray-900 dark:text-white"},Fe={class:"text-xs text-gray-500 dark:text-gray-400"},Ie={class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"},Ne=["disabled"],Pe=["disabled"],Ve={__name:"DeleteUserModal",props:{isOpen:{type:Boolean,required:!0},user:{type:Object,default:null}},emits:["close","deleted"],setup(n,{emit:r}){const{language:a}=L(),e=n,l=r,c=f(!1),o=()=>{c.value||l("close")},h=async()=>{if(!(!e.user||c.value)){c.value=!0;try{await T.deleteUser(e.user.id),l("deleted",e.user.id),l("close")}catch(d){console.error("Error deleting user:",d)}finally{c.value=!1}}};return(d,v)=>n.isOpen?(i(),y("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:I(o,["self"])},[t("div",fe,[t("div",ke,[t("div",pe,[t("h3",ve,s(g(_)("confirmDelete",g(a))),1),t("button",{onClick:o,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",disabled:c.value},[b(g(G),{class:"w-5 h-5"})],8,we)])]),t("div",Ue,[t("div",De,[t("div",Ce,[t("div",Te,[b(g(J),{class:"w-5 h-5 text-red-600 dark:text-red-400"})])]),t("div",Le,[t("p",Me,s(g(_)("deleteUserConfirmation",g(a))),1),t("p",Ee,s(g(_)("deleteUserWarning",g(a))),1)])]),t("div",Se,[t("div",Ae,[t("div",Oe,[b(g(q),{class:"w-4 h-4 text-gray-600 dark:text-gray-300"})]),t("div",null,[t("p",je,s(n.user?.name),1),t("p",Fe,s(n.user?.email),1)])])])]),t("div",Ie,[t("button",{onClick:o,disabled:c.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},s(g(_)("cancel",g(a))),9,Ne),t("button",{onClick:h,disabled:c.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2"},[c.value?(i(),p(g(P),{key:0,class:"w-4 h-4 animate-spin"})):(i(),p(g(V),{key:1,class:"w-4 h-4"})),t("span",null,s(c.value?g(_)("deleting",g(a)):g(_)("delete",g(a))),1)],8,Pe)])])])):w("",!0)}},qe={name:"UserTable",components:{Users:N,Shield:Z,UserIcon:q,Edit:Q,Trash2:V,DeleteUserModal:Ve},props:{users:{type:Array,default:()=>[]},currentUser:{type:Object,default:null},isLoading:{type:Boolean,default:!1}},emits:["edit","delete","user-deleted"],setup(n,{emit:r}){const{language:a}=L(),e=f(!1),l=f(null);return{language:a,t:_,showDeleteModal:e,userToDelete:l,handleDeleteClick:d=>{l.value=d,e.value=!0},closeDeleteModal:()=>{e.value=!1,l.value=null},handleUserDeleted:d=>{r("user-deleted",d)}}}},Be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},Re={key:0,class:"overflow-x-auto"},ze={class:"w-full"},He={class:"bg-gray-50 dark:bg-gray-700"},Ke={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},We={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Xe={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ge={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Je={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Qe={class:"overflow-x-auto"},Ye={class:"w-full"},Ze={class:"bg-gray-50 dark:bg-gray-700"},$e={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},et={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},tt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},at={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},st={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},rt={class:"px-6 py-4 whitespace-nowrap"},ot={class:"flex items-center"},dt={class:"flex-shrink-0 h-10 w-10"},lt={class:"h-10 w-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center"},nt={class:"ml-4"},it={class:"text-sm font-medium text-gray-900 dark:text-white"},ct={key:0,class:"text-xs text-blue-600 dark:text-blue-400"},gt={class:"px-6 py-4 whitespace-nowrap"},ut={class:"text-sm text-gray-600 dark:text-gray-400"},mt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},xt={class:"flex items-center justify-end space-x-2"},ht=["onClick","title"],bt=["onClick","title"],_t={key:0,class:"text-center py-12"},ft={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},kt={class:"text-gray-600 dark:text-gray-400"};function pt(n,r,a,e,l,c){const o=x("Shield"),h=x("UserIcon"),d=x("Edit"),v=x("Trash2"),U=x("Users"),M=x("DeleteUserModal");return i(),y("div",Be,[a.isLoading?(i(),y("div",Re,[t("table",ze,[t("thead",He,[t("tr",null,[t("th",Ke,s(e.t("user",e.language)),1),t("th",We,s(e.t("email",e.language)),1),t("th",Xe,s(e.t("role",e.language)),1),t("th",Ge,s(e.t("actions",e.language)),1)])]),t("tbody",Je,[(i(),y(A,null,O(3,u=>t("tr",{key:u},r[0]||(r[0]=[t("td",{class:"px-6 py-4 whitespace-nowrap"},[t("div",{class:"flex items-center"},[t("div",{class:"flex-shrink-0 h-10 w-10"},[t("div",{class:"h-10 w-10 rounded-full shimmer"})]),t("div",{class:"ml-4"},[t("div",{class:"h-4 rounded w-24 shimmer"})])])],-1),t("td",{class:"px-6 py-4 whitespace-nowrap"},[t("div",{class:"h-4 rounded w-32 shimmer"})],-1),t("td",{class:"px-6 py-4 whitespace-nowrap"},[t("div",{class:"h-6 rounded-full w-16 shimmer"})],-1),t("td",{class:"px-6 py-4 whitespace-nowrap text-right"},[t("div",{class:"flex items-center justify-end space-x-2"},[t("div",{class:"h-4 w-4 rounded shimmer"}),t("div",{class:"h-4 w-4 rounded shimmer"})])],-1)]))),64))])])])):w("",!0),t("div",Qe,[t("table",Ye,[t("thead",Ze,[t("tr",null,[t("th",$e,s(e.t("user",e.language)),1),t("th",et,s(e.t("email",e.language)),1),t("th",tt,s(e.t("role",e.language)),1),t("th",at,s(e.t("actions",e.language)),1)])]),t("tbody",st,[(i(!0),y(A,null,O(a.users,u=>(i(),y("tr",{key:u.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",rt,[t("div",ot,[t("div",dt,[t("div",lt,[u.adminType==="ADMIN"?(i(),p(o,{key:0,class:"w-5 h-5 text-gray-600 dark:text-gray-300"})):(i(),p(h,{key:1,class:"w-5 h-5 text-gray-600 dark:text-gray-300"}))])]),t("div",nt,[t("div",it,s(u.name),1),u.id===a.currentUser?.id?(i(),y("div",ct," ("+s(e.t("you",e.language))+") ",1)):w("",!0)])])]),t("td",gt,[t("div",ut,s(u.email),1)]),t("td",mt,[t("span",{class:z(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",u.adminType==="ADMIN"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"])},s(e.t(u.adminType.toLowerCase(),e.language)),3)]),t("td",yt,[t("div",xt,[t("button",{onClick:m=>n.$emit("edit",u),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",title:e.t("edit",e.language)},[b(d,{class:"w-4 h-4"})],8,ht),u.id!==a.currentUser?.id?(i(),y("button",{key:0,onClick:m=>e.handleDeleteClick(u),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:e.t("delete",e.language)},[b(v,{class:"w-4 h-4"})],8,bt)):w("",!0)])])]))),128))])]),a.users.length===0?(i(),y("div",_t,[b(U,{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",ft,s(e.t("noUsers",e.language)),1),t("p",kt,s(e.t("noUsersFound",e.language)),1)])):w("",!0)]),b(M,{isOpen:e.showDeleteModal,user:e.userToDelete,onClose:e.closeDeleteModal,onDeleted:e.handleUserDeleted},null,8,["isOpen","user","onClose","onDeleted"])])}const vt=S(qe,[["render",pt]]),wt={name:"UserManager",components:{UserForm:_e,UserTable:vt,Plus:Y,Users:N},setup(){const{currentUser:n}=W(),{language:r}=L(),a=f([]),e=f(!1),l=f(null),c=f(!1),o=f(!1),h=K(()=>n.value?.adminType==="ADMIN"),d=async()=>{if(!(!n.value||!h.value))try{c.value=!0,a.value=await T.getAllUsers()}catch(m){console.error("Error loading users:",m),alert("Erro ao carregar usuários: "+(m.response?.data?.message||m.message))}finally{c.value=!1}},v=async m=>{try{if(o.value=!0,l.value){const k=await T.updateUser(l.value.id,m),D=a.value.findIndex(B=>B.id===l.value.id);D!==-1&&(a.value[D]=k)}else{const k=await T.createUser(m);a.value.push(k)}u()}catch(k){console.error("Error saving user:",k);const D=l.value?"Erro ao atualizar usuário":"Erro ao criar usuário";alert(D)}finally{o.value=!1}},U=m=>{l.value=m,e.value=!0},M=m=>{a.value=a.value.filter(k=>k.id!==m)},u=()=>{e.value=!1,l.value=null};return F(n,m=>{m&&m.adminType==="ADMIN"&&d()},{immediate:!0}),{currentUser:n,users:a,showForm:e,editingUser:l,isLoading:c,isFormLoading:o,isAdmin:h,language:r,t:_,handleSubmit:v,handleEdit:U,handleUserDeleted:M,handleCancel:u}}},Ut={class:"space-y-6"},Dt={key:0,class:"text-center py-12"},Ct={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Tt={class:"text-gray-600 dark:text-gray-400"},Lt={key:1},Mt={class:"flex justify-between items-center"},Et={class:"text-2xl font-bold text-gray-900 dark:text-white"},St={class:"mt-6"};function At(n,r,a,e,l,c){const o=x("Users"),h=x("Plus"),d=x("UserForm"),v=x("UserTable");return i(),y("div",Ut,[e.currentUser?.adminType!=="ADMIN"?(i(),y("div",Dt,[b(o,{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t("h3",Ct,s(e.t("accessRestricted",e.language)),1),t("p",Tt,s(e.t("onlyAdminsUsers",e.language)),1)])):(i(),y("div",Lt,[t("div",Mt,[t("h2",Et,s(e.t("users",e.language)),1),t("button",{onClick:r[0]||(r[0]=U=>e.showForm=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[b(h,{class:"w-4 h-4 mr-2"}),H(" "+s(e.t("newUser",e.language)),1)])]),e.showForm?(i(),p(d,{key:0,"editing-user":e.editingUser,"is-loading":e.isFormLoading,onSubmit:e.handleSubmit,onCancel:e.handleCancel},null,8,["editing-user","is-loading","onSubmit","onCancel"])):w("",!0),t("div",St,[b(v,{users:e.users,"current-user":e.currentUser,"is-loading":e.isLoading,onEdit:e.handleEdit,onUserDeleted:e.handleUserDeleted},null,8,["users","current-user","is-loading","onEdit","onUserDeleted"])])]))])}const Bt=S(wt,[["render",At]]);export{Bt as default};
