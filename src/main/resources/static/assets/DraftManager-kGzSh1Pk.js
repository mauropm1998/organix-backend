import{c as me,h as E,o as l,a as u,f as $,b as e,t as r,p as b,u as t,w as be,g as D,v as z,z as N,q as C,s as I,T as Ve,m as je,n as ue,A as Me,F as de,d as m,e as le,B as fe,C as te,x as xe,D as Fe,r as k,y as ee,l as Re,j as ge}from"./index-CNz27Lkk.js";import{u as he}from"./useData-CwxFRyTY.js";import{_ as w}from"./SkeletonLoader-G0xqtsj1.js";import{X as qe}from"./x-tc_f50AM.js";import{L as ne}from"./loader-circle-ByVzuIht.js";import{A as oe}from"./arrow-right-CpnCvpI6.js";import{S as Le}from"./square-pen-DU5hSGYw.js";import{T as ve,a as Be}from"./triangle-alert-0cpL1EcI.js";import{C as ze}from"./circle-check-big-CY9GzH1t.js";import{P as Ge}from"./plus-DEtPLCxO.js";import"./userService-C702iV5E.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=me("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=me("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Xe={key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center p-4"},We={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[calc(100vh-2rem)] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true"},Ye={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 shrink-0 sticky top-0 bg-white/90 dark:bg-gray-800/90 backdrop-blur rounded-t-lg"},Je={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ke=["disabled"],Qe={class:"flex-1 overflow-y-auto p-6"},Ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},et=["disabled","placeholder"],tt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},at=["disabled"],rt={value:""},st=["value"],ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dt=["disabled"],lt={value:""},nt=["value"],it={key:0},ct={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ut=["disabled"],gt=["value"],yt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},mt=["disabled","placeholder"],bt={class:"flex flex-col sm:flex-row gap-3 sm:justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-600 shrink-0 bg-gray-50 dark:bg-gray-800/50"},ft=["disabled"],xt=["disabled"],ht={__name:"DraftFormModal",props:{show:{type:Boolean,default:!1},editingDraft:{type:Object,default:null},user:{type:Object,default:null},formData:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1},contentTypes:{type:Array,required:!0},draftStatuses:{type:Array,required:!0},products:{type:Array,required:!0},t:{type:Function,required:!0},language:{type:String,required:!0}},emits:["submit","cancel"],setup(a){return(o,g)=>(l(),E(Ve,{to:"body"},[a.show?(l(),u("div",Xe,[e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g[0]||(g[0]=c=>o.$emit("cancel"))}),e("div",We,[e("div",Ye,[e("h3",Je,r(a.editingDraft?a.t("editDraft",a.language):a.t("createNewDraft",a.language)),1),e("button",{onClick:g[1]||(g[1]=c=>o.$emit("cancel")),disabled:a.isSubmitting,class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 disabled:opacity-50"},[b(t(qe),{class:"w-5 h-5"})],8,Ke)]),e("div",Qe,[e("form",{onSubmit:g[7]||(g[7]=be(c=>o.$emit("submit",a.formData),["prevent"])),class:"space-y-4"},[e("div",null,[e("label",Ze,r(a.t("name",a.language))+" * ",1),D(e("input",{"onUpdate:modelValue":g[2]||(g[2]=c=>a.formData.name=c),type:"text",required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",placeholder:a.t("enterDraftName",a.language)},null,8,et),[[z,a.formData.name]])]),e("div",null,[e("label",tt,r(a.t("type",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[3]||(g[3]=c=>a.formData.type=c),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",rt,r(a.t("selectType",a.language)),1),(l(!0),u(C,null,I(a.contentTypes,c=>(l(),u("option",{key:c,value:c},r(c),9,st))),128))],8,at),[[N,a.formData.type]])]),e("div",null,[e("label",ot,r(a.t("product",a.language)),1),D(e("select",{"onUpdate:modelValue":g[4]||(g[4]=c=>a.formData.productId=c),disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",lt,r(a.t("selectProduct",a.language)),1),(l(!0),u(C,null,I(a.products,c=>(l(),u("option",{key:c.id,value:c.id},r(c.name),9,nt))),128))],8,dt),[[N,a.formData.productId]])]),a.user?.adminType==="ADMIN"?(l(),u("div",it,[e("label",ct,r(a.t("status",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[5]||(g[5]=c=>a.formData.status=c),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[(l(!0),u(C,null,I(a.draftStatuses,c=>(l(),u("option",{key:c,value:c},r(a.t(c.toLowerCase(),a.language)),9,gt))),128))],8,ut),[[N,a.formData.status]])])):$("",!0),e("div",null,[e("label",yt,r(a.t("draftContent",a.language))+" * ",1),D(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=c=>a.formData.content=c),required:"",disabled:a.isSubmitting,rows:"6",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50 resize-none",placeholder:a.t("enterDraftContent",a.language)},null,8,mt),[[z,a.formData.content]])])],32)]),e("div",bt,[e("button",{onClick:g[8]||(g[8]=c=>o.$emit("cancel")),disabled:a.isSubmitting,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(a.t("cancel",a.language)),9,ft),e("button",{onClick:g[9]||(g[9]=c=>o.$emit("submit",a.formData)),disabled:a.isSubmitting||!a.formData.name||!a.formData.type||!a.formData.content,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isSubmitting?(l(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):$("",!0),e("span",null,r(a.editingDraft?a.t("update",a.language):a.t("create",a.language)),1)],8,xt)])])])):$("",!0)]))}},vt={class:"overflow-x-auto"},pt={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},kt={class:"bg-gray-50 dark:bg-gray-700"},wt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},$t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},_t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},It={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Tt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Pt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},St={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm font-medium text-gray-900 dark:text-white"},Et={class:"px-6 py-4 whitespace-nowrap"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Ot={class:"px-6 py-4 whitespace-nowrap"},Ut={class:"text-sm text-gray-600 dark:text-gray-400"},Vt={class:"px-6 py-4 whitespace-nowrap"},jt={class:"text-sm text-gray-600 dark:text-gray-400"},Mt={class:"px-6 py-4 whitespace-nowrap"},Ft={class:"flex items-center space-x-2"},Rt={class:"px-6 py-4 whitespace-nowrap"},qt={class:"text-sm text-gray-600 dark:text-gray-400"},Lt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Bt={class:"flex items-center justify-end space-x-2"},zt=["onClick","title"],Gt=["onClick","title"],Ht=["onClick","title"],Xt={key:0,class:"text-center py-12"},Wt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Yt={class:"text-gray-600 dark:text-gray-400"},Jt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,products:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(a){const o=a,{filteredDrafts:g,users:c,products:P,t:v,language:p,canEdit:A}=je(o);function F(s){const d=c.value.find(i=>i.id===s);return d?d.name:"Unknown"}function n(s){if(!s)return"-";const d=P.value?.find(i=>i.id===s);return d?d.name:"Produto n√£o encontrado"}function G(s){return s==="APPROVED"?ze:s==="PENDING"?ye:s==="NOT_APPROVED"?He:ye}function j(s){return s==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":s==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":s==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function R(s){return s==="APPROVED"?"text-green-500 dark:text-green-400":s==="PENDING"?"text-yellow-500 dark:text-yellow-400":s==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function f(s){if(!s)return"";try{let d;if(Array.isArray(s)&&s.length>=3){const[i,S,q,O=0,T=0,U=0]=s;d=new Date(i,S-1,q,O,T,U)}else if(typeof s=="string")d=new Date(s);else if(s instanceof Date)d=s;else return"Data inv√°lida";return!(d instanceof Date)||isNaN(d.getTime())?"Data inv√°lida":d.toLocaleDateString()}catch{return"Data inv√°lida"}}return(s,d)=>(l(),u("div",vt,[e("table",pt,[e("thead",kt,[e("tr",null,[e("th",wt,r(t(v)("name",t(p))),1),e("th",$t,r(t(v)("type",t(p))),1),e("th",Dt,r(t(v)("product",t(p))),1),e("th",_t,r(t(v)("creator",t(p))),1),e("th",Ct,r(t(v)("status",t(p))),1),e("th",It,r(t(v)("created",t(p))),1),e("th",Tt,r(t(v)("actions",t(p))),1)])]),e("tbody",Pt,[(l(!0),u(C,null,I(t(g),i=>(l(),u("tr",{key:i.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",St,[e("div",Nt,r(i.name),1)]),e("td",Et,[e("div",At,r(i.type),1)]),e("td",Ot,[e("div",Ut,r(n(i.productId)),1)]),e("td",Vt,[e("div",jt,r(F(i.creatorId)),1)]),e("td",Mt,[e("div",Ft,[(l(),E(Me(G(i.status)),{class:ue(["w-4 h-4",R(i.status)])},null,8,["class"])),e("span",{class:ue(j(i.status))},r(t(v)(i.status?.toLowerCase()||"draft",t(p))),3)])]),e("td",Rt,[e("div",qt,r(f(i.createdAt)),1)]),e("td",Lt,[e("div",Bt,[i.status==="APPROVED"&&t(A)(i)?(l(),u("button",{key:0,onClick:S=>s.$emit("transform",i),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:t(v)("transformToContent",t(p))},[b(t(oe),{class:"w-4 h-4"})],8,zt)):$("",!0),t(A)(i)?(l(),u("button",{key:1,onClick:S=>s.$emit("edit",i),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:t(v)("editDraft",t(p))},[b(t(Le),{class:"w-4 h-4"})],8,Gt)):$("",!0),t(A)(i)?(l(),u("button",{key:2,onClick:S=>s.$emit("delete",i),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:t(v)("deleteDraft",t(p))},[b(t(ve),{class:"w-4 h-4"})],8,Ht)):$("",!0)])])]))),128))])]),t(g).length?$("",!0):(l(),u("div",Xt,[b(t(de),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e("h3",Wt,r(t(v)("noDraftsFound",t(p))),1),e("p",Yt,r(t(v)("createFirstDraft",t(p))),1)]))]))}},Kt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Qt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},Zt={class:"p-6"},ea={class:"flex items-center mb-4"},ta={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},aa={class:"text-lg font-medium text-gray-900 dark:text-white"},ra={class:"mb-6"},sa={class:"text-gray-600 dark:text-gray-400"},oa={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},da={class:"flex items-center"},la={class:"min-w-0 flex-1"},na={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ia={class:"text-xs text-gray-500 dark:text-gray-400"},ca={class:"flex space-x-3 justify-end"},ua=["disabled"],ga=["disabled"],ya={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le();return(g,c)=>(l(),u("div",Kt,[e("div",Qt,[e("div",Zt,[e("div",ea,[e("div",ta,[b(t(Be),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),e("div",null,[e("h3",aa,r(t(m)("confirmDeletion",t(o))),1)])]),e("div",ra,[e("p",sa,r(t(m)("confirmDeleteDraft",t(o))),1),e("div",oa,[e("div",da,[b(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",la,[e("span",na,r(a.draft?.name),1),e("span",ia,r(a.draft?.type)+" ‚Ä¢ "+r(t(m)(a.draft?.status?.toLowerCase()||"draft",t(o))),1)])])])]),e("div",ca,[e("button",{onClick:c[0]||(c[0]=P=>g.$emit("cancel")),disabled:a.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(m)("cancel",t(o))),9,ua),e("button",{onClick:c[1]||(c[1]=P=>g.$emit("confirm")),disabled:a.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isDeleting?(l(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(l(),E(t(ve),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isDeleting?t(m)("deleting",t(o)):t(m)("delete",t(o))),1)],8,ga)])])])]))}},ma={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ba={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},fa={class:"p-6"},xa={class:"flex items-center mb-4"},ha={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},va={class:"text-lg font-medium text-gray-900 dark:text-white"},pa={class:"mb-6"},ka={class:"text-gray-600 dark:text-gray-400 mb-4"},wa={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},$a={class:"flex items-center"},Da={class:"min-w-0 flex-1"},_a={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Ca={class:"text-xs text-gray-500 dark:text-gray-400"},Ia={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ta={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pa=["disabled"],Sa={value:""},Na=["value"],Ea={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Aa=["disabled"],Oa={value:""},Ua=["value"],Va={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ja={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ma=["disabled"],Fa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ra=["disabled"],qa={value:"PENDING"},La={value:"IN_PRODUCTION"},Ba={value:"POSTED"},za={value:"PRODUCTION_FINISHED"},Ga={value:"FINISHED"},Ha={value:"CANCELED"},Xa={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ya=["disabled"],Ja={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ka=["disabled"],Qa={key:1},Za={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},er=["disabled","placeholder"],tr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ar={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},rr=["id","value","disabled"],sr=["for"],or={key:0,class:"text-xs text-red-500 mt-1"},dr={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},lr=["disabled"],nr=["disabled"],ir={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=le(),{channels:g,products:c,users:P,fetchChannels:v,fetchProducts:p,fetchUsers:A}=he(),F=a,n=fe({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:""});te(()=>n.status,f=>{f!=="IN_PRODUCTION"&&(n.productionStartDate="",n.productionEndDate=""),f!=="POSTED"&&(n.metaAdsId="")}),xe(async()=>{await Promise.all([g.value&&g.value.length>0?Promise.resolve():v(),c.value&&c.value.length>0?Promise.resolve():p(),P.value&&P.value.length>0?Promise.resolve():A()])}),te(()=>F.draft,()=>{n.status="PENDING",n.channelIds=[],n.productId=F.draft?.productId||"",n.producerId="",n.postDate="",n.productionStartDate="",n.productionEndDate="",n.metaAdsId=""},{immediate:!0});const G=f=>{if(!f)return"";const s=m(`contentTypes.${f}`,o.value);return s.startsWith("contentTypes.")?f:s},j=f=>{if(!f)return;const s=new Date(f),d=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),S=String(s.getDate()).padStart(2,"0"),q=String(s.getHours()).padStart(2,"0"),O=String(s.getMinutes()).padStart(2,"0"),T=String(s.getSeconds()).padStart(2,"0");return`${d}-${i}-${S}T${q}:${O}:${T}`},R=()=>{const f={status:n.status,channelIds:n.channelIds,productId:n.productId||null,producerId:n.producerId||null,postDate:j(n.postDate)};return n.status==="IN_PRODUCTION"&&(f.productionStartDate=j(n.productionStartDate),f.productionEndDate=j(n.productionEndDate)),n.status==="POSTED"&&(f.metaAdsId=n.metaAdsId||null),f};return(f,s)=>(l(),u("div",ma,[e("div",ba,[e("div",fa,[e("div",xa,[e("div",ha,[b(t(oe),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("div",null,[e("h3",va,r(t(m)("transformDraft",t(o))),1)])]),e("div",pa,[e("p",ka,r(t(m)("transformDraftDescription",t(o))),1),e("div",wa,[e("div",$a,[b(t(de),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",Da,[e("span",_a,r(a.draft?.name),1),e("span",Ca,r(G(a.draft?.type)),1)])])]),e("form",{onSubmit:s[8]||(s[8]=be(d=>f.$emit("confirm",R()),["prevent"])),class:"space-y-4"},[e("div",Ia,[e("div",null,[e("label",Ta,r(t(m)("product",t(o))),1),D(e("select",{"onUpdate:modelValue":s[0]||(s[0]=d=>n.productId=d),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Sa,r(t(m)("selectProduct",t(o))),1),(l(!0),u(C,null,I(t(c),d=>(l(),u("option",{key:d.id,value:d.id},r(d.name),9,Na))),128))],8,Pa),[[N,n.productId]])]),e("div",null,[e("label",Ea,r(t(m)("producer",t(o))),1),D(e("select",{"onUpdate:modelValue":s[1]||(s[1]=d=>n.producerId=d),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Oa,r(t(m)("selectProducer",t(o))),1),(l(!0),u(C,null,I(t(P),d=>(l(),u("option",{key:d.id,value:d.id},r(d.name),9,Ua))),128))],8,Aa),[[N,n.producerId]])])]),e("div",Va,[e("div",null,[e("label",ja,r(t(m)("postDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>n.postDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ma),[[z,n.postDate]])]),e("div",null,[e("label",Fa,r(t(m)("status",t(o))),1),D(e("select",{"onUpdate:modelValue":s[3]||(s[3]=d=>n.status=d),required:"",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",qa,r(t(m)("pending",t(o))),1),e("option",La,r(t(m)("in_production",t(o))),1),e("option",Ba,r(t(m)("posted",t(o))),1),e("option",za,r(t(m)("production-finished",t(o))),1),e("option",Ga,r(t(m)("finished",t(o))),1),e("option",Ha,r(t(m)("canceled",t(o))),1)],8,Ra),[[N,n.status]])])]),n.status==="IN_PRODUCTION"?(l(),u("div",Xa,[e("div",null,[e("label",Wa,r(t(m)("productionStartDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[4]||(s[4]=d=>n.productionStartDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ya),[[z,n.productionStartDate]])]),e("div",null,[e("label",Ja,r(t(m)("productionEndDate",t(o))),1),D(e("input",{"onUpdate:modelValue":s[5]||(s[5]=d=>n.productionEndDate=d),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ka),[[z,n.productionEndDate]])])])):$("",!0),n.status==="POSTED"?(l(),u("div",Qa,[e("label",Za,r(t(m)("metaAdsId",t(o))),1),D(e("input",{"onUpdate:modelValue":s[6]||(s[6]=d=>n.metaAdsId=d),type:"text",disabled:a.isTransforming,placeholder:t(m)("enterMetaAdsId",t(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,er),[[z,n.metaAdsId]])])):$("",!0),e("div",null,[e("label",tr,r(t(m)("channels",t(o)))+" * ",1),e("div",ar,[(l(!0),u(C,null,I(t(g),d=>(l(),u("div",{key:d.id,class:"flex items-center"},[D(e("input",{id:`channel-${d.id}`,type:"checkbox",value:d.id,"onUpdate:modelValue":s[7]||(s[7]=i=>n.channelIds=i),disabled:a.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,rr),[[Fe,n.channelIds]]),e("label",{for:`channel-${d.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},r(d.name),9,sr)]))),128))]),n.channelIds.length===0?(l(),u("p",or,r(t(m)("selectAtLeastOneChannel",t(o))),1)):$("",!0)])],32)]),e("div",dr,[e("button",{onClick:s[9]||(s[9]=d=>f.$emit("cancel")),disabled:a.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(m)("cancel",t(o))),9,lr),e("button",{onClick:s[10]||(s[10]=d=>f.$emit("confirm",R())),disabled:a.isTransforming||n.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isTransforming?(l(),E(t(ne),{key:0,class:"w-4 h-4 animate-spin"})):(l(),E(t(oe),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isTransforming?t(m)("transforming",t(o)):t(m)("transform",t(o))),1)],8,nr)])])])]))}},cr={class:"space-y-6"},ur={class:"flex justify-between items-center"},gr={class:"text-2xl font-bold text-gray-900 dark:text-white"},yr={key:0},mr={key:0,class:"space-y-6"},br={class:"flex space-x-4"},fr={class:"overflow-x-auto"},xr={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},hr={class:"bg-gray-50 dark:bg-gray-700"},vr={class:"px-6 py-3 text-left"},pr={class:"px-6 py-3 text-left"},kr={class:"px-6 py-3 text-left"},wr={class:"px-6 py-3 text-left"},$r={class:"px-6 py-3 text-left"},Dr={class:"px-6 py-3 text-right"},_r={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Cr={class:"px-6 py-4"},Ir={class:"px-6 py-4"},Tr={class:"px-6 py-4"},Pr={class:"px-6 py-4"},Sr={class:"flex items-center space-x-2"},Nr={class:"px-6 py-4"},Er={class:"px-6 py-4"},Ar={class:"flex items-center justify-end space-x-2"},Or={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ur={class:"text-red-600"},Vr={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},jr={class:"text-green-600"},Mr={key:3,class:"flex space-x-4"},Fr={value:""},Rr=["value"],qr={value:""},Lr=["value"],Br={value:""},zr=["value"],Gr={key:4},Hr={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},Xr={class:"text-sm text-gray-600 dark:text-gray-400"},Wr={class:"flex items-center space-x-2"},Yr=["disabled"],Jr=["disabled"],ns={__name:"DraftManager",setup(a){const{language:o}=le(),{currentUser:g}=Re(),{drafts:c,users:P,products:v,loadingDrafts:p,errors:A,fetchDrafts:F,fetchUsers:n,fetchChannels:G,fetchProducts:j,createDraft:R,updateDraft:f,deleteDraft:s,transformDraftToContent:d}=he(),i=y=>m(y,o.value),S=["Post","Story","Reels","Video","Artigo"],q=["PENDING","APPROVED","NOT_APPROVED"],O=k(!1),T=k(null),U=k(""),X=k(""),W=k(""),ae=fe({name:"",type:"",content:"",productId:"",status:"PENDING"}),Y=k(!1),M=k(""),J=k(!0),K=k(!1),Q=k(!1),L=k(null),B=k(null),re=k(!1),se=k(!1),_=k(0),pe=k(15),H=k(1),Z=k(0);xe(async()=>{await Promise.all([n(),G(),j()]),await V(),J.value=!1}),te(U,async()=>{_.value=0,await V()}),te(W,async()=>{_.value=0,await V()});const ke=ee(()=>!c.value||!g.value?[]:c.value),we=ee(()=>ke.value.filter(y=>!(U.value&&y.status!==U.value||X.value&&y.type!==X.value))),$e=ee(()=>we.value),De=ee(()=>_.value+1),V=async()=>{const y=await F({status:U.value||void 0,productId:W.value||void 0,page:_.value,size:pe.value});y&&typeof y=="object"&&(typeof y.totalPages=="number"&&(H.value=y.totalPages),typeof y.totalElements=="number"&&(Z.value=y.totalElements))},_e=async()=>{_.value!==0&&(_.value-=1,await V())},Ce=async()=>{_.value>=H.value-1||(_.value+=1,await V())};async function ie(){_.value=0,await V()}async function Ie(y){if(!Y.value){Y.value=!0,M.value="";try{let h;if(T.value)h=await f(T.value.id,y);else{const x={...y,creatorId:g.value.id,status:y.status||"PENDING"};h=await R(x)}h.success?(M.value=T.value?i("draftUpdatedSuccessfully"):i("draftCreatedSuccessfully"),ce(),await V()):console.error("Error:",h.error)}catch(h){console.error("Unexpected error:",h)}finally{Y.value=!1}}}function Te(y){T.value=y,Object.assign(ae,{name:y.name,type:y.type,content:y.content||"",productId:y.productId||"",status:y.status}),O.value=!0}function ce(){O.value=!1,T.value=null,Object.assign(ae,{name:"",type:"",content:"",productId:"",status:"PENDING"}),M.value=""}async function Pe(y){L.value=y,K.value=!0}async function Se(){if(L.value){re.value=!0;try{const y=await s(L.value.id);y.success?(M.value=i("draftDeletedSuccessfully"),K.value=!1,L.value=null):console.error("Error:",y.error)}catch(y){console.error("Unexpected error:",y)}finally{re.value=!1}}}function Ne(){K.value=!1,L.value=null}async function Ee(y){B.value=y,Q.value=!0}async function Ae(y){if(B.value){se.value=!0;try{const h=await d(B.value.id,y);h.success?(M.value=i("draftTransformed"),Q.value=!1,B.value=null,await V()):console.error("Error:",h.error)}catch(h){console.error("Unexpected error:",h)}finally{se.value=!1}}}function Oe(){Q.value=!1,B.value=null}function Ue(y){return g.value?g.value.adminType==="ADMIN"||y.creatorId===g.value.id:!1}return(y,h)=>(l(),u("div",cr,[e("div",ur,[e("h2",gr,[ge(r(i("drafts",t(o)))+" ",1),Z.value?(l(),u("span",yr,"("+r(Z.value)+")",1)):$("",!0)]),e("button",{onClick:h[0]||(h[0]=x=>O.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[b(t(Ge),{class:"w-4 h-4 mr-2"}),ge(" "+r(i("newDraft",t(o))),1)])]),t(p)||J.value?(l(),u("div",mr,[e("div",br,[b(w,{customClass:"h-10 w-32"}),b(w,{customClass:"h-10 w-32"}),b(w,{customClass:"h-10 w-32"})]),e("div",fr,[e("table",xr,[e("thead",hr,[e("tr",null,[e("th",vr,[b(w,{customClass:"h-4 w-16"})]),e("th",pr,[b(w,{customClass:"h-4 w-12"})]),e("th",kr,[b(w,{customClass:"h-4 w-20"})]),e("th",wr,[b(w,{customClass:"h-4 w-16"})]),e("th",$r,[b(w,{customClass:"h-4 w-20"})]),e("th",Dr,[b(w,{customClass:"h-4 w-16"})])])]),e("tbody",_r,[(l(),u(C,null,I(6,x=>e("tr",{key:x},[e("td",Cr,[b(w,{customClass:"h-4 w-32 shimmer"})]),e("td",Ir,[b(w,{customClass:"h-4 w-16 shimmer"})]),e("td",Tr,[b(w,{customClass:"h-4 w-24 shimmer"})]),e("td",Pr,[e("div",Sr,[b(w,{customClass:"h-4 w-4 rounded-full shimmer"}),b(w,{customClass:"h-4 w-20 shimmer"})])]),e("td",Nr,[b(w,{customClass:"h-4 w-24 shimmer"})]),e("td",Er,[e("div",Ar,[b(w,{customClass:"h-8 w-8 rounded shimmer"}),b(w,{customClass:"h-8 w-8 rounded shimmer"}),b(w,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):t(A).drafts?(l(),u("div",Or,[e("p",Ur,r(t(A).drafts),1)])):$("",!0),M.value?(l(),u("div",Vr,[e("p",jr,r(M.value),1)])):$("",!0),!t(p)&&!J.value?(l(),u("div",Mr,[D(e("select",{"onUpdate:modelValue":h[1]||(h[1]=x=>U.value=x),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Fr,r(i("allStatuses",t(o))),1),(l(),u(C,null,I(q,x=>e("option",{key:x,value:x},r(i(x.toLowerCase(),t(o))),9,Rr)),64))],544),[[N,U.value]]),D(e("select",{"onUpdate:modelValue":h[2]||(h[2]=x=>X.value=x),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",qr,r(i("allTypes",t(o))),1),(l(),u(C,null,I(S,x=>e("option",{key:x,value:x},r(x),9,Lr)),64))],512),[[N,X.value]]),D(e("select",{"onUpdate:modelValue":h[3]||(h[3]=x=>W.value=x),onChange:ie,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Br,r(i("allProducts",t(o))),1),(l(!0),u(C,null,I(t(v),x=>(l(),u("option",{key:x.id,value:x.id},r(x.name),9,zr))),128))],544),[[N,W.value]])])):$("",!0),b(ht,{show:O.value,editingDraft:T.value,user:t(g),formData:ae,isSubmitting:Y.value,contentTypes:S,draftStatuses:q,products:t(v),t:i,language:t(o),onSubmit:Ie,onCancel:ce},null,8,["show","editingDraft","user","formData","isSubmitting","products","language"]),!t(p)&&!J.value?(l(),u("div",Gr,[b(Jt,{filteredDrafts:$e.value,users:t(P),products:t(v),t:i,language:t(o),canEdit:Ue,onEdit:Te,onDelete:Pe,onTransform:Ee},null,8,["filteredDrafts","users","products","language"]),H.value>1?(l(),u("div",Hr,[e("div",Xr,r(i("page",t(o)))+" "+r(De.value)+" / "+r(H.value)+" ¬∑ "+r(Z.value)+" "+r(i("items",t(o))),1),e("div",Wr,[e("button",{onClick:_e,disabled:_.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(i("previous",t(o))),9,Yr),e("button",{onClick:Ce,disabled:_.value>=H.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(i("next",t(o))),9,Jr)])])):$("",!0)])):$("",!0),K.value?(l(),E(ya,{key:5,draft:L.value,"is-deleting":re.value,onConfirm:Se,onCancel:Ne},null,8,["draft","is-deleting"])):$("",!0),Q.value?(l(),E(ir,{key:6,draft:B.value,"is-transforming":se.value,onConfirm:Ae,onCancel:Oe},null,8,["draft","is-transforming"])):$("",!0)]))}};export{ns as default};
