import{c as be,h as O,o as l,a as n,f as _,b as e,t as r,p as b,u as t,w as me,g as D,v as z,z as P,q as T,s as I,T as je,m as Re,n as ge,A as Me,F as ne,d as f,e as ie,B as xe,C as W,x as he,D as Fe,r as w,y as ae,l as qe,j as ye}from"./index-C7JZJEmc.js";import{u as pe}from"./useData-C7dNnzw4.js";import{_ as $}from"./SkeletonLoader-CEmze3k9.js";import{X as Ge}from"./x-DDP0gA24.js";import{L as ue}from"./loader-circle-BNHsUdON.js";import{A as le}from"./arrow-right-Btv4cipo.js";import{S as Le}from"./square-pen-BjAS_Zej.js";import{T as ve,a as Be}from"./triangle-alert-CT_e-AsO.js";import{C as ze}from"./circle-check-big-No2S7hqC.js";import{P as He}from"./plus-DK8h20CO.js";import"./userService-HYSguwDL.js";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=be("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=be("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),We={key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center p-4"},Ye={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[calc(100vh-2rem)] flex flex-col border border-gray-200 dark:border-gray-700 overflow-hidden",role:"dialog","aria-modal":"true"},Je={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 shrink-0 sticky top-0 bg-white/90 dark:bg-gray-800/90 backdrop-blur rounded-t-lg"},Ke={class:"text-lg font-semibold text-gray-900 dark:text-white"},Qe=["disabled"],Ze={class:"flex-1 overflow-y-auto p-6"},et={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},tt=["disabled","placeholder"],at={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rt=["disabled"],st={value:""},ot=["value"],dt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},lt=["disabled"],nt={value:""},it=["value"],ut={key:0},ct={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},gt=["disabled"],yt=["value"],ft={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},bt=["disabled","placeholder"],mt={class:"flex flex-col sm:flex-row gap-3 sm:justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-600 shrink-0 bg-gray-50 dark:bg-gray-800/50"},xt=["disabled"],ht=["disabled"],pt={__name:"DraftFormModal",props:{show:{type:Boolean,default:!1},editingDraft:{type:Object,default:null},user:{type:Object,default:null},formData:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1},contentTypes:{type:Array,required:!0},draftStatuses:{type:Array,required:!0},products:{type:Array,required:!0},t:{type:Function,required:!0},language:{type:String,required:!0}},emits:["submit","cancel"],setup(a){return(o,g)=>(l(),O(je,{to:"body"},[a.show?(l(),n("div",We,[e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g[0]||(g[0]=i=>o.$emit("cancel"))}),e("div",Ye,[e("div",Je,[e("h3",Ke,r(a.editingDraft?a.t("editDraft",a.language):a.t("createNewDraft",a.language)),1),e("button",{onClick:g[1]||(g[1]=i=>o.$emit("cancel")),disabled:a.isSubmitting,class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 disabled:opacity-50"},[b(t(Ge),{class:"w-5 h-5"})],8,Qe)]),e("div",Ze,[e("form",{onSubmit:g[7]||(g[7]=me(i=>o.$emit("submit",a.formData),["prevent"])),class:"space-y-4"},[e("div",null,[e("label",et,r(a.t("name",a.language))+" * ",1),D(e("input",{"onUpdate:modelValue":g[2]||(g[2]=i=>a.formData.name=i),type:"text",required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50",placeholder:a.t("enterDraftName",a.language)},null,8,tt),[[z,a.formData.name]])]),e("div",null,[e("label",at,r(a.t("type",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[3]||(g[3]=i=>a.formData.type=i),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",st,r(a.t("selectType",a.language)),1),(l(!0),n(T,null,I(a.contentTypes,i=>(l(),n("option",{key:i,value:i},r(i),9,ot))),128))],8,rt),[[P,a.formData.type]])]),e("div",null,[e("label",dt,r(a.t("product",a.language)),1),D(e("select",{"onUpdate:modelValue":g[4]||(g[4]=i=>a.formData.productId=i),disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",nt,r(a.t("selectProduct",a.language)),1),(l(!0),n(T,null,I(a.products,i=>(l(),n("option",{key:i.id,value:i.id},r(i.name),9,it))),128))],8,lt),[[P,a.formData.productId]])]),a.user?.adminType==="ADMIN"?(l(),n("div",ut,[e("label",ct,r(a.t("status",a.language))+" * ",1),D(e("select",{"onUpdate:modelValue":g[5]||(g[5]=i=>a.formData.status=i),required:"",disabled:a.isSubmitting,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[(l(!0),n(T,null,I(a.draftStatuses,i=>(l(),n("option",{key:i,value:i},r(a.t(i.toLowerCase(),a.language)),9,yt))),128))],8,gt),[[P,a.formData.status]])])):_("",!0),e("div",null,[e("label",ft,r(a.t("draftContent",a.language))+" * ",1),D(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=i=>a.formData.content=i),required:"",disabled:a.isSubmitting,rows:"6",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50 resize-none",placeholder:a.t("enterDraftContent",a.language)},null,8,bt),[[z,a.formData.content]])])],32)]),e("div",mt,[e("button",{onClick:g[8]||(g[8]=i=>o.$emit("cancel")),disabled:a.isSubmitting,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(a.t("cancel",a.language)),9,xt),e("button",{onClick:g[9]||(g[9]=i=>o.$emit("submit",a.formData)),disabled:a.isSubmitting||!a.formData.name||!a.formData.type||!a.formData.content,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isSubmitting?(l(),O(t(ue),{key:0,class:"w-4 h-4 animate-spin"})):_("",!0),e("span",null,r(a.editingDraft?a.t("update",a.language):a.t("create",a.language)),1)],8,ht)])])])):_("",!0)]))}},vt={class:"overflow-x-auto"},kt={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},wt={class:"bg-gray-50 dark:bg-gray-700"},$t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},_t={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ct={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Tt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},It={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Pt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},St={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Nt={class:"px-6 py-4 whitespace-nowrap"},Et=["title"],At={class:"px-6 py-4 whitespace-nowrap"},Ot={class:"text-sm text-gray-600 dark:text-gray-400"},Ut={class:"px-6 py-4 whitespace-nowrap"},Vt={class:"text-sm text-gray-600 dark:text-gray-400"},jt={class:"px-6 py-4 whitespace-nowrap"},Rt={class:"text-sm text-gray-600 dark:text-gray-400"},Mt={class:"px-6 py-4 whitespace-nowrap"},Ft={class:"flex items-center space-x-2"},qt={class:"px-6 py-4 whitespace-nowrap"},Gt={class:"text-sm text-gray-600 dark:text-gray-400"},Lt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Bt={class:"flex items-center justify-end space-x-2"},zt=["onClick","title"],Ht=["onClick","title"],Xt=["onClick","title"],Wt={key:0,class:"text-center py-12"},Yt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Jt={class:"text-gray-600 dark:text-gray-400"},Kt={__name:"DraftTable",props:{filteredDrafts:Array,users:Array,products:Array,t:Function,language:String,canEdit:Function},emits:["edit","delete","transform"],setup(a){const o=a,{filteredDrafts:g,users:i,products:S,t:v,language:k,canEdit:U}=Re(o);function F(s){const u=i.value.find(m=>m.id===s);return u?u.name:"Unknown"}function d(s){if(!s)return"-";const u=S.value?.find(m=>m.id===s);return u?u.name:"Produto não encontrado"}function H(s){return s==="APPROVED"?ze:s==="PENDING"?fe:s==="NOT_APPROVED"?Xe:fe}function R(s){return s==="APPROVED"?"text-sm font-medium text-green-600 dark:text-green-400":s==="PENDING"?"text-sm font-medium text-yellow-600 dark:text-yellow-400":s==="NOT_APPROVED"?"text-sm font-medium text-red-600 dark:text-red-400":"text-sm font-medium text-gray-600 dark:text-gray-400"}function q(s){return s==="APPROVED"?"text-green-500 dark:text-green-400":s==="PENDING"?"text-yellow-500 dark:text-yellow-400":s==="NOT_APPROVED"?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"}function h(s){if(!s)return"";try{let u;if(Array.isArray(s)&&s.length>=3){const[m,E,V,N=0,j=0,G=0]=s;u=new Date(m,E-1,V,N,j,G)}else if(typeof s=="string")u=new Date(s);else if(s instanceof Date)u=s;else return"Data inválida";return!(u instanceof Date)||isNaN(u.getTime())?"Data inválida":u.toLocaleDateString()}catch{return"Data inválida"}}function c(s,u){return s?s.length>u?s.substring(0,u)+"...":s:""}return(s,u)=>(l(),n("div",vt,[e("table",kt,[e("thead",wt,[e("tr",null,[e("th",$t,r(t(v)("name",t(k))),1),e("th",Dt,r(t(v)("type",t(k))),1),e("th",_t,r(t(v)("product",t(k))),1),e("th",Ct,r(t(v)("creator",t(k))),1),e("th",Tt,r(t(v)("status",t(k))),1),e("th",It,r(t(v)("created",t(k))),1),e("th",Pt,r(t(v)("actions",t(k))),1)])]),e("tbody",St,[(l(!0),n(T,null,I(t(g),m=>(l(),n("tr",{key:m.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",Nt,[e("div",{class:"text-sm font-medium text-gray-900 dark:text-white truncate",title:m.name},r(c(m.name,25)),9,Et)]),e("td",At,[e("div",Ot,r(m.type),1)]),e("td",Ut,[e("div",Vt,r(d(m.productId)),1)]),e("td",jt,[e("div",Rt,r(F(m.creatorId)),1)]),e("td",Mt,[e("div",Ft,[(l(),O(Me(H(m.status)),{class:ge(["w-4 h-4",q(m.status)])},null,8,["class"])),e("span",{class:ge(R(m.status))},r(t(v)(m.status?.toLowerCase()||"draft",t(k))),3)])]),e("td",qt,[e("div",Gt,r(h(m.createdAt)),1)]),e("td",Lt,[e("div",Bt,[m.status==="APPROVED"&&t(U)(m)?(l(),n("button",{key:0,onClick:E=>s.$emit("transform",m),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-1 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:t(v)("transformToContent",t(k))},[b(t(le),{class:"w-4 h-4"})],8,zt)):_("",!0),t(U)(m)?(l(),n("button",{key:1,onClick:E=>s.$emit("edit",m),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:t(v)("editDraft",t(k))},[b(t(Le),{class:"w-4 h-4"})],8,Ht)):_("",!0),t(U)(m)?(l(),n("button",{key:2,onClick:E=>s.$emit("delete",m),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:t(v)("deleteDraft",t(k))},[b(t(ve),{class:"w-4 h-4"})],8,Xt)):_("",!0)])])]))),128))])]),t(g).length?_("",!0):(l(),n("div",Wt,[b(t(ne),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e("h3",Yt,r(t(v)("noDraftsFound",t(k))),1),e("p",Jt,r(t(v)("createFirstDraft",t(k))),1)]))]))}},Qt={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Zt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all"},ea={class:"p-6"},ta={class:"flex items-center mb-4"},aa={class:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mr-3"},ra={class:"text-lg font-medium text-gray-900 dark:text-white"},sa={class:"mb-6"},oa={class:"text-gray-600 dark:text-gray-400"},da={class:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600"},la={class:"flex items-center"},na={class:"min-w-0 flex-1"},ia={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},ua={class:"text-xs text-gray-500 dark:text-gray-400"},ca={class:"flex space-x-3 justify-end"},ga=["disabled"],ya=["disabled"],fa={__name:"DeleteDraftModal",props:{draft:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=ie();return(g,i)=>(l(),n("div",Qt,[e("div",Zt,[e("div",ea,[e("div",ta,[e("div",aa,[b(t(Be),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),e("div",null,[e("h3",ra,r(t(f)("confirmDeletion",t(o))),1)])]),e("div",sa,[e("p",oa,r(t(f)("confirmDeleteDraft",t(o))),1),e("div",da,[e("div",la,[b(t(ne),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",na,[e("span",ia,r(a.draft?.name),1),e("span",ua,r(a.draft?.type)+" • "+r(t(f)(a.draft?.status?.toLowerCase()||"draft",t(o))),1)])])])]),e("div",ca,[e("button",{onClick:i[0]||(i[0]=S=>g.$emit("cancel")),disabled:a.isDeleting,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,ga),e("button",{onClick:i[1]||(i[1]=S=>g.$emit("confirm")),disabled:a.isDeleting,class:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isDeleting?(l(),O(t(ue),{key:0,class:"w-4 h-4 animate-spin"})):(l(),O(t(ve),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isDeleting?t(f)("deleting",t(o)):t(f)("delete",t(o))),1)],8,ya)])])])]))}},ba={class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ma={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full transform transition-all max-h-[calc(100vh-2rem)] overflow-y-auto"},xa={class:"p-6"},ha={class:"flex items-center mb-4"},pa={class:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center mr-3"},va={class:"text-lg font-medium text-gray-900 dark:text-white"},ka={class:"mb-6"},wa={class:"text-gray-600 dark:text-gray-400 mb-4"},$a={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 mb-4"},Da={class:"flex items-center"},_a={class:"min-w-0 flex-1"},Ca={class:"text-sm font-medium text-gray-900 dark:text-white block truncate"},Ta={class:"text-xs text-gray-500 dark:text-gray-400"},Ia={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Sa=["disabled"],Na={value:""},Ea=["value"],Aa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Oa=["disabled"],Ua={value:""},Va=["value"],ja={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ra={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ma=["disabled"],Fa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},qa=["disabled"],Ga={value:"PENDING"},La={value:"IN_PRODUCTION"},Ba={value:"POSTED"},za={value:"PRODUCTION_FINISHED"},Ha={value:"FINISHED"},Xa={value:"CANCELED"},Wa={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ya={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ja=["disabled"],Ka={value:"ORGANIC"},Qa={value:"PAID"},Za={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},er={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},tr=["disabled"],ar={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rr=["disabled"],sr={key:1},or={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dr=["disabled","placeholder"],lr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},nr={class:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-lg p-3"},ir=["id","value","disabled"],ur=["for"],cr={key:0,class:"text-xs text-red-500 mt-1"},gr={class:"flex flex-col sm:flex-row gap-3 sm:justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},yr=["disabled"],fr=["disabled"],br={__name:"TransformDraftModal",props:{draft:{type:Object,required:!0},isTransforming:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(a){const{language:o}=ie(),{channels:g,products:i,users:S,fetchChannels:v,fetchProducts:k,fetchUsers:U}=pe(),F=a,d=xe({status:"PENDING",channelIds:[],productId:"",producerId:"",postDate:"",productionStartDate:"",productionEndDate:"",metaAdsId:"",trafficType:"ORGANIC"});W(()=>d.status,h=>{h!=="IN_PRODUCTION"&&(d.productionStartDate="",d.productionEndDate=""),h!=="POSTED"&&(d.metaAdsId="")}),he(async()=>{await Promise.all([g.value&&g.value.length>0?Promise.resolve():v(),i.value&&i.value.length>0?Promise.resolve():k(),S.value&&S.value.length>0?Promise.resolve():U()])}),W(()=>F.draft,()=>{d.status="PENDING",d.channelIds=[],d.productId=F.draft?.productId||"",d.producerId="",d.postDate="",d.productionStartDate="",d.productionEndDate="",d.metaAdsId="",d.trafficType="ORGANIC"},{immediate:!0});const H=h=>{if(!h)return"";const c=f(`contentTypes.${h}`,o.value);return c.startsWith("contentTypes.")?h:c},R=h=>{if(!h)return;const c=new Date(h),s=c.getFullYear(),u=String(c.getMonth()+1).padStart(2,"0"),m=String(c.getDate()).padStart(2,"0"),E=String(c.getHours()).padStart(2,"0"),V=String(c.getMinutes()).padStart(2,"0"),N=String(c.getSeconds()).padStart(2,"0");return`${s}-${u}-${m}T${E}:${V}:${N}`},q=()=>{const h={status:d.status,channelIds:d.channelIds,productId:d.productId||null,producerId:d.producerId||null,postDate:R(d.postDate),trafficType:d.trafficType};return d.status==="IN_PRODUCTION"&&(h.productionStartDate=R(d.productionStartDate),h.productionEndDate=R(d.productionEndDate)),d.status==="POSTED"&&(h.metaAdsId=d.metaAdsId||null),h};return(h,c)=>(l(),n("div",ba,[e("div",ma,[e("div",xa,[e("div",ha,[e("div",pa,[b(t(le),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("div",null,[e("h3",va,r(t(f)("transformDraft",t(o))),1)])]),e("div",ka,[e("p",wa,r(t(f)("transformDraftDescription",t(o))),1),e("div",$a,[e("div",Da,[b(t(ne),{class:"w-4 h-4 text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0"}),e("div",_a,[e("span",Ca,r(a.draft?.name),1),e("span",Ta,r(H(a.draft?.type)),1)])])]),e("form",{onSubmit:c[9]||(c[9]=me(s=>h.$emit("confirm",q()),["prevent"])),class:"space-y-4"},[e("div",Ia,[e("div",null,[e("label",Pa,r(t(f)("product",t(o))),1),D(e("select",{"onUpdate:modelValue":c[0]||(c[0]=s=>d.productId=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Na,r(t(f)("selectProduct",t(o))),1),(l(!0),n(T,null,I(t(i),s=>(l(),n("option",{key:s.id,value:s.id},r(s.name),9,Ea))),128))],8,Sa),[[P,d.productId]])]),e("div",null,[e("label",Aa,r(t(f)("producer",t(o))),1),D(e("select",{"onUpdate:modelValue":c[1]||(c[1]=s=>d.producerId=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Ua,r(t(f)("selectProducer",t(o))),1),(l(!0),n(T,null,I(t(S),s=>(l(),n("option",{key:s.id,value:s.id},r(s.name),9,Va))),128))],8,Oa),[[P,d.producerId]])])]),e("div",ja,[e("div",null,[e("label",Ra,r(t(f)("postDate",t(o))),1),D(e("input",{"onUpdate:modelValue":c[2]||(c[2]=s=>d.postDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,Ma),[[z,d.postDate]])]),e("div",null,[e("label",Fa,r(t(f)("status",t(o))),1),D(e("select",{"onUpdate:modelValue":c[3]||(c[3]=s=>d.status=s),required:"",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Ga,r(t(f)("pending",t(o))),1),e("option",La,r(t(f)("in_production",t(o))),1),e("option",Ba,r(t(f)("posted",t(o))),1),e("option",za,r(t(f)("production-finished",t(o))),1),e("option",Ha,r(t(f)("finished",t(o))),1),e("option",Xa,r(t(f)("canceled",t(o))),1)],8,qa),[[P,d.status]])])]),e("div",Wa,[e("div",null,[e("label",Ya,r(t(f)("trafficType",t(o))),1),D(e("select",{"onUpdate:modelValue":c[4]||(c[4]=s=>d.trafficType=s),disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},[e("option",Ka,r(t(f)("organic",t(o))),1),e("option",Qa,r(t(f)("paid",t(o))),1)],8,Ja),[[P,d.trafficType]])])]),d.status==="IN_PRODUCTION"?(l(),n("div",Za,[e("div",null,[e("label",er,r(t(f)("productionStartDate",t(o))),1),D(e("input",{"onUpdate:modelValue":c[5]||(c[5]=s=>d.productionStartDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,tr),[[z,d.productionStartDate]])]),e("div",null,[e("label",ar,r(t(f)("productionEndDate",t(o))),1),D(e("input",{"onUpdate:modelValue":c[6]||(c[6]=s=>d.productionEndDate=s),type:"datetime-local",disabled:a.isTransforming,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,rr),[[z,d.productionEndDate]])])])):_("",!0),d.status==="POSTED"?(l(),n("div",sr,[e("label",or,r(t(f)("metaAdsId",t(o))),1),D(e("input",{"onUpdate:modelValue":c[7]||(c[7]=s=>d.metaAdsId=s),type:"text",disabled:a.isTransforming,placeholder:t(f)("enterMetaAdsId",t(o)),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white disabled:opacity-50"},null,8,dr),[[z,d.metaAdsId]])])):_("",!0),e("div",null,[e("label",lr,r(t(f)("channels",t(o)))+" * ",1),e("div",nr,[(l(!0),n(T,null,I(t(g),s=>(l(),n("div",{key:s.id,class:"flex items-center"},[D(e("input",{id:`channel-${s.id}`,type:"checkbox",value:s.id,"onUpdate:modelValue":c[8]||(c[8]=u=>d.channelIds=u),disabled:a.isTransforming,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"},null,8,ir),[[Fe,d.channelIds]]),e("label",{for:`channel-${s.id}`,class:"ml-2 text-sm text-gray-900 dark:text-gray-300 cursor-pointer truncate"},r(s.name),9,ur)]))),128))]),d.channelIds.length===0?(l(),n("p",cr,r(t(f)("selectAtLeastOneChannel",t(o))),1)):_("",!0)])],32)]),e("div",gr,[e("button",{onClick:c[10]||(c[10]=s=>h.$emit("cancel")),disabled:a.isTransforming,class:"w-full sm:w-auto px-6 py-2 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 dark:disabled:bg-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r(t(f)("cancel",t(o))),9,yr),e("button",{onClick:c[11]||(c[11]=s=>h.$emit("confirm",q())),disabled:a.isTransforming||d.channelIds.length===0,class:"w-full sm:w-auto flex items-center justify-center px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isTransforming?(l(),O(t(ue),{key:0,class:"w-4 h-4 animate-spin"})):(l(),O(t(le),{key:1,class:"w-4 h-4"})),e("span",null,r(a.isTransforming?t(f)("transforming",t(o)):t(f)("transform",t(o))),1)],8,fr)])])])]))}},mr={class:"space-y-6"},xr={class:"flex justify-between items-center"},hr={class:"text-2xl font-bold text-gray-900 dark:text-white"},pr={key:0},vr={key:0,class:"space-y-6"},kr={class:"flex space-x-4"},wr={class:"overflow-x-auto"},$r={class:"w-full border border-gray-200 dark:border-gray-700 rounded-lg"},Dr={class:"bg-gray-50 dark:bg-gray-700"},_r={class:"px-6 py-3 text-left"},Cr={class:"px-6 py-3 text-left"},Tr={class:"px-6 py-3 text-left"},Ir={class:"px-6 py-3 text-left"},Pr={class:"px-6 py-3 text-left"},Sr={class:"px-6 py-3 text-right"},Nr={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Er={class:"px-6 py-4"},Ar={class:"px-6 py-4"},Or={class:"px-6 py-4"},Ur={class:"px-6 py-4"},Vr={class:"flex items-center space-x-2"},jr={class:"px-6 py-4"},Rr={class:"px-6 py-4"},Mr={class:"flex items-center justify-end space-x-2"},Fr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},qr={class:"text-red-600"},Gr={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Lr={class:"text-green-600"},Br={key:3,class:"flex space-x-4 flex-wrap gap-y-2"},zr={value:""},Hr=["value"],Xr={value:""},Wr=["value"],Yr={value:""},Jr=["value"],Kr={value:""},Qr=["value"],Zr={key:4},es={key:0,class:"flex items-center justify-between mt-4 flex-wrap gap-3"},ts={class:"text-sm text-gray-600 dark:text-gray-400"},as={class:"flex items-center space-x-2"},rs=["disabled"],ss=["disabled"],ms={__name:"DraftManager",setup(a){const{language:o}=ie(),{currentUser:g}=qe(),{drafts:i,users:S,products:v,loadingDrafts:k,errors:U,fetchDrafts:F,fetchUsers:d,fetchChannels:H,fetchProducts:R,createDraft:q,updateDraft:h,deleteDraft:c,transformDraftToContent:s}=pe(),u=y=>f(y,o.value),m=["Post","Story","Reels","Video","Artigo"],E=["PENDING","APPROVED","NOT_APPROVED"],V=w(!1),N=w(null),j=w(""),G=w(""),Y=w(""),J=w(""),re=xe({name:"",type:"",content:"",productId:"",status:"PENDING"}),K=w(!1),M=w(""),Q=w(!0),Z=w(!1),ee=w(!1),L=w(null),B=w(null),se=w(!1),oe=w(!1),C=w(0),ke=w(15),X=w(1),te=w(0);he(async()=>{await Promise.all([d(),H(),R()]),await A(),Q.value=!1}),W(j,async()=>{C.value=0,await A()}),W(Y,async()=>{C.value=0,await A()}),W(J,async()=>{C.value=0,await A()});const we=ae(()=>!i.value||!g.value?[]:i.value),$e=ae(()=>we.value.filter(y=>!(j.value&&y.status!==j.value||G.value&&y.type!==G.value))),De=ae(()=>$e.value),_e=ae(()=>C.value+1),A=async()=>{const y=await F({status:j.value||void 0,productId:Y.value||void 0,creatorId:J.value||void 0,page:C.value,size:ke.value});y&&typeof y=="object"&&(typeof y.totalPages=="number"&&(X.value=y.totalPages),typeof y.totalElements=="number"&&(te.value=y.totalElements))},Ce=async()=>{C.value!==0&&(C.value-=1,await A())},Te=async()=>{C.value>=X.value-1||(C.value+=1,await A())};async function de(){C.value=0,await A()}async function Ie(y){if(!K.value){K.value=!0,M.value="";try{let p;if(N.value)p=await h(N.value.id,y);else{const x={...y,creatorId:g.value.id,status:y.status||"PENDING"};p=await q(x)}p.success?(M.value=N.value?u("draftUpdatedSuccessfully"):u("draftCreatedSuccessfully"),ce(),await A()):console.error("Error:",p.error)}catch(p){console.error("Unexpected error:",p)}finally{K.value=!1}}}function Pe(y){N.value=y,Object.assign(re,{name:y.name,type:y.type,content:y.content||"",productId:y.productId||"",status:y.status}),V.value=!0}function ce(){V.value=!1,N.value=null,Object.assign(re,{name:"",type:"",content:"",productId:"",status:"PENDING"}),M.value=""}async function Se(y){L.value=y,Z.value=!0}async function Ne(){if(L.value){se.value=!0;try{const y=await c(L.value.id);y.success?(M.value=u("draftDeletedSuccessfully"),Z.value=!1,L.value=null):console.error("Error:",y.error)}catch(y){console.error("Unexpected error:",y)}finally{se.value=!1}}}function Ee(){Z.value=!1,L.value=null}async function Ae(y){B.value=y,ee.value=!0}async function Oe(y){if(B.value){oe.value=!0;try{const p=await s(B.value.id,y);p.success?(M.value=u("draftTransformed"),ee.value=!1,B.value=null,await A()):console.error("Error:",p.error)}catch(p){console.error("Unexpected error:",p)}finally{oe.value=!1}}}function Ue(){ee.value=!1,B.value=null}function Ve(y){return g.value?g.value.adminType==="ADMIN"||y.creatorId===g.value.id:!1}return(y,p)=>(l(),n("div",mr,[e("div",xr,[e("h2",hr,[ye(r(u("drafts",t(o)))+" ",1),te.value?(l(),n("span",pr,"("+r(te.value)+")",1)):_("",!0)]),e("button",{onClick:p[0]||(p[0]=x=>V.value=!0),class:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[b(t(He),{class:"w-4 h-4 mr-2"}),ye(" "+r(u("newDraft",t(o))),1)])]),t(k)||Q.value?(l(),n("div",vr,[e("div",kr,[b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"}),b($,{customClass:"h-10 w-32"})]),e("div",wr,[e("table",$r,[e("thead",Dr,[e("tr",null,[e("th",_r,[b($,{customClass:"h-4 w-16"})]),e("th",Cr,[b($,{customClass:"h-4 w-12"})]),e("th",Tr,[b($,{customClass:"h-4 w-20"})]),e("th",Ir,[b($,{customClass:"h-4 w-16"})]),e("th",Pr,[b($,{customClass:"h-4 w-20"})]),e("th",Sr,[b($,{customClass:"h-4 w-16"})])])]),e("tbody",Nr,[(l(),n(T,null,I(6,x=>e("tr",{key:x},[e("td",Er,[b($,{customClass:"h-4 w-32 shimmer"})]),e("td",Ar,[b($,{customClass:"h-4 w-16 shimmer"})]),e("td",Or,[b($,{customClass:"h-4 w-24 shimmer"})]),e("td",Ur,[e("div",Vr,[b($,{customClass:"h-4 w-4 rounded-full shimmer"}),b($,{customClass:"h-4 w-20 shimmer"})])]),e("td",jr,[b($,{customClass:"h-4 w-24 shimmer"})]),e("td",Rr,[e("div",Mr,[b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"}),b($,{customClass:"h-8 w-8 rounded shimmer"})])])])),64))])])])])):t(U).drafts?(l(),n("div",Fr,[e("p",qr,r(t(U).drafts),1)])):_("",!0),M.value?(l(),n("div",Gr,[e("p",Lr,r(M.value),1)])):_("",!0),!t(k)&&!Q.value?(l(),n("div",Br,[D(e("select",{"onUpdate:modelValue":p[1]||(p[1]=x=>j.value=x),onChange:de,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",zr,r(u("allStatuses",t(o))),1),(l(),n(T,null,I(E,x=>e("option",{key:x,value:x},r(u(x.toLowerCase(),t(o))),9,Hr)),64))],544),[[P,j.value]]),D(e("select",{"onUpdate:modelValue":p[2]||(p[2]=x=>G.value=x),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Xr,r(u("allTypes",t(o))),1),(l(),n(T,null,I(m,x=>e("option",{key:x,value:x},r(x),9,Wr)),64))],512),[[P,G.value]]),D(e("select",{"onUpdate:modelValue":p[3]||(p[3]=x=>Y.value=x),onChange:de,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Yr,r(u("allProducts",t(o))),1),(l(!0),n(T,null,I(t(v),x=>(l(),n("option",{key:x.id,value:x.id},r(x.name),9,Jr))),128))],544),[[P,Y.value]]),D(e("select",{"onUpdate:modelValue":p[4]||(p[4]=x=>J.value=x),onChange:de,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",Kr,r(u("allCreators",t(o))),1),(l(!0),n(T,null,I(t(S),x=>(l(),n("option",{key:x.id,value:x.id},r(x.name),9,Qr))),128))],544),[[P,J.value]])])):_("",!0),b(pt,{show:V.value,editingDraft:N.value,user:t(g),formData:re,isSubmitting:K.value,contentTypes:m,draftStatuses:E,products:t(v),t:u,language:t(o),onSubmit:Ie,onCancel:ce},null,8,["show","editingDraft","user","formData","isSubmitting","products","language"]),!t(k)&&!Q.value?(l(),n("div",Zr,[b(Kt,{filteredDrafts:De.value,users:t(S),products:t(v),t:u,language:t(o),canEdit:Ve,onEdit:Pe,onDelete:Se,onTransform:Ae},null,8,["filteredDrafts","users","products","language"]),X.value>1?(l(),n("div",es,[e("div",ts,r(u("page",t(o)))+" "+r(_e.value)+" / "+r(X.value)+" · "+r(te.value)+" "+r(u("items",t(o))),1),e("div",as,[e("button",{onClick:Ce,disabled:C.value===0,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(u("previous",t(o))),9,rs),e("button",{onClick:Te,disabled:C.value>=X.value-1,class:"px-3 py-1 rounded border text-sm disabled:opacity-40 disabled:cursor-not-allowed bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"},r(u("next",t(o))),9,ss)])])):_("",!0)])):_("",!0),Z.value?(l(),O(fa,{key:5,draft:L.value,"is-deleting":se.value,onConfirm:Ne,onCancel:Ee},null,8,["draft","is-deleting"])):_("",!0),ee.value?(l(),O(br,{key:6,draft:B.value,"is-transforming":oe.value,onConfirm:Oe,onCancel:Ue},null,8,["draft","is-transforming"])):_("",!0)]))}};export{ms as default};
